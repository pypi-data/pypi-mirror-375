import{C as Ze}from"./Container-Br6JH6Pm.js";import{T as xe}from"./Toolbar-BvxWbi_E.js";import{g as Be,p as et,i as tt,an as at,F as y,ag as _e,ah as P,J as lt,K as it,ao as ot,P as st,aF as nt,aA as rt,U as q,W as d,X as r,G as re,a2 as f,a_ as M,a6 as oe,bt as Ae,x as A,c as H,bM as K,Y as m,ab as c,a0 as h,V as ut,bL as $e,bE as se,as as w,ad as p,aq as U,ac as mt,a7 as $,ar as O,E as R,aV as dt,b9 as j,bN as ct,ba as pt,bO as Ce,bF as Te,bP as ue,bQ as Fe,bI as Ve,ax as ft,a9 as vt,bi as yt,Z as ht,bv as bt,bw as Y,a4 as I,bA as kt,bx as gt,e as wt,b as le,w as G,o as It,R as he,bR as St,aY as z,$ as Bt,aQ as _t,bq as At,I as be,a1 as ke,br as ge,bs as ie,bH as $t}from"./index-B-lUZalq.js";import{B as Pe}from"./Button-kSJGA_Pw.js";import{L as Ct}from"./ListItem-LV_WU--g.js";import{_ as ne,V as De}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-DnroVGI-.js";import{M as Oe}from"./MediaItemThumb-DapaMoP4.js";import{a as W}from"./VBtn-BPJ1JKW-.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Tt,P as Ft}from"./PanelviewItemCompact-CIDxIfoQ.js";import{V as Vt}from"./VSpacer-DDLrofv-.js";import{V as Pt}from"./VTextField-B-d5Pe9I.js";import{a as Dt,V as Ot}from"./VInfiniteScroll-CKZj-VKd.js";import{V as we,a as Ie}from"./VRow-BQOTE9C_.js";import{V as Lt}from"./VVirtualScroll-CceW16X7.js";import{V as Se}from"./VAlert-QHTIcuEJ.js";const Le=Symbol.for("vuetify:v-item-group"),Et=et({...st(),...ot({selectedClass:"v-item--selected"}),...it(),...lt()},"VItemGroup"),Ee=Be()({name:"VItemGroup",props:Et(),emits:{"update:modelValue":S=>!0},setup(S,l){let{slots:b}=l;const{themeClasses:g}=tt(S),{isSelected:o,select:k,next:B,prev:C,selected:a}=at(S,Le);return()=>y(S.tag,{class:P(["v-item-group",g.value,S.class]),style:_e(S.style)},{default:()=>[b.default?.({isSelected:o,select:k,next:B,prev:C,selected:a.value})]})}}),L=Be()({name:"VItem",props:nt(),emits:{"group:selected":S=>!0},setup(S,l){let{slots:b}=l;const{isSelected:g,select:o,toggle:k,selectedClass:B,value:C,disabled:a}=rt(S,Le);return()=>b.default?.({isSelected:g.value,selectedClass:B.value,select:o,toggle:k,value:C.value,disabled:a.value})}}),Me=q({__name:"FavoriteButton",props:{item:{}},setup(S){const l=S;return(b,g)=>(r(),d(Pe,re(l,{variant:"icon",icon:b.item?.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=o=>f(oe).toggleFavorite(b.item)),g[1]||(g[1]=M(()=>{},["prevent"])),g[2]||(g[2]=M(()=>{},["stop"]))]}),null,16,["icon","title"]))}}),Mt={key:0,class:"media-thumb listitem-media-thumb"},Rt={key:1,class:"media-thumb listitem-media-thumb"},Kt={key:0},Nt={key:0},Yt={key:0,class:"line-clamp-1"},zt={key:1},Xt={key:0},Gt={key:1},Ht={key:2},Ut={key:3},jt={key:4},Wt={key:5},qt={key:6},Qt={key:7},Jt={key:5},Zt={key:6},xt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},ea=q({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(S,{emit:l}){const{t:b}=Ae(),g=A(!1),o=S,k=H(()=>{if(!("provider_mappings"in o.item))return"";for(const t of o.item.provider_mappings)if(t.audio_format&&t.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(t.audio_format.content_type)&&(t.audio_format.sample_rate>48e3||t.audio_format.bit_depth>16))return`${t.audio_format.sample_rate/1e3}kHz ${t.audio_format.bit_depth} bits`;return""}),B=l,C=function(t){const v=t;ue(o.item,v.clientX,v.clientY,o.parentItem)},a=function(t){if(o.showCheckboxes)return;const v=t;Fe(o.item,v.clientX,v.clientY,o.parentItem)},T=function(t){o.showCheckboxes||Ve(o.item,t.clientX,t.clientY,o.parentItem)};return(t,v)=>(r(),d(Ct,{link:"","show-menu-btn":t.showMenu,class:P({unavailable:!t.isAvailable}),onClick:M(a,["stop"]),onMenu:M(C,["stop"])},{prepend:m(()=>[t.showCheckboxes?(r(),h("div",Mt,[y(De,{"model-value":t.isSelected,onClick:v[0]||(v[0]=M(()=>{},["stop"])),"onUpdate:modelValue":v[1]||(v[1]=_=>{_!=null&&B("select",t.item,_)})},null,8,["model-value"])])):(r(),h("div",Rt,[y(Oe,{size:"50",item:t.isAvailable?t.item:void 0,class:P({dimmed:g.value})},null,8,["item","class"])])),!t.showCheckboxes&&t.item.is_playable?(r(),d(W,{key:2,class:P({hidden:!g.value}),icon:"mdi-play",color:"primary",fab:"",size:"small",style:{position:"absolute",left:"12px",bottom:"12px"},onClick:M(T,["stop"]),onMouseenter:v[2]||(v[2]=_=>g.value=!0),onMouseleave:v[3]||(v[3]=_=>g.value=!1)},null,8,["class"])):c("",!0)]),title:m(()=>[t.item.media_type==f($).FOLDER?(r(),h("span",Kt,[R("span",null,p(f(Ce)(t.item,f(b))),1)])):(r(),h("span",{key:1,class:P({"is-playing":t.isPlaying})},[w(p(t.item.name)+" ",1),"version"in t.item&&t.item.version?(r(),h("span",Nt,"("+p(t.item.version)+")",1)):c("",!0)],2)),t.item&&t.item.metadata?(r(),d(f(se),{key:2,location:"bottom"},{activator:m(({props:_})=>[f(Te)(t.item.metadata.explicit||!1)?(r(),d(O,re({key:0},_,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):c("",!0)]),default:m(()=>[R("span",null,p(t.$t("tooltip.explicit")),1)]),_:1})):c("",!0)]),subtitle:m(()=>[t.item.media_type==f($).TRACK&&"provider_mappings"in t.item?(r(),h("div",Yt,[y(Ee,null,{default:m(()=>["artists"in t.item?(r(),d(L,{key:0},{default:m(()=>[w(p(f(j)(t.item.artists,2)),1)]),_:1})):c("",!0),t.showAlbum&&"album"in t.item&&t.item.album?(r(),d(L,{key:1},{default:m(()=>[w(" • "+p(t.item.album.name),1)]),_:1})):c("",!0),t.showDiscNumber&&"disc_number"in t.item&&t.item.disc_number?(r(),d(L,{key:2},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"md:album"}),w(" "+p(t.item.disc_number),1)]),_:1})):c("",!0),t.showTrackNumber&&"track_number"in t.item&&t.item.track_number?(r(),d(L,{key:3},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),w(" "+p(t.item.track_number),1)]),_:1})):t.showPosition&&"position"in t.item&&t.item.position?(r(),d(L,{key:4},{default:m(()=>[y(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),w(" "+p(t.item.position),1)]),_:1})):c("",!0)]),_:1})])):t.item.media_type==f($).ALBUM&&"year"in t.item?(r(),h("div",zt,[t.item.album_type!=f(ct).UNKNOWN?(r(),h("span",Xt,p(t.$t("album_type."+t.item.album_type))+" • ",1)):c("",!0),R("span",null,p(f(j)(t.item.artists)),1),t.item.year?(r(),h("span",Gt," • "+p(t.item.year),1)):c("",!0)])):"artists"in t.item&&t.item.artists?(r(),h("div",Ht,p(f(j)(t.item.artists)),1)):"owner"in t.item&&t.item.owner?(r(),h("div",Ut,p(t.item.owner),1)):"authors"in t.item&&t.item.authors?(r(),h("div",jt,p(t.item.authors.join(" / ")),1)):"publisher"in t.item&&t.item.publisher?(r(),h("div",Wt,p(t.item.publisher),1)):"metadata"in t.item&&t.item.metadata?.description&&[f($).RADIO,f($).PLAYLIST,f($).FOLDER].includes(t.item.media_type)?(r(),h("div",qt,p(f(pt)(t.item.metadata.description,150)),1)):"media_type"in t.item&&!t.item.provider_mappings?(r(),h("div",Qt,p(t.$t(t.item.media_type)),1)):c("",!0)]),append:m(()=>[t.isPlaying?(r(),d(ne,{key:0})):c("",!0),k.value?(r(),d(ut,{key:1,src:f($e),width:"30",class:P(t.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[y(f(se),{activator:"parent",location:"bottom"},{default:m(()=>[w(p(k.value),1)]),_:1})]),_:1},8,["src","class"])):c("",!0),f(U)("bp2")&&t.showProvider?(r(),d(mt,{key:2,domain:t.item.media_type==f($).PLAYLIST?t.item.provider_mappings[0].provider_domain:t.item.provider,size:24},null,8,["domain"])):c("",!0),"fully_played"in t.item&&t.item.fully_played?(r(),d(O,{key:3,title:t.$t("item_fully_played")},{default:m(()=>[...v[4]||(v[4]=[w("mdi-check",-1)])]),_:1},8,["title"])):"resume_position_ms"in t.item&&t.item.resume_position_ms?(r(),d(O,{key:4,title:t.$t("item_in_progress")},{default:m(()=>[...v[5]||(v[5]=[w("mdi-clock-fast",-1)])]),_:1},8,["title"])):c("",!0),f(U)("bp3")&&"favorite"in t.item&&t.showFavorite&&!t.$vuetify.display.mobile?(r(),h("div",Jt,[y(Me,{item:t.item},null,8,["item"])])):c("",!0),t.showDuration&&"duration"in t.item&&t.item.duration&&f(U)("bp0")?(r(),h("div",Zt,[R("div",null,[R("span",xt,p(f(dt)(t.item.duration)),1)])])):c("",!0)]),_:1},8,["show-menu-btn","class"]))}}),ta=me(ea,[["__scopeId","data-v-1c4f1707"]]),aa={key:0},la=["src"],ia={key:0},oa=q({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(S,{emit:l}){const b=S,g=H(()=>{for(const a of b.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),o=l,k=function(a){if(b.showCheckboxes)return;const T="clientX"in a?a.clientX:a.touches[0].clientX,t="clientY"in a?a.clientY:a.touches[0].clientY;ue(b.item,T,t,b.parentItem)},B=function(a){if(b.showCheckboxes){o("select",b.item,!b.isSelected);return}Fe(b.item,a.clientX,a.clientY,b.parentItem)},C=function(a){b.showCheckboxes||Ve(b.item,a.clientX,a.clientY,b.parentItem)};return(a,T)=>{const t=gt("hold");return r(),d(Tt,null,{default:m(({isHovering:v,props:_})=>[ft((r(),d(vt,re(_,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:B,onContextmenu:M(k,["right","prevent"])}),{default:m(()=>[a.showCheckboxes?(r(),d(yt,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:m(()=>[y(De,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):c("",!0),y(Oe,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),y(ht,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[y(bt,null,{default:m(()=>[a.item.media_type==f($).FOLDER?(r(),h("span",aa,[R("span",null,p(f(Ce)(a.item,a.$t)),1)])):(r(),h("span",{key:1,class:P({"is-playing":a.isPlaying})},p(a.item.name),3)),"version"in a.item&&a.item.version?(r(),h("span",{key:2,class:P({"is-playing":a.isPlaying})}," - "+p(a.item.version),3)):c("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(r(),d(Y,{key:0,class:"line-clamp-1"},{default:m(()=>[w(p(f(j)(a.item.artists,1)),1)]),_:1})):c("",!0),"authors"in a.item&&a.item.authors?(r(),d(Y,{key:1,class:"line-clamp-1"},{default:m(()=>[w(p(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(r(),d(Y,{key:2,class:"line-clamp-1"},{default:m(()=>[w(p(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(r(),d(Y,{key:3,class:"line-clamp-1"},{default:m(()=>[w(p(a.item.owner),1)]),_:1})):a.showMediaType?(r(),d(Y,{key:4,class:"line-clamp-1"},{default:m(()=>[w(p(a.$t(a.item.media_type)),1)]),_:1})):(r(),d(Y,{key:5,class:"line-clamp-1"}))]),_:1}),a.isPlaying&&!a.showActions?(r(),d(ne,{key:1,"icon-style":"position: absolute; right: 5px; bottom: 5px","show-badge":!1})):c("",!0),(v||f(I).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(r(),d(W,{key:2,icon:"mdi-play",color:"primary",fab:"",style:_e(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:M(C,["stop"])},null,8,["style"])):c("",!0),a.showActions?(r(),d(kt,{key:3,class:"panel-item-actions"},{default:m(()=>[y(Ee,{style:{padding:"0"}},{default:m(()=>[f(Te)(a.item.metadata.explicit||!1)?(r(),d(L,{key:0},{default:m(()=>[y(O,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):c("",!0),g.value?(r(),d(L,{key:1},{default:m(()=>[y(O,{class:P(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[R("img",{src:f($e),width:"30"},null,8,la),y(se,{activator:"parent",location:"bottom"},{default:m(()=>[w(p(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):c("",!0),a.showTrackNumber&&"track_number"in a.item&&a.item.track_number?(r(),d(L,{key:2},{default:m(()=>[y(O,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(r(),h("span",ia,p(a.item.disc_number)+"/",1)):c("",!0),w(p(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(r(),d(L,{key:3},{default:m(()=>[y(O,{size:"small",icon:"mdi-music-circle-outline"}),w(" "+p(a.item.position),1)]),_:1})):c("",!0),f(U)("bp3")?(r(),d(L,{key:4},{default:m(()=>[y(Me,{item:a.item},null,8,["item"])]),_:1})):c("",!0)]),_:1}),a.isPlaying?(r(),d(ne,{key:0,"show-badge":!1})):c("",!0),y(Vt),v||a.$vuetify.display.mobile?(r(),d(Pe,{key:1,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:M(k,["stop"])})):c("",!0)]),_:2},1024)):c("",!0)]),_:2},1040,["class"])),[[t,k]])]),_:1})}}}),sa=me(oa,[["__scopeId","data-v-bb3ba95c"]]),na={key:0},ra={key:2},ua=q({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},onTitleClick:{type:Function,default:void 0}},setup(S){const l=S,b=$t(),{t:g}=Ae(),o=A({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=A("list"),B=A(!1),C=A(!1),a=A([]),T=A([]),t=A(!1),v=A([]),_=A(!1),D=A(!1),N=A(!0),E=A(!1),X=A(!1),Q=A(!1),de=function(){o.value.search="",B.value=!1},J=function(){he(()=>{document.getElementById("searchInput")?.focus()})},Re=function(){B.value?de():(B.value=!0,J())},Z=function(){if(l.onTitleClick){l.onTitleClick();return}N.value=!N.value;const e=`${l.path}.${l.itemtype}`;localStorage.setItem(`expand.${e}`,N.value.toString())},x=function(e){k.value=e;const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`viewMode.${s}`,e)},Ke=function(){o.value.favoritesOnly=!o.value.favoritesOnly;const e=o.value.favoritesOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,e),V(void 0,void 0,!0)},Ne=function(){o.value.libraryOnly=!o.value.libraryOnly;const e=o.value.libraryOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,e),V(!0,void 0,!0)},Ye=function(){o.value.albumArtistsFilter=!o.value.albumArtistsFilter;const e=o.value.albumArtistsFilter?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,e),V(void 0,void 0,!0)},ee=function(e){return v.value.includes(e)},te=function(e,s){const i=I.curQueueItem?.media_item;if(!i)return!1;switch(s){case"tracks":return e.item_id===i.item_id;case"albums":return e.item_id===i.album.item_id;case"artists":return Array.isArray(i.artists)&&i.artists.some(n=>n.item_id===e.item_id);default:return!1}},ae=function(e,s){if(s)v.value.includes(e)||v.value.push(e);else for(let i=0;i<v.value.length;i++)v.value[i]===e&&v.value.splice(i,1)},ze=function(){D.value&&(v.value=[]),D.value=!D.value},Xe=function(){V(!0,!0)},Ge=function(){o.value.search="",B.value=!1,V(void 0,void 0,!0)},He=function(e){e!==void 0&&(o.value.sortBy=e);const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`sortBy.${s}`,o.value.sortBy),V(void 0,void 0,!0)},Ue=function(e){o.value.albumType?.includes(e)?o.value.albumType=o.value.albumType?.filter(i=>i!==e):(o.value.albumType=o.value.albumType||[],o.value.albumType.push(e));const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumType.${s}`,o.value.albumType.join(",")),V(void 0,void 0,!0)},je=function(){I.globalSearchTerm=o.value.search,l.itemtype=="artists"?I.globalSearchType=$.ARTIST:l.itemtype=="albums"?I.globalSearchType=$.ALBUM:l.itemtype=="tracks"?I.globalSearchType=$.TRACK:l.itemtype=="playlists"?I.globalSearchType=$.PLAYLIST:l.itemtype=="audiobooks"?I.globalSearchType=$.AUDIOBOOK:l.itemtype=="podcasts"?I.globalSearchType=$.PODCAST:l.itemtype=="radios"&&(I.globalSearchType=$.RADIO),b.push({name:"search"})},ce=async function({done:e}){if(E.value){e("empty");return}await V(void 0,void 0,void 0,o.value.offset+l.limit),e("ok")},We=async function(){for(;!E.value;)await ce({done:function(){}})},pe=H(()=>{var e=!1;return o.value.search&&o.value.search.length!==0&&(e=!0),e}),fe=H(()=>B.value&&N.value);wt(()=>{fe.value||(C.value=!1)});const qe=H(()=>{if(l.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:Z,overflowAllowed:!1}];const e=[];return l.showSelectButton!==!1&&(D.value&&e.push({label:"tooltip.select_all",icon:"mdi-select-all",action:ye}),e.push({label:"tooltip.select_items",icon:D.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:ze,active:D.value})),l.showLibraryOnlyFilter===!0&&e.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Ne,active:o.value.libraryOnly}),l.showFavoritesOnlyFilter===!0&&e.push({label:"tooltip.filter_favorites",icon:o.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ke,active:o.value.favoritesOnly}),l.showAlbumArtistsOnlyFilter===!0&&e.push({label:"tooltip.album_artist_filter",icon:o.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Ye,active:o.value.albumArtistsFilter}),l.showAlbumTypeFilter&&e.push({label:"tooltip.album_type",icon:"mdi-album",disabled:t.value,subItems:["album","single","ep","compilation","unknown"].map(s=>({label:`album_type.${s}`,selected:o.value.albumType?.includes(s),action:()=>{Ue(s)}}))}),(l.showRefreshButton!==!1||_.value)&&e.push({label:_.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Xe,active:_.value,disabled:t.value}),l.sortKeys?.length&&e.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:l.sortKeys.length<=1||t.value,subItems:l.sortKeys.map(s=>({label:`sort.${s}`,selected:o.value.sortBy==s,action:()=>{He(s)}}))}),l.showSearchButton!==!1&&e.push({label:pe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Re,active:pe.value,disabled:t.value}),e.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{x("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{x("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{x("panel_compact")}}]}),l.extraMenuItems?.length&&e.push(...l.extraMenuItems),l.allowCollapse===!0&&e.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:Z}),e}),V=async function(e=!1,s=!1,i=!1,n=0){if(!t.value){if(t.value=!0,i&&l.loadPagedData!=null&&(e=!0),(e||s)&&(n=0,E.value&&(Q.value=!0),E.value=!1,X.value=!1,_.value=!1),o.value.offset=n,o.value.limit=l.limit,o.value.refresh=s,l.loadPagedData!=null){const u=await l.loadPagedData(o.value);o.value.offset?a.value.push(...u):a.value=u,Math.abs(u.length-l.limit)>10&&(E.value=!0)}else if(l.loadItems!=null){(!X.value||s)&&(T.value=await l.loadItems(o.value),X.value=!0);const u=Je(T.value,o.value);o.value.offset?a.value.push(...u):a.value=u,E.value=u.length<l.limit}o.value.refresh=!1,t.value=!1,Q.value=!1}},Qe=async function(){const e=`${l.path}.${l.itemtype}`,s=localStorage.getItem(`viewMode.${e}`);s&&s!=="null"?k.value=s:l.itemtype=="artists"||l.itemtype=="albums"?k.value="panel":k.value="list";const i=localStorage.getItem(`sortBy.${e}`);if(i&&i!=="null"&&l.sortKeys.includes(i)?o.value.sortBy=i:o.value.sortBy=l.sortKeys[0],l.showFavoritesOnlyFilter!==!1){const n=localStorage.getItem(`favoriteFilter.${e}`);n&&n=="true"&&(o.value.favoritesOnly=!0)}if(l.showLibraryOnlyFilter!==!1){const n=localStorage.getItem(`libraryFilter.${e}`);n&&n=="true"&&(o.value.libraryOnly=!0)}if(l.showAlbumArtistsOnlyFilter!==!1){const n=localStorage.getItem(`albumArtistsFilter.${e}`);n&&(o.value.albumArtistsFilter=n=="true")}if(l.allowCollapse!==!1){const n=localStorage.getItem(`expand.${e}`);n&&(N.value=n=="true")}if(l.showAlbumTypeFilter===!0){const n=localStorage.getItem(`albumType.${e}`);n&&(o.value.albumType=n.split(","))}if(l.restoreState){let n=`search.${e}`;l.parentItem&&(n+=l.parentItem.item_id);const u=localStorage.getItem(n);u&&u!=="null"&&(o.value.search=u)}},ve=function(e){I.dialogActive||t.value||(e.key==="Escape"&&de(),!C.value&&(e.key==="a"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),ye()):!C.value&&e.key=="Backspace"?J():!C.value&&e.key.length==1&&(B.value=!0,J())))};l.allowKeyHooks&&(document.addEventListener("keydown",ve),le(()=>{document.removeEventListener("keydown",ve)})),l.restoreState&&le(()=>{const e=l.path||l.itemtype,s=document.querySelector("#cont");I.prevState={path:e,scrollPos:s?.scrollTop||0,pagedItems:a.value,allItems:T.value,allItemsReceived:E.value,initialDataReceived:X.value,params:o.value}}),G(()=>o.value.search,e=>{e&&(B.value=!0),V(void 0,void 0,!0);let s=`search.${l.path}.${l.itemtype}`;l.parentItem&&(s+=l.parentItem.item_id),localStorage.setItem(s,o.value.search)}),G(()=>l.path,e=>{t.value!=!0&&(a.value=[],T.value=[],V(!0))}),G(()=>l.parentItem,()=>{t.value!=!0&&(T.value=[],_.value=!0)},{deep:!0}),G(()=>l.limit,e=>{o.value.limit=e}),G(()=>l.updateAvailable,e=>{t.value||(_.value=e)},{immediate:!0}),It(async()=>{Qe();const e=l.path||l.itemtype;l.restoreState&&I.prevState?.path==e?(o.value=I.prevState.params,a.value=I.prevState.pagedItems,T.value=I.prevState.allItems,E.value=I.prevState.allItemsReceived,X.value=I.prevState.initialDataReceived,he(()=>{const i=document.getElementById("cont");i&&St(i,I.prevState.scrollPos,50)}),t.value=!1):V(!0);const s=oe.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],i=>{if(i.event==z.MEDIA_ITEM_DELETED)a.value=a.value.filter(n=>n.uri!=i.object_id);else if(i.event==z.MEDIA_ITEM_UPDATED){const n=a.value.findIndex(u=>u.uri==i.object_id);n>=0&&(a.value[n]=i.data)}else if(i.event==z.MEDIA_ITEM_PLAYED){const n=a.value.findIndex(u=>u.uri==i.object_id);n>=0&&("fully_played"in a.value[n]&&(a.value[n].fully_played=i.data.fully_played),"resume_position_ms"in a.value[n]&&(a.value[n].resume_position_ms=i.data.seconds_played*1e3))}});le(s)});const F=function(e,s=!1){return e?"translation_key"in e&&e.translation_key&&e.name?g(e.translation_key,[e.name]):"translation_key"in e&&e.translation_key?g(e.translation_key):s&&"sort_name"in e&&e.sort_name?e.sort_name:e.name:""},Je=function(e,s){let i=[];if(s.search){const n=s.search.toLowerCase();for(const u of e)(u.name.toLowerCase().includes(n)||"album"in u&&u.album?.name.toLowerCase().includes(n)||"artists"in u&&u.artists&&u.artists.length&&u.artists[0].name.toLowerCase().includes(n))&&i.push(u)}else i=[...e];return s.sortBy=="name"&&i.sort((n,u)=>F(n).localeCompare(F(u),void 0,{numeric:!0})),s.sortBy=="sort_name"&&i.sort((n,u)=>F(n,!0).localeCompare(F(u,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&i.sort((n,u)=>F(u).localeCompare(F(n),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&i.sort((n,u)=>F(u,!0).localeCompare(F(n,!0),void 0,{numeric:!0})),s.sortBy=="album"&&i.sort((n,u)=>F(n.album).localeCompare(F(u.album),void 0,{numeric:!0})),s.sortBy=="artist"&&i.sort((n,u)=>F(n.artists[0]).localeCompare(F(u.artists[0]))),s.sortBy=="track_number"&&(i.sort((n,u)=>(n.track_number||0)-(u.track_number||0)),i.sort((n,u)=>(n.disc_number||0)-(u.disc_number||0))),s.sortBy=="position"&&i.sort((n,u)=>(n.position||0)-(u.position||0)),s.sortBy=="position_desc"&&i.sort((n,u)=>(u.position||0)-(n.position||0)),s.sortBy=="year"&&i.sort((n,u)=>(n.year||0)-(u.year||0)),s.sortBy=="year_desc"&&i.sort((n,u)=>(u.year||0)-(n.year||0)),s.sortBy=="recent"&&i.sort((n,u)=>(u.timestamp_added||0)-(n.timestamp_added||0)),s.sortBy=="duration"&&i.sort((n,u)=>(n.duration||0)-(u.duration||0)),s.sortBy=="duration_desc"&&i.sort((n,u)=>(u.duration||0)-(n.duration||0)),s.sortBy=="provider"&&i.sort((n,u)=>n.provider.localeCompare(u.provider)),s.favoritesOnly&&(i=i.filter(n=>n.favorite)),s.albumType&&s.albumType.length>0&&(i=i.filter(n=>s.albumType?.includes(n.album_type))),i.slice(s.offset,s.offset+s.limit)},ye=async function(){let e=!0;(l.total||T.value.length)>250&&(e=await new Promise(i=>{confirm(g("select_all_confirmation"))?i(!0):i(!1)})),e&&(await We(),v.value=a.value,D.value=!0)};return(e,s)=>e.hideOnEmpty&&a.value.length==0?c("",!0):(r(),h("section",na,[y(xe,{icon:e.icon,title:e.title,count:o.value.search?a.value.length:e.total||T.value.length,color:"transparent","menu-items":qe.value,onTitleClicked:Z},{title:m(()=>[_t(e.$slots,"title",{},()=>[w(p(e.title),1)],!0)]),_:3},8,["icon","title","count","menu-items"]),y(Bt),fe.value?(r(),d(Pt,{key:0,id:"searchInput",modelValue:o.value.search,"onUpdate:modelValue":s[0]||(s[0]=i=>o.value.search=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=i=>C.value=!0),onBlur:s[2]||(s[2]=i=>C.value=!1),"onClick:clear":Ge},null,8,["modelValue","label"])):c("",!0),N.value?(r(),d(Ze,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:m(()=>[t.value?(r(),d(At,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):c("",!0),!Q.value&&!(a.value.length==0&&E.value)?(r(),d(Dt,{key:1,onLoad:ce,mode:e.infiniteScroll?"intersect":"manual","load-more-text":e.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:m(()=>[k.value=="panel"?(r(),d(we,{key:0},{default:m(()=>[(r(!0),h(be,null,ke(a.value,i=>(r(),d(Ie,{key:i.uri,cols:"12",class:P(`col-${f(ge)(e.$vuetify.display.width)}`)},{default:m(()=>[y(sa,{item:i,"is-selected":ee(i),"show-checkboxes":D.value,"show-actions":["tracks","albums","albumtracks"].includes(e.itemtype),"show-track-number":e.showTrackNumber,"is-available":f(ie)(i),"is-playing":te(i,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):c("",!0),k.value=="panel_compact"?(r(),d(we,{key:1},{default:m(()=>[(r(!0),h(be,null,ke(a.value,i=>(r(),d(Ie,{key:i.uri,cols:"12",class:P(`col-${f(ge)(e.$vuetify.display.width)}`)},{default:m(()=>[y(Ft,{item:i,"is-selected":ee(i),"show-checkboxes":D.value,"is-available":f(ie)(i),"is-playing":te(i,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):c("",!0),k.value=="list"?(r(),d(Lt,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:m(({item:i})=>[y(ta,{item:i,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":i.is_playable,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":D.value,"is-selected":ee(i),"is-available":f(ie)(i),"is-playing":te(i,e.itemtype),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","is-playing","show-details","parent-item"])]),_:1},8,["items"])):c("",!0)]),_:1},8,["mode","load-more-text"])):c("",!0),!t.value&&a.value.length==0?(r(),h("div",ra,[!t.value&&a.value.length==0&&(o.value.search||o.value.favoritesOnly)?(r(),d(Se,{key:0,title:e.$t("no_content_filter")},{default:m(()=>[o.value.search?(r(),d(W,{key:0,style:{"margin-top":"15px"},onClick:je},{default:m(()=>[w(p(e.$t("try_global_search")),1)]),_:1})):c("",!0)]),_:1},8,["title"])):!t.value&&a.value.length==0?(r(),d(Se,{key:1},{default:m(()=>[w(p(e.$t("no_content")),1)]),_:1})):c("",!0)])):c("",!0),y(Ot,{"model-value":v.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[y(W,{color:"primary",variant:"text",onClick:s[3]||(s[3]=i=>f(ue)(v.value,i.clientX,i.clientY,e.parentItem))},{default:m(()=>[w(p(e.$t("actions")),1)]),_:1})]),default:m(()=>[R("span",null,p(e.$t("items_selected",[v.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):c("",!0)]))}}),Aa=me(ua,[["__scopeId","data-v-ffd86056"]]);export{Aa as I};
