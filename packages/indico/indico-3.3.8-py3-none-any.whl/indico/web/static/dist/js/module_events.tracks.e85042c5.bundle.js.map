{"version":3,"file":"js/module_events.tracks.e85042c5.bundle.js","mappings":"+EA8EGA,OAxCMC,qBAAuB,WAE5BC,EAAE,yBACCC,GAAG,sBAAsB,WACxB,MAAMC,EAAaF,EAAEG,MACrBD,EAAWE,KAAK,8BAA8BC,MAAK,WACjD,MAAMC,EAAQN,EAAEG,MACZG,EAAMC,SANI,KAOZD,EAAME,SAAS,qDACfF,EAAML,GAAG,SAAS,KAChBK,EAAMG,YAAY,0BAA0B,IAGlD,IAEAP,EAAWE,KAAK,eAAeM,SAAS,CACtCC,MAAO,aACPC,OAAQ,4BACRC,KAAM,IACNC,OAAQ,OACRC,SAAU,EACVC,sBAAsB,EACtBC,YAAa,oBACbC,YAAa,cACbC,MAAAA,CAAOC,EAAGC,GAEJlB,OAASkB,EAAGC,KAAKC,SAAS,IAtDxC,WACE,MAAMC,EAAYxB,EAAE,yBACdyB,EAAaD,EAChBpB,KAAK,gBACLsB,KAAI,WACH,MAAMpB,EAAQN,EAAEG,MAChB,GAAIG,EAAMqB,SAAS,mBACjB,MAAO,CAACC,GAAItB,EAAMuB,KAAK,MAAOC,KAAM,SAC/B,CACL,IAAIP,EAAS,KACb,MAAMQ,EAAYzB,EAAM0B,QAAQ,oBAIhC,OAHID,EAAUE,SACZV,EAASQ,EAAUF,KAAK,OAEnB,CAACD,GAAItB,EAAMuB,KAAK,MAAOC,KAAM,QAASP,SAC/C,CACF,IACCW,MACHlC,EAAEmC,KAAK,CACLC,IAAKZ,EAAUK,KAAK,OACpBQ,OAAQ,OACRC,YAAa,mBACbT,KAAMU,KAAKC,UAAU,CAACC,WAAYhB,IAClCiB,SAAUC,SAASC,QAAQC,KAAKC,WAChCC,MAAOC,iBAEX,CA6BYC,EAEJ,EACAC,OAAAA,CAAQ9B,EAAGC,GACSrB,EAAEG,MAAM6B,QAAQ,oBACpBC,QAAUZ,EAAGC,KAAKK,SAAS,oBACvC3B,EAAEqB,EAAG8B,QAAQzC,SAAS,SAE1B,GAEJ,IACC0C,QAAQ,qBACb,C","sources":["webpack:///indico/modules/events/tracks/client/js/index.js"],"sourcesContent":["// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\n/* eslint-disable import/unambiguous */\n/* global handleAjaxError:false */\n(function(global) {\n  function updateSorting() {\n    const container = $('#track-list-container');\n    const sortedList = container\n      .find('li.track-row')\n      .map(function() {\n        const $this = $(this);\n        if ($this.hasClass('track-group-box')) {\n          return {id: $this.data('id'), type: 'group'};\n        } else {\n          let parent = null;\n          const parentDiv = $this.closest('.track-group-box');\n          if (parentDiv.length) {\n            parent = parentDiv.data('id');\n          }\n          return {id: $this.data('id'), type: 'track', parent};\n        }\n      })\n      .get();\n    $.ajax({\n      url: container.data('url'),\n      method: 'POST',\n      contentType: 'application/json',\n      data: JSON.stringify({sort_order: sortedList}),\n      complete: IndicoUI.Dialogs.Util.progress(),\n      error: handleAjaxError,\n    });\n  }\n\n  global.setupTrackManagement = function setupTrackManagement() {\n    const heightLimit = 50;\n    $('#track-list-container')\n      .on('indico:htmlUpdated', function() {\n        const $container = $(this);\n        $container.find('.track-list .track-content').each(function() {\n          const $this = $(this);\n          if ($this.height() > heightLimit) {\n            $this.addClass('track-content-collapsed track-content-collapsible');\n            $this.on('click', () => {\n              $this.toggleClass('track-content-collapsed');\n            });\n          }\n        });\n\n        $container.find('.track-list').sortable({\n          items: '.track-row',\n          handle: '.ui-i-box-sortable-handle',\n          axis: 'y',\n          cursor: 'move',\n          distance: 2,\n          forcePlaceholderSize: true,\n          placeholder: 'track-placeholder',\n          connectWith: '.track-list',\n          update(_, ui) {\n            // call update only once and only for the receiver\n            if (this === ui.item.parent()[0]) {\n              updateSorting();\n            }\n          },\n          receive(_, ui) {\n            const parentDiv = $(this).closest('.track-group-box');\n            if (parentDiv.length && ui.item.hasClass('track-group-box')) {\n              $(ui.sender).sortable('cancel');\n            }\n          },\n        });\n      })\n      .trigger('indico:htmlUpdated');\n  };\n})(window);\n"],"names":["window","setupTrackManagement","$","on","$container","this","find","each","$this","height","addClass","toggleClass","sortable","items","handle","axis","cursor","distance","forcePlaceholderSize","placeholder","connectWith","update","_","ui","item","parent","container","sortedList","map","hasClass","id","data","type","parentDiv","closest","length","get","ajax","url","method","contentType","JSON","stringify","sort_order","complete","IndicoUI","Dialogs","Util","progress","error","handleAjaxError","updateSorting","receive","sender","trigger"],"sourceRoot":""}