Metadata-Version: 2.4
Name: lims2-sdk
Version: 0.6.1
Summary: ç”Ÿä¿¡äº‘å¹³å° Python SDKï¼Œæä¾›å›¾è¡¨ä¸Šä¼ å’Œæ–‡ä»¶å­˜å‚¨åŠŸèƒ½
Author-email: Lims2 Team <support@lims2.com>
License: MIT
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: requests>=2.25.0
Requires-Dist: click>=8.0.0
Requires-Dist: oss2>=2.15.0
Requires-Dist: orjson>=3.8.0
Requires-Dist: tenacity>=8.0.0
Requires-Dist: plotly==6.2.0
Requires-Dist: kaleido==0.2.1

# Lims2 SDK

[![Version](https://img.shields.io/badge/version-0.6.1-blue.svg)](https://github.com/huangzhibo/lims2-sdk)
[![Python](https://img.shields.io/badge/python-â‰¥3.9-green.svg)](https://www.python.org/)

ç”Ÿä¿¡äº‘å¹³å° Python SDKï¼Œæä¾›å›¾è¡¨ä¸Šä¼ å’Œæ–‡ä»¶å­˜å‚¨åŠŸèƒ½ã€‚

**å½“å‰ç‰ˆæœ¬**: v0.6.1

## åŠŸèƒ½ç‰¹æ€§

- **å›¾è¡¨æœåŠ¡**ï¼šæ”¯æŒ Plotlyã€Cytoscapeã€å›¾ç‰‡ã€PDF æ ¼å¼ä¸Šä¼ 
- **ç¼©ç•¥å›¾ç”Ÿæˆ**ï¼šè‡ªåŠ¨ä¸º Plotly å›¾è¡¨ç”Ÿæˆé™æ€ç¼©ç•¥å›¾ï¼ˆ800Ã—600 WebPæ ¼å¼ï¼‰
- **æ–‡ä»¶å­˜å‚¨**ï¼šé€šè¿‡ STS å‡­è¯ä¸Šä¼ æ–‡ä»¶åˆ°é˜¿é‡Œäº‘ OSSï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ 
- **å‘½ä»¤è¡Œå·¥å…·**ï¼šæä¾›ä¾¿æ·çš„ CLI å‘½ä»¤
- **ç²¾åº¦æ§åˆ¶**ï¼šä½¿ç”¨ decimal åº“ç²¾ç¡®å››èˆäº”å…¥ï¼Œé»˜è®¤ä¿ç•™3ä½å°æ•°ï¼Œå‡å°‘ JSON æ–‡ä»¶å¤§å°ï¼ˆå¯å‡å°‘ 15-60%ï¼‰
- **è¿æ¥ä¼˜åŒ–**ï¼šè‡ªåŠ¨é‡è¯•æœºåˆ¶å¤„ç†ç½‘ç»œä¸ç¨³å®šé—®é¢˜ï¼Œé€‚åˆæ‰¹é‡ä¸Šä¼ åœºæ™¯

## å®‰è£…é…ç½®

### ä» PyPI å®‰è£…
```bash
pip install -U lims2-sdk
```

### è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export LIMS2_API_URL="your-api"
export LIMS2_API_TOKEN="your-api-token"
```

## å‘½ä»¤è¡Œä½¿ç”¨

### ğŸ“– è·å–å¸®åŠ©ä¿¡æ¯

```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
lims2 --help

# æŸ¥çœ‹å›¾è¡¨ä¸Šä¼ å¸®åŠ©
lims2 chart --help
lims2 chart upload --help

# æŸ¥çœ‹å­˜å‚¨æœåŠ¡å¸®åŠ©
lims2 storage --help
lims2 storage upload --help
lims2 storage upload-dir --help

# æŸ¥çœ‹æ–‡ä»¶æ“ä½œå¸®åŠ©
lims2 storage exists --help
lims2 storage info --help
```

### å›¾è¡¨ä¸Šä¼ 
```bash
# ä¸Šä¼ å›¾è¡¨æ–‡ä»¶ï¼ˆå®Œæ•´å‚æ•°ç¤ºä¾‹ï¼‰
lims2 chart upload plot.json -p proj_001 -n "åŸºå› è¡¨è¾¾åˆ†æ" -s sample_001 -t heatmap -d "å·®å¼‚è¡¨è¾¾çƒ­å›¾" -c A_vs_B -a Expression_statistics --precision 3
```

### æ–‡ä»¶å­˜å‚¨
```bash
# ä¸Šä¼ å•ä¸ªæ–‡ä»¶ï¼ˆç®€åŒ–ï¼‰
lims2 storage upload results.csv -p proj_001

# ä¸Šä¼ åˆ°æŒ‡å®šè·¯å¾„
lims2 storage upload results.csv -p proj_001 --base-path analysis

# ä¸Šä¼ ç›®å½•ï¼ˆç®€åŒ–ï¼‰
lims2 storage upload-dir output/ -p proj_001

# ä¸Šä¼ ç›®å½•åˆ°æŒ‡å®šè·¯å¾„
lims2 storage upload-dir output/ -p proj_001 --base-path analysis
```

## Python SDK ä½¿ç”¨
** å¤šä¸ªå›¾è¡¨ä¸Šä¼ ï¼Œæ¨èä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¯å¤ç”¨é“¾æ¥æ±  **

### æ¨èä½¿ç”¨æ–¹å¼ï¼ˆv0.4.1+ï¼‰

```python
from lims2 import Lims2Client

# åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆæ¨èå¤ç”¨ï¼Œé¿å…é‡å¤åˆ›å»ºè¿æ¥ï¼‰
client = Lims2Client()

# æ‰¹é‡ä¸Šä¼ æ—¶å¤ç”¨åŒä¸€ä¸ªå®¢æˆ·ç«¯å®ä¾‹
charts = ["plot1.json", "plot2.json", "plot3.json"]
for chart_file in charts:
    client.chart.upload(
        data_source=chart_file,
        project_id="proj_001",
        chart_name=f"å›¾è¡¨_{chart_file}",
        analysis_node="Expression_statistics",
        precision=3
    )
```

### å®Œæ•´å‚æ•°ç¤ºä¾‹

```python
# ä¸Šä¼ å›¾è¡¨ï¼ˆå®Œæ•´å‚æ•°ç¤ºä¾‹ï¼‰
client.chart.upload(
    data_source="plot.json",        # å›¾è¡¨æ•°æ®æºï¼šå­—å…¸ã€æ–‡ä»¶è·¯å¾„æˆ– Path å¯¹è±¡
    project_id="proj_001",          # é¡¹ç›® IDï¼ˆå¿…éœ€ï¼‰
    chart_name="åŸºå› è¡¨è¾¾åˆ†æ",        # å›¾è¡¨åç§°ï¼ˆå¿…éœ€ï¼‰
    sample_id="sample_001",         # æ ·æœ¬ IDï¼ˆå¯é€‰ï¼‰
    chart_type="heatmap",           # å›¾è¡¨ç±»å‹ï¼ˆå¯é€‰ï¼‰
    description="å·®å¼‚è¡¨è¾¾åŸºå› çƒ­å›¾",   # å›¾è¡¨æè¿°ï¼ˆå¯é€‰ï¼‰
    contrast="A_vs_B",              # å¯¹æ¯”ç­–ç•¥ï¼ˆå¯é€‰ï¼‰
    analysis_node="Expression_statistics",  # åˆ†æèŠ‚ç‚¹åç§°ï¼ˆå¯é€‰ï¼‰
    precision=3,                    # æµ®ç‚¹æ•°ç²¾åº¦ï¼š0-10ä½å°æ•°ï¼ˆé»˜è®¤3ï¼‰
    generate_thumbnail=True         # æ˜¯å¦ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆé»˜è®¤Trueï¼‰
)

# ä¸Šä¼ æ–‡ä»¶ï¼ˆæœ€ç®€ï¼‰
client.storage.upload_file("results.csv", "proj_001")

# ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„
client.storage.upload_file("results.csv", "proj_001", base_path="analysis")

# ä¸Šä¼ ç›®å½•ï¼ˆæœ€ç®€ï¼‰
client.storage.upload_directory("output/", "proj_001")

# ä¸Šä¼ ç›®å½•åˆ°æŒ‡å®šè·¯å¾„
client.storage.upload_directory("output/", "proj_001", base_path="analysis")
```

### ä¾¿æ·å‡½æ•°ï¼ˆå·²å¼ƒç”¨ï¼‰

> âš ï¸ **å¼ƒç”¨è­¦å‘Š**: ä»¥ä¸‹å‡½æ•°åœ¨ v0.4.1 ä¸­å·²å¼ƒç”¨ï¼Œå°†åœ¨ v0.5.0 ä¸­ç§»é™¤ã€‚æ¨èä½¿ç”¨ä¸Šè¿° `Lims2Client` å®ä¾‹æ–¹æ³•å¤ç”¨è¿æ¥æ± ï¼Œé¿å…æ‰¹é‡ä¸Šä¼ æ—¶çš„è¿æ¥é—®é¢˜ã€‚

```python
# ä¸æ¨èï¼šæ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–°è¿æ¥
from lims2 import upload_chart_from_file
upload_chart_from_file("å›¾è¡¨å", "proj_001", "chart.json")
```

## ç¼©ç•¥å›¾åŠŸèƒ½

### è‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾
v0.6.0 ç‰ˆæœ¬æ–°å¢äº† Plotly å›¾è¡¨çš„ç¼©ç•¥å›¾è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½ï¼š

```python
# é»˜è®¤å¯ç”¨ç¼©ç•¥å›¾ç”Ÿæˆ
client.chart.upload(
    data_source="plot.json",
    project_id="proj_001",
    chart_name="åŸºå› è¡¨è¾¾åˆ†æ"
    # generate_thumbnail=True  # é»˜è®¤ä¸º True
)

# ç¦ç”¨ç¼©ç•¥å›¾ç”Ÿæˆ
client.chart.upload(
    data_source="plot.json",
    project_id="proj_001",
    chart_name="åŸºå› è¡¨è¾¾åˆ†æ",
    generate_thumbnail=False
)
```

### ç¼©ç•¥å›¾é…ç½®
å¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ç¼©ç•¥å›¾å‚æ•°ï¼š

```bash
# æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆé»˜è®¤ trueï¼‰
export LIMS2_AUTO_GENERATE_THUMBNAIL=true

# ç¼©ç•¥å›¾å°ºå¯¸ï¼ˆé»˜è®¤ 800x600ï¼‰
export LIMS2_THUMBNAIL_WIDTH=800
export LIMS2_THUMBNAIL_HEIGHT=600

# ç¼©ç•¥å›¾æ ¼å¼ï¼ˆé»˜è®¤ webpï¼Œæ”¯æŒ pngã€jpegï¼‰
export LIMS2_THUMBNAIL_FORMAT=webp
```

### ç‰¹æ€§è¯´æ˜
- **è‡ªåŠ¨å®¹é”™**ï¼šä½¿ç”¨ `skip_invalid=True` è·³è¿‡æ— æ•ˆå±æ€§ï¼Œç¡®ä¿å…¼å®¹æ€§
- **æ ¼å¼ä¼˜åŒ–**ï¼šé»˜è®¤ä½¿ç”¨ WebP æ ¼å¼ï¼Œä½“ç§¯å°è´¨é‡é«˜
- **å¼‚æ­¥å¤„ç†**ï¼šç¼©ç•¥å›¾ç”Ÿæˆå¤±è´¥ä¸å½±å“ä¸»æ–‡ä»¶ä¸Šä¼ 
- **URL è¿”å›**ï¼šç”ŸæˆæˆåŠŸåè¿”å›ç¼©ç•¥å›¾ URL

## æ”¯æŒçš„æ•°æ®æ ¼å¼

### å›¾è¡¨æ ¼å¼
- **Plotly**: åŒ…å« `data` å’Œ `layout` å­—æ®µçš„å­—å…¸ï¼ˆæ”¯æŒç¼©ç•¥å›¾ï¼‰
- **Cytoscape**: åŒ…å« `elements` æˆ– `nodes`+`edges` å­—æ®µçš„å­—å…¸
- **å›¾ç‰‡**: PNG, JPG, JPEG, SVG
- **å…¶ä»–**: PDF

### æ–‡ä»¶æ ¼å¼
- æ”¯æŒä»»æ„æ ¼å¼çš„æ–‡ä»¶ä¸Šä¼ 
- è‡ªåŠ¨å¤„ç†å¤§æ–‡ä»¶ï¼ˆ>10MBï¼‰çš„æ–­ç‚¹ç»­ä¼ 
- æä¾›è¿›åº¦å›è°ƒæ”¯æŒ
