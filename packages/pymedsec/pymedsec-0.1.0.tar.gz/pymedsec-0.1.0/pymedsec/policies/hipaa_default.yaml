schema_version: '1.0.0'
name: 'HIPAA Default Policy'
description: 'Default policy for HIPAA compliance in healthcare image processing'

sanitization:
  dicom:
    remove_private_tags: true
    regenerate_uids: true
    preserve_technical_tags: true
    burned_in_annotation_policy: 'permissive' # use "strict" only if OCR is enabled
  exif:
    strip_all_metadata: true
    preserve_orientation: false
  ocr:
    enabled: false # set to true only if Tesseract+pytesseract installed
    confidence_threshold: 60
    redaction_method: 'blackout'

encryption:
  algorithm: 'AES-256-GCM'
  key_rotation_days: 90
  require_kms: true
  nonce_size_bits: 96

security:
  allow_plaintext_disk: true # enable for smoke test; set false after
  require_policy_match: true
  require_integrity_verification: true
  max_batch_size: 32
  require_tee: false

audit:
  log_all_operations: true
  include_file_hashes: true
  retention_days: 2557
  hmac_secret_rotation_days: 365
  rolling_anchor_interval: 1000

compliance:
  hipaa_mode: true
  gdpr_mode: false
  gxp_mode: false
  purpose_limitation: 'medical_treatment'
  data_minimization: true
  allowed_purposes:
    - 'medical_treatment'
    - 'medical_research'
    - 'quality_assurance'

phi_protection:
  minimum_necessary_standard: true
  access_controls_required: true
  transmission_security_required: true
  integrity_controls_required: true
  audit_controls_required: true
  safe_harbor_compliance: true
  remove_direct_identifiers: true
  statistical_disclosure_protection: true
