[tools]
python = "3.9"
uv = "latest"
pre-commit = "latest"

[env]
_.python.venv = { path = ".venv", create = true }
PYTHONPATH = "{{ cwd }}/.venv/lib/python3/site-packages/"

[settings]
python.uv_venv_auto = true
python.compile = false
experimental = true

[tasks.pre-commit]
description = "Install and pre-commit"
run = "pre-commit install"

[tasks.test]
description = "Run the pytests"
run = "uv run pytest"

[tasks.docs]
description = "Build the docs"
run = "uv sync --group docs && sphinx-build -b html docs build"

[hooks]
postinstall = ["mise pre-commit"]
enter = [
  "mkdir -p {{ cwd }}/.venv/lib/python3",
  "ln -sf {{ cwd }}/.venv/lib/python3*/site-packages {{ cwd }}/.venv/lib/python3/site-packages",
  "mise x -- uv sync",
]
