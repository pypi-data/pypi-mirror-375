import{l as F,r as a,j as e,B as n,t as u}from"./index-BRZ4tpHq.js";import{u as v}from"./useQuery-wclctLx1.js";import{f as S,h as L,i as R}from"./api-BDZ8mgcX.js";import{I as h}from"./input-CPdmn13N.js";import{H as A,S as I,T as k,C as q,P as E}from"./theme-switch-DorJDsGd.js";import{F as O}from"./floating-action-button-XEFQTGTy.js";import{M}from"./main-gqigjXqN.js";import"./index-L_x52GkC.js";import"./index-Dcf_pfkZ.js";import"./index-CTvPNZtd.js";import"./index-taeySYSj.js";import"./index-D-xJce4k.js";import"./index-COMQfmU0.js";import"./index-CzMLjddK.js";import"./index-BetNNbXV.js";import"./sign-out-dialog-GBgIxE2Q.js";import"./command-DU_R5alo.js";import"./index-BElOJd7n.js";import"./index-B6E7gDWi.js";import"./arrow-right-v-fqSTyu.js";import"./separator-DA0QZDJm.js";import"./check-46FVkbyV.js";const p={DEBUG:"#808080",INFO:"#0066CC",WARNING:"#FF8C00",ERROR:"#FF4444",CRITICAL:"#CC0000"},Q=["All","DEBUG","INFO","WARNING","ERROR","CRITICAL"];function T(){const r=F(),[l,N]=a.useState(!1),o=v({queryKey:["log-stats"],queryFn:L,refetchInterval:l?1e4:!1}),[i,y]=a.useState("All"),[d,b]=a.useState(""),[c,C]=a.useState(""),[m,w]=a.useState(100),t=v({queryKey:["logs",i,d,c,m],queryFn:()=>R({level:i==="All"?null:i,module:d.trim()||null,search:c.trim()||null,limit:m}),staleTime:2e3,refetchInterval:l?1e4:!1}),j=o.data?.total_logs??0,g=a.useMemo(()=>Object.entries(o.data?.by_level??{}),[o.data]);return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(I,{}),e.jsxs("div",{className:"ms-auto flex items-center gap-4",children:[e.jsx(k,{}),e.jsx(q,{}),e.jsx(E,{})]})]}),e.jsxs(O,{children:[e.jsx(n,{variant:l?"default":"outline",onClick:()=>N(s=>!s),className:"w-40 justify-center shadow-lg",children:l?"Auto Refresh: ON":"Auto Refresh: OFF"}),e.jsx(n,{onClick:async()=>{await r.invalidateQueries({queryKey:["logs"]}),await r.invalidateQueries({queryKey:["log-stats"]})},className:"shadow-lg",children:"Refresh"}),e.jsx(n,{variant:"destructive",onClick:async()=>{await S()?(u.success("All logs cleared"),await r.invalidateQueries({queryKey:["logs"]}),await r.invalidateQueries({queryKey:["log-stats"]})):u.error("Failed to clear logs")},className:"shadow-lg",children:"Clear All"})]}),e.jsxs(M,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"System Logs"}),e.jsx("p",{className:"text-muted-foreground",children:"Inspect logs and filter by level, module, or keywords."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-[2fr_1fr]",children:[e.jsxs("div",{className:"rounded border p-3",children:[e.jsx("div",{className:"mb-2 font-medium",children:"Log Statistics"}),j>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-3xl font-bold",children:j}),!!g.length&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:g.map(([s,x])=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-sm",style:{borderColor:p[s]||"#999",color:p[s]||"#999"},children:[s," ",e.jsx("span",{className:"font-semibold",children:x})]},s))})]}):e.jsx("div",{className:"text-muted-foreground text-sm",children:"No logs available"})]}),e.jsxs("div",{className:"rounded border p-3",children:[e.jsx("div",{className:"mb-2 font-medium",children:"Filter"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(s=>e.jsx("button",{className:`rounded-full border px-3 py-1 text-sm ${s===i?"bg-primary text-primary-foreground":"hover:bg-muted"}`,onClick:()=>y(s),children:s},s))}),e.jsx(h,{placeholder:"Module (e.g., config_manager)",value:d,onChange:s=>b(s.target.value)}),e.jsx(h,{placeholder:"Search in message...",value:c,onChange:s=>C(s.target.value)}),e.jsx(h,{type:"number",min:10,max:500,step:10,value:m,onChange:s=>w(Number(s.target.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[t.isLoading&&e.jsx("div",{children:"Loading logs..."}),t.error&&e.jsx("div",{className:"text-red-600",children:"Failed to load logs"}),t.data&&t.data.length>0&&e.jsxs("div",{className:"text-sm font-medium",children:["Showing ",t.data.length," logs"]}),t.data?.map((s,x)=>{const f=p[s.level]||"#000000";return e.jsxs("details",{className:"rounded border p-2",children:[e.jsxs("summary",{className:"cursor-pointer",children:[e.jsx("span",{className:"font-semibold",style:{color:f},children:s.level})," ",e.jsxs("span",{className:"text-muted-foreground",children:["[",(s.timestamp||"").slice(0,19),"]"]})," ",e.jsxs("code",{children:[s.module||"unknown",".",s.function||"unknown"]})," ","- ",s.message?.slice(0,100)]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Level:"})," ",e.jsx("span",{style:{color:f},children:s.level})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Timestamp:"})," ",s.timestamp]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Module:"})," ",e.jsx("code",{children:s.module})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Function:"})," ",e.jsx("code",{children:s.function})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold",children:"Message:"}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(s.message||""),u.success("Message copied")},children:"Copy"})]}),e.jsx("pre",{className:"bg-muted rounded p-2 text-sm whitespace-pre-wrap",children:s.message}),s.context&&Object.keys(s.context).length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold",children:"Context:"}),e.jsx("pre",{className:"bg-muted rounded p-2 text-sm whitespace-pre-wrap",children:JSON.stringify(s.context,null,2)})]}),s.correlation_id&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Correlation ID:"})," ",e.jsx("code",{children:s.correlation_id})]})]})]},x)}),t.data&&t.data.length===0&&e.jsx("div",{className:"text-muted-foreground text-sm",children:"No logs match the current filters."})]})]})]})}const ie=T;export{ie as component};
