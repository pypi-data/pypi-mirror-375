(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[803],{96597:function(e,t,r){Promise.resolve().then(r.bind(r,7840))},7840:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var a=r(57437),i=r(2265),n=r(14735),s=r(6877),o=r(59511),l=r(50386);function c(e){let{initialProjectState:t}=e,[r,c]=i.useState((0,n.fV)()),[d,u]=i.useState(t),[h,f]=i.useState({python:d.python,requirements:d.requirements}),{fsWorkerComm:p,fsReady:g}=(0,o.VC)({pageId:r}),[m,y]=i.useState(!1);return i.useEffect(()=>{let e=!1,t=async()=>{let t=d.code,r=d.requirements,a={...d};if(t.startsWith("http://")||t.startsWith("https://")){let e=await fetch("/i/request_proxy?uri=".concat(t));t=await e.text(),a={...a,code:t}}if((r.startsWith("http://")||r.startsWith("https://"))&&r.endsWith(".txt")){let e=await fetch("/i/request_proxy?uri=".concat(r));r=await e.text(),a={...a,requirements:r}}await (0,l._R)({projectState:a,fsWorkerComm:p}),e||(f({...h,requirements:d.requirements}),u(a),y(!0))};return g&&t(),()=>{e=!0}},[g,r]),(0,a.jsx)(a.Fragment,{children:m?(0,a.jsx)(s.Z,{type:d.type,start:"",pageId:r,python:h.python},"python-".concat(r)):(0,a.jsx)("div",{children:"Loading filesystem"})})}var d=r(93646),u=r(7032),h=r(91929);function f(){let e=i.useMemo(()=>window.location.search.includes("iframe"),[]),[t,r]=i.useState(null),[n,s]=i.useState(null),[o,l]=i.useState(null);return(i.useEffect(()=>{console.info("listening for messages"),window.parent.postMessage("ready","*");let e=async e=>{if("loadProject"===e.data.type){let t=e.data.projectData,r=t.signatureJwt;if(null===r){s(t.projectState),l("trial");return}await (0,d.gW)(t.projectState,r)?(s(t.projectState),l("valid")):l("invalid")}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),t)?(0,a.jsx)("h2",{children:t}):null!==n?(0,a.jsxs)(a.Fragment,{children:["invalid"===o&&(0,a.jsx)("h1",{children:"Error: Invalid signature"}),"trial"===o&&u.Xd.isPublic&&(0,a.jsxs)("h3",{style:{textAlign:"center",backgroundColor:"var(--color-primary)",padding:"1em 0",margin:"0"},children:["Trial version, if you would like to remove this message, please contact us at"," ",(0,a.jsx)("a",{href:"https://py.cafe/contact",target:"_blank",children:"PyCafe"}),(0,a.jsx)(h.Z,{style:{marginLeft:"0.4em",verticalAlign:"text-bottom"},children:"keyboard_double_arrow_right"})]}),"trial"===o&&!u.Xd.isPublic&&(0,a.jsxs)("h3",{style:{textAlign:"center",backgroundColor:"var(--color-primary)",padding:"1em 0",margin:"0"},children:["This file was created with a trial account, please obtain a license key at"," ",(0,a.jsx)("a",{href:"https://py.cafe/contact",target:"_blank",children:"PyCafe"}),(0,a.jsx)(h.Z,{style:{marginLeft:"0.4em",verticalAlign:"text-bottom"},children:"keyboard_double_arrow_right"})]}),(0,a.jsx)("div",{id:"iframe-parent",style:{display:"flex",flexDirection:"column",alignItems:"stretch",height:"100dvh",background:"none",backgroundColor:"var(--color-material-background)"},children:(0,a.jsx)("div",{style:{flex:"1 0 0"},children:(0,a.jsx)(c,{initialProjectState:n})})})]}):e?(0,a.jsx)("h1",{children:"Loading project..."}):(0,a.jsx)("h1",{children:"Error - No project opened."})}}},function(e){e.O(0,[436,72,218,155,50,182,36,543,5,386,971,117,744],function(){return e(e.s=96597)}),_N_E=e.O()}]);