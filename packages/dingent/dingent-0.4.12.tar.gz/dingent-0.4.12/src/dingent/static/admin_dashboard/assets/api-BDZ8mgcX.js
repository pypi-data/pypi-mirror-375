import{Z as i}from"./index-BRZ4tpHq.js";const d="/api/v1",w=12e4;function g(){return localStorage.getItem("DASHBOARD_TOKEN")}const e=i.create({baseURL:d,timeout:w});e.interceptors.request.use(t=>{const a=g();return a&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${a}`),t});function n(t){if(i.isAxiosError(t)){const a=t.response;return a?.data&&typeof a.data=="object"&&"detail"in a.data?String(a.data.detail):typeof a?.data=="string"?a.data:a?.status?`HTTP ${a.status}`:t.message||"Network error"}return String(t)}async function y(){try{const{data:t}=await e.get("/overview");return t}catch(t){throw new Error(`Failed to fetch overview: ${n(t)}`)}}async function h(){try{const{data:t}=await e.get("/overview/budget");return t}catch(t){throw new Error(`Failed to fetch budget: ${n(t)}`)}}async function k(){try{const{data:t}=await e.get("/settings");return t}catch(t){throw new Error(`Failed to fetch app settings: ${n(t)}`)}}async function p(t){try{await e.patch("/settings",t)}catch(a){throw new Error(`Failed to save app settings: ${n(a)}`)}}async function m(){try{const{data:t}=await e.get("/assistants");return t}catch{return[]}}async function v(t,a){try{const{data:r}=await e.post("/assistants",{name:t,description:a});return r}catch(r){throw new Error(`Failed to add assistant '${t}': ${n(r)}`)}}async function $(t){try{await e.delete(`/assistants/${t}`)}catch(a){throw new Error(`Failed to delete assistant '${t}': ${n(a)}`)}}async function A(t,a){try{await e.post(`/assistants/${t}/plugins`,{plugin_id:a})}catch(r){throw new Error(`Failed to add plugin '${a}': ${n(r)}`)}}async function E(t,a){try{await e.delete(`/assistants/${t}/plugins/${a}`)}catch(r){throw new Error(`Failed to remove plugin '${a}': ${n(r)}`)}}async function S(t,a){try{const r=structuredClone(a);r.plugins&&r.plugins.forEach(s=>{if(s.config&&Array.isArray(s.config)){const u=s.config.reduce((c,o)=>(o.value!==void 0&&o.value!==null&&(c[o.name]=o.value),c),{});s.config=u}});const{data:l}=await e.patch(`/assistants/${t}`,r);return l}catch(r){throw new Error(`Failed to update assistant: ${n(r)}`)}}async function b(){try{const{data:t}=await e.get("/plugins");return t}catch(t){throw new Error(`Failed to fetch available plugins: ${n(t)}`)}}async function _(t){try{const{data:a}=await e.get("/logs",{params:t});return a}catch(a){throw new Error(`Failed to fetch logs: ${n(a)}`)}}async function F(){try{const{data:t}=await e.get("/logs/stats");return t}catch{return{total_logs:0,by_level:{},by_module:{},oldest_timestamp:null,newest_timestamp:null}}}async function B(){try{return await e.delete("/logs/clear"),!0}catch{return!1}}async function O(){try{const{data:t}=await e.get("/workflows");return t}catch(t){return console.warn("Backend not available, returning mock workflows",t),[]}}async function T(t){try{console.log("Saving workflow",t);const{data:a}=await e.put(`/workflows/${t.id}`,t);return a}catch{return console.warn("Backend not available, mocking workflow save"),{...t,updated_at:new Date().toISOString()}}}async function D(t,a){try{const{data:r}=await e.post("/workflows",{name:t,description:a});return r}catch{return console.warn("Backend not available, mocking workflow creation"),{id:`mock-${Date.now()}`,name:t,description:a,nodes:[],edges:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}}async function M(t){try{await e.delete(`/workflows/${t}`)}catch{console.warn("Backend not available, mocking workflow deletion");return}}async function P(){try{const{data:t}=await e.get("/market/metadata");return t}catch(t){return console.warn("Backend not available, returning mock market metadata",t),{version:"1.0.0",updated_at:new Date().toISOString(),categories:{plugins:15,assistants:8,workflows:5}}}}async function I(t){try{const a=t?`/market/items?category=${t}`:"/market/items",{data:r}=await e.get(a);return r}catch(a){return console.warn("Backend not available, returning mock market items",a),[]}}async function L(t){try{const{data:a}=await e.post("/market/download",t);return a}catch(a){throw new Error(`Failed to download ${t.category} '${t.item_id}': ${n(a)}`)}}export{y as a,O as b,D as c,M as d,m as e,B as f,h as g,F as h,_ as i,L as j,P as k,I as l,A as m,v as n,$ as o,b as p,p as q,E as r,T as s,k as t,S as u};
