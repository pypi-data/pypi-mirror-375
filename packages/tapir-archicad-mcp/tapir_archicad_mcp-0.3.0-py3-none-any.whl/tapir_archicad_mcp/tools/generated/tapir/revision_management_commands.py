# This file is auto-generated by generate_tools.py. DO NOT EDIT.
import logging
from pydantic import ValidationError
from multiconn_archicad.basic_types import Port
from tapir_archicad_mcp.context import multi_conn_instance
from tapir_archicad_mcp.tools.tool_registry import register_tool_for_dispatch

from multiconn_archicad.models.tapir.commands import (
    GetCurrentRevisionChangesOfLayoutsParameters,
GetCurrentRevisionChangesOfLayoutsResult,
GetDocumentRevisionsResult,
GetRevisionChangesOfElementsParameters,
GetRevisionChangesOfElementsResult,
GetRevisionChangesResult,
GetRevisionIssuesResult
)


log = logging.getLogger()

def get_current_revision_changes_of_layouts(port: int, params: GetCurrentRevisionChangesOfLayoutsParameters) -> GetCurrentRevisionChangesOfLayoutsResult:
    """
    Retrieves all changes belong to the last revision of the given layouts.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetCurrentRevisionChangesOfLayouts",
            parameters=params.model_dump(mode='json')
        )
        return GetCurrentRevisionChangesOfLayoutsResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetCurrentRevisionChangesOfLayouts result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetCurrentRevisionChangesOfLayouts on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_current_revision_changes_of_layouts,
    name="revisions_get_current_revision_changes_of_layouts",
    title="GetCurrentRevisionChangesOfLayouts",
    description="Retrieves all changes belong to the last revision of the given layouts.",
    params_model=GetCurrentRevisionChangesOfLayoutsParameters,
    result_model=GetCurrentRevisionChangesOfLayoutsResult
)


def get_document_revisions(port: int) -> GetDocumentRevisionsResult:
    """
    Retrieves all document revisions.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetDocumentRevisions",
            parameters={}
        )
        return GetDocumentRevisionsResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetDocumentRevisions result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetDocumentRevisions on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_document_revisions,
    name="revisions_get_document_revisions",
    title="GetDocumentRevisions",
    description="Retrieves all document revisions.",
    params_model=None,
    result_model=GetDocumentRevisionsResult
)


def get_revision_changes(port: int) -> GetRevisionChangesResult:
    """
    Retrieves all changes.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetRevisionChanges",
            parameters={}
        )
        return GetRevisionChangesResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetRevisionChanges result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetRevisionChanges on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_revision_changes,
    name="revisions_get_revision_changes",
    title="GetRevisionChanges",
    description="Retrieves all changes.",
    params_model=None,
    result_model=GetRevisionChangesResult
)


def get_revision_changes_of_elements(port: int, params: GetRevisionChangesOfElementsParameters) -> GetRevisionChangesOfElementsResult:
    """
    Retrieves the changes belong to the given elements.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetRevisionChangesOfElements",
            parameters=params.model_dump(mode='json')
        )
        return GetRevisionChangesOfElementsResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetRevisionChangesOfElements result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetRevisionChangesOfElements on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_revision_changes_of_elements,
    name="revisions_get_revision_changes_of_elements",
    title="GetRevisionChangesOfElements",
    description="Retrieves the changes belong to the given elements.",
    params_model=GetRevisionChangesOfElementsParameters,
    result_model=GetRevisionChangesOfElementsResult
)


def get_revision_issues(port: int) -> GetRevisionIssuesResult:
    """
    Retrieves all issues.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_tapir_command(
            command="GetRevisionIssues",
            parameters={}
        )
        return GetRevisionIssuesResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for GetRevisionIssues result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing GetRevisionIssues on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get_revision_issues,
    name="revisions_get_revision_issues",
    title="GetRevisionIssues",
    description="Retrieves all issues.",
    params_model=None,
    result_model=GetRevisionIssuesResult
)
