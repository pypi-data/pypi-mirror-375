"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4098],{94348:(e,a,t)=>{var n=t(29079),i=t(637),l=t.n(i),r=t(14867),s=t.n(r),o=t(97598),d=t.n(o),c=t(86326),m=t(35623),u=t(42430),f=t(6423),p=t(87597),g=t(56237),y=t(26225),E=t(46145),v=t(32341),h=t(96478),F=t(49528),b=t(18606);const w=n.default.bind(null,{endpoint:"legal.display_privacy",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1}]}]},"/"),k=n.default.bind(null,{endpoint:"legal.display_tos",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tos",isDynamic:!1}]}]},"/");function T({cancelURL:e,moderated:a,tosUrl:t,tos:n,privacyPolicyUrl:i,privacyPolicy:r,termsRequireAccept:o,termsEffectiveDate:d,initialValues:m,hasPredefinedAffiliations:T,allowCustomAffiliations:q,showAccountForm:A,showUsernameField:_,syncedValues:L,emails:P,affiliationMeta:C,hasPendingUser:S,mandatoryFields:x,lockedFields:M,lockedFieldMessage:U}){const V=()=>{const e=e=>e.stopPropagation(),a=t?c.createElement("a",{href:k(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null),l=i?c.createElement("a",{href:w(),rel:"noreferrer",target:"_blank",onClick:e}):c.createElement("span",null);return(n||t)&&(r||i)?c.createElement(h.Translate,null,"I have read, understood and accept the"," ",c.createElement(h.Param,{name:"tosLink",wrapper:a},"terms of service")," ","and"," ",c.createElement(h.Param,{name:"privacyLink",wrapper:l},"privacy policy"),"."):n||t?c.createElement(h.Translate,null,"I have read, understood and accept the"," ",c.createElement(h.Param,{name:"tosLink",wrapper:a},"terms of service"),"."):r||i?c.createElement(h.Translate,null,"I have read, understood and accept the"," ",c.createElement(h.Param,{name:"privacyLink",wrapper:l},"privacy policy"),"."):void 0};return c.createElement(u.Form,{onSubmit:async(e,a)=>{const t=(0,E.getValuesForFields)(e,a);let n;delete t.password_confirm,T?t.affiliation_data&&(t.affiliation=t.affiliation_data.text.trim(),t.affiliation_id=t.affiliation_data.id,delete t.affiliation_data):delete t.affiliation_data;try{n=await F.indicoAxios.post(location.href,t)}catch(e){return(0,E.handleSubmitError)(e,T?{affiliation:"affiliation_data"}:{})}location.href=n.data.redirect,await new Promise((()=>{}))},initialValues:m,initialValuesEqual:l().isEqual,subscription:{submitting:!0},validate:e=>{const a={};return e.password&&e.password_confirm&&e.password_confirm!==e.password&&(a.password_confirm=h.Translate.string("Passwords must match")),a}},(m=>c.createElement(f.A,{onSubmit:m.handleSubmit},!A&&c.createElement(u.Field,{name:"synced_fields",isEqual:l().isEqual,render:()=>null}),S&&c.createElement(p.A,{info:!0},c.createElement(h.Translate,null,"There is already some information in Indico that concerns you. We are going to link it automatically.")),c.createElement(v.Fieldset,{legend:h.Translate.string("User information"),active:A||a},P.length>1?c.createElement(y.SyncedFinalDropdown,{name:"email",label:h.Translate.string("Email address"),options:P.map((e=>({key:e,value:e,text:e}))),syncedValues:L,lockedFields:M,lockedFieldMessage:U,required:!0}):c.createElement(y.SyncedFinalInput,{name:"email",label:h.Translate.string("Email address"),syncedValues:L,lockedFields:M,lockedFieldMessage:U,readOnly:!0}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(y.SyncedFinalInput,{name:"first_name",label:h.Translate.string("First name"),required:!0,syncedValues:L,lockedFields:M,lockedFieldMessage:U,validate:E.validators.maxLength(250)}),c.createElement(y.SyncedFinalInput,{name:"last_name",label:h.Translate.string("Last name"),required:!0,syncedValues:L,lockedFields:M,lockedFieldMessage:U,validate:E.validators.maxLength(250)})),T?c.createElement(y.SyncedFinalAffiliationDropdown,{name:"affiliation_data",required:a&&x.includes("affiliation"),syncName:"affiliation",syncedValues:L,lockedFields:M,lockedFieldMessage:U,currentAffiliation:C,allowCustomAffiliations:q}):c.createElement(y.SyncedFinalInput,{name:"affiliation",label:h.Translate.string("Affiliation"),required:a&&x.includes("affiliation"),syncedValues:L,lockedFields:M,lockedFieldMessage:U,validate:e=>void 0!==e&&E.validators.maxLength(250)(e)}),"address"in L&&c.createElement(y.SyncedFinalTextArea,{name:"address",label:h.Translate.string("Address"),syncedValues:L,lockedFields:M,lockedFieldMessage:U,validate:E.validators.maxLength(500)}),"phone"in L&&c.createElement(y.SyncedFinalInput,{name:"phone",label:h.Translate.string("Phone number"),syncedValues:L,lockedFields:M,lockedFieldMessage:U,validate:E.validators.maxLength(100)})),A&&c.createElement(v.Fieldset,{legend:h.Translate.string("Login details")},_&&c.createElement(E.FinalInput,{name:"username",label:h.Translate.string("Username"),required:!0,validate:E.validators.maxLength(100)}),c.createElement(f.A.Group,{widths:"equal"},c.createElement(E.FinalInput,{name:"password",type:"password",label:h.Translate.string("Password"),autoComplete:"new-password",required:!0,validate:E.validators.maxLength(100)}),c.createElement(E.FinalInput,{name:"password_confirm",type:"password",label:h.Translate.string("Confirm password"),autoComplete:"new-password",required:!0,validate:E.validators.maxLength(100)})),(0,b.renderPluginComponents)("signup-form-after-password")),a&&c.createElement(v.Fieldset,{legend:h.Translate.string("Account moderation")},c.createElement(p.A,{info:!0},c.createElement(h.Translate,null,"Each new account needs to be approved by an administrator. We will send you an email as soon as your request has been approved.")),c.createElement(v.FinalTextArea,{required:x.includes("comment"),name:"comment",initialValue:"",label:h.Translate.string("Comment"),description:h.Translate.string("You can provide additional information or a comment for the administrators who will review your registration."),validate:e=>void 0!==e&&E.validators.maxLength(1e3)(e)})),o&&!!n&&!t&&c.createElement(v.Fieldset,{legend:h.Translate.string("Terms of service")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:n}})),o&&!!r&&!i&&c.createElement(v.Fieldset,{legend:h.Translate.string("Privacy Policy")},c.createElement("div",{className:"field policy editor-output",dangerouslySetInnerHTML:{__html:r}})),o&&!!d&&c.createElement("div",{className:"field"},c.createElement(h.Translate,null,"Last updated"),": ",s()(d).format("LL")),o&&c.createElement(v.FinalCheckbox,{name:"accept_terms",required:!0,label:c.createElement("label",null,V())}),c.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},c.createElement(E.FinalSubmitButton,{disabledUntilChange:!1,label:a?h.Translate.string("Submit registration request"):h.Translate.string("Create my Indico profile"),className:"submit-button"}),c.createElement(f.A.Field,{disabled:m.submitting},c.createElement(g.A,{as:"a",href:e,disabled:m.submitting},c.createElement(h.Translate,null,"Cancel")))))))}T.propTypes={cancelURL:d().string.isRequired,moderated:d().bool.isRequired,tos:d().string,tosUrl:d().string,privacyPolicy:d().string,privacyPolicyUrl:d().string,termsRequireAccept:d().bool,termsEffectiveDate:d().string,initialValues:d().object.isRequired,hasPredefinedAffiliations:d().bool.isRequired,allowCustomAffiliations:d().bool.isRequired,showAccountForm:d().bool.isRequired,showUsernameField:d().bool,syncedValues:d().object.isRequired,emails:d().arrayOf(d().string).isRequired,affiliationMeta:d().object,hasPendingUser:d().bool,mandatoryFields:d().arrayOf(d().string).isRequired,lockedFields:d().arrayOf(d().string),lockedFieldMessage:d().string},T.defaultProps={tos:"",tosUrl:"",privacyPolicy:"",privacyPolicyUrl:"",termsRequireAccept:!1,termsEffectiveDate:null,showUsernameField:!1,affiliationMeta:null,hasPendingUser:!1,lockedFields:[],lockedFieldMessage:""},document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#signup-container");if(!e)return;const a=JSON.parse(e.dataset.config);m.render(c.createElement(T,a),e)}))}},e=>{e.O(0,[4644,4394,2076],(()=>{return a=94348,e(e.s=a);var a}));e.O()}]);
//# sourceMappingURL=module_auth.signup.410f987f.bundle.js.map