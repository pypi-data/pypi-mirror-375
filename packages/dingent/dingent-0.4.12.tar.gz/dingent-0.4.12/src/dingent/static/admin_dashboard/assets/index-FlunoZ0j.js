import{i as ua,R as da,r as I,j as x,k as xr,B as ot,l as fa,t as ue}from"./index-BRZ4tpHq.js";import{u as uo}from"./useQuery-wclctLx1.js";import{u as pn,L as ha}from"./loading-skeleton-9fdPr0DJ.js";import{c as ga,d as pa,s as ma,b as ya,e as xa}from"./api-BDZ8mgcX.js";import{H as wa,S as va,T as ba,C as _a,P as Sa}from"./theme-switch-DorJDsGd.js";import{E as wr}from"./empty-state-CU2gGm9v.js";import{M as Ea}from"./main-gqigjXqN.js";import{I as fo}from"./input-CPdmn13N.js";import{L as ho}from"./label-BMnosuv_.js";import{D as Na,a as Ca,b as ka,c as Ma,d as $a}from"./command-DU_R5alo.js";import{c as vr}from"./index-CTvPNZtd.js";import{S as Ia}from"./save-CRpBw9jE.js";import{G as Aa,H as Da,I as Pa,J as Ta,K as Ha,N as za,O as La}from"./sign-out-dialog-GBgIxE2Q.js";import"./index-L_x52GkC.js";import"./index-Dcf_pfkZ.js";import"./index-taeySYSj.js";import"./index-D-xJce4k.js";import"./index-COMQfmU0.js";import"./index-CzMLjddK.js";import"./index-BetNNbXV.js";import"./separator-DA0QZDJm.js";import"./check-46FVkbyV.js";import"./index-BElOJd7n.js";import"./index-B6E7gDWi.js";import"./arrow-right-v-fqSTyu.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ja=vr("plus",Ra);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ba=vr("trash-2",Oa);function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Va={value:()=>{}};function en(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Rt(n)}function Rt(e){this._=e}function Fa(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Rt.prototype=en.prototype={constructor:Rt,on:function(e,t){var n=this._,o=Fa(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=Ya(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=go(n[r],e.name,t);else if(t==null)for(r in n)n[r]=go(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Rt(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function Ya(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function go(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Va,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nn="http://www.w3.org/1999/xhtml";const po={svg:"http://www.w3.org/2000/svg",xhtml:Nn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),po.hasOwnProperty(t)?{space:po[t],local:e}:e}function Xa(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Nn&&t.documentElement.namespaceURI===Nn?t.createElement(e):t.createElementNS(n,e)}}function Wa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function br(e){var t=tn(e);return(t.local?Wa:Xa)(t)}function Za(){}function jn(e){return e==null?Za:function(){return this.querySelector(e)}}function qa(e){typeof e!="function"&&(e=jn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ce(o,this._parents)}function Ga(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ka(){return[]}function _r(e){return e==null?Ka:function(){return this.querySelectorAll(e)}}function Qa(e){return function(){return Ga(e.apply(this,arguments))}}function Ua(e){typeof e=="function"?e=Qa(e):e=_r(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(o.push(e.call(c,c.__data__,l,s)),r.push(c));return new ce(o,r)}function Sr(e){return function(){return this.matches(e)}}function Er(e){return function(t){return t.matches(e)}}var Ja=Array.prototype.find;function ec(e){return function(){return Ja.call(this.children,e)}}function tc(){return this.firstElementChild}function nc(e){return this.select(e==null?tc:ec(typeof e=="function"?e:Er(e)))}var oc=Array.prototype.filter;function rc(){return Array.from(this.children)}function ic(e){return function(){return oc.call(this.children,e)}}function sc(e){return this.selectAll(e==null?rc:ic(typeof e=="function"?e:Er(e)))}function ac(e){typeof e!="function"&&(e=Sr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new ce(o,this._parents)}function Nr(e){return new Array(e.length)}function cc(){return new ce(this._enter||this._groups.map(Nr),this._parents)}function Ft(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ft.prototype={constructor:Ft,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function lc(e){return function(){return e}}function uc(e,t,n,o,r,i){for(var s=0,a,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new Ft(e,i[s]);for(;s<c;++s)(a=t[s])&&(r[s]=a)}function dc(e,t,n,o,r,i,s){var a,c,l=new Map,u=t.length,h=i.length,d=new Array(u),f;for(a=0;a<u;++a)(c=t[a])&&(d[a]=f=s.call(c,c.__data__,a,t)+"",l.has(f)?r[a]=c:l.set(f,c));for(a=0;a<h;++a)f=s.call(e,i[a],a,i)+"",(c=l.get(f))?(o[a]=c,c.__data__=i[a],l.delete(f)):n[a]=new Ft(e,i[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(d[a])===c&&(r[a]=c)}function fc(e){return e.__data__}function hc(e,t){if(!arguments.length)return Array.from(this,fc);var n=t?dc:uc,o=this._parents,r=this._groups;typeof e!="function"&&(e=lc(e));for(var i=r.length,s=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var u=o[l],h=r[l],d=h.length,f=gc(e.call(u,u&&u.__data__,l,o)),y=f.length,m=a[l]=new Array(y),b=s[l]=new Array(y),v=c[l]=new Array(d);n(u,h,m,b,v,f,t);for(var M=0,g=0,w,C;M<y;++M)if(w=m[M]){for(M>=g&&(g=M+1);!(C=b[g])&&++g<y;);w._next=C||null}}return s=new ce(s,o),s._enter=a,s._exit=c,s}function gc(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pc(){return new ce(this._exit||this._groups.map(Nr),this._parents)}function mc(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function yc(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),c=0;c<s;++c)for(var l=n[c],u=o[c],h=l.length,d=a[c]=new Array(h),f,y=0;y<h;++y)(f=l[y]||u[y])&&(d[y]=f);for(;c<r;++c)a[c]=n[c];return new ce(a,this._parents)}function xc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function wc(e){e||(e=vc);function t(h,d){return h&&d?e(h.__data__,d.__data__):!h-!d}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,c=r[i]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new ce(r,this._parents).order()}function vc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function bc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function _c(){return Array.from(this)}function Sc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function Ec(){let e=0;for(const t of this)++e;return e}function Nc(){return!this.node()}function Cc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function kc(e){return function(){this.removeAttribute(e)}}function Mc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $c(e,t){return function(){this.setAttribute(e,t)}}function Ic(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ac(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Dc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Pc(e,t){var n=tn(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Mc:kc:typeof t=="function"?n.local?Dc:Ac:n.local?Ic:$c)(n,t))}function Cr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Tc(e){return function(){this.style.removeProperty(e)}}function Hc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function zc(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Lc(e,t,n){return arguments.length>1?this.each((t==null?Tc:typeof t=="function"?zc:Hc)(e,t,n??"")):Fe(this.node(),e)}function Fe(e,t){return e.style.getPropertyValue(t)||Cr(e).getComputedStyle(e,null).getPropertyValue(t)}function Rc(e){return function(){delete this[e]}}function jc(e,t){return function(){this[e]=t}}function Oc(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Bc(e,t){return arguments.length>1?this.each((t==null?Rc:typeof t=="function"?Oc:jc)(e,t)):this.node()[e]}function kr(e){return e.trim().split(/^|\s+/)}function On(e){return e.classList||new Mr(e)}function Mr(e){this._node=e,this._names=kr(e.getAttribute("class")||"")}Mr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function $r(e,t){for(var n=On(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Ir(e,t){for(var n=On(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function Vc(e){return function(){$r(this,e)}}function Fc(e){return function(){Ir(this,e)}}function Yc(e,t){return function(){(t.apply(this,arguments)?$r:Ir)(this,e)}}function Xc(e,t){var n=kr(e+"");if(arguments.length<2){for(var o=On(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Yc:t?Vc:Fc)(n,t))}function Wc(){this.textContent=""}function Zc(e){return function(){this.textContent=e}}function qc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Gc(e){return arguments.length?this.each(e==null?Wc:(typeof e=="function"?qc:Zc)(e)):this.node().textContent}function Kc(){this.innerHTML=""}function Qc(e){return function(){this.innerHTML=e}}function Uc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Jc(e){return arguments.length?this.each(e==null?Kc:(typeof e=="function"?Uc:Qc)(e)):this.node().innerHTML}function el(){this.nextSibling&&this.parentNode.appendChild(this)}function tl(){return this.each(el)}function nl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ol(){return this.each(nl)}function rl(e){var t=typeof e=="function"?e:br(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function il(){return null}function sl(e,t){var n=typeof e=="function"?e:br(e),o=t==null?il:typeof t=="function"?t:jn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function al(){var e=this.parentNode;e&&e.removeChild(this)}function cl(){return this.each(al)}function ll(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ul(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dl(e){return this.select(e?ul:ll)}function fl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function hl(e){return function(t){e.call(this,t,this.__data__)}}function gl(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function pl(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function ml(e,t,n){return function(){var o=this.__on,r,i=hl(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function yl(e,t,n){var o=gl(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(r=0,u=a[c];r<i;++r)if((s=o[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?ml:pl,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function Ar(e,t,n){var o=Cr(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function xl(e,t){return function(){return Ar(this,e,t)}}function wl(e,t){return function(){return Ar(this,e,t.apply(this,arguments))}}function vl(e,t){return this.each((typeof t=="function"?wl:xl)(e,t))}function*bl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Dr=[null];function ce(e,t){this._groups=e,this._parents=t}function mt(){return new ce([[document.documentElement]],Dr)}function _l(){return this}ce.prototype=mt.prototype={constructor:ce,select:qa,selectAll:Ua,selectChild:nc,selectChildren:sc,filter:ac,data:hc,enter:cc,exit:pc,join:mc,merge:yc,selection:_l,order:xc,sort:wc,call:bc,nodes:_c,node:Sc,size:Ec,empty:Nc,each:Cc,attr:Pc,style:Lc,property:Bc,classed:Xc,text:Gc,html:Jc,raise:tl,lower:ol,append:rl,insert:sl,remove:cl,clone:dl,datum:fl,on:yl,dispatch:vl,[Symbol.iterator]:bl};function ae(e){return typeof e=="string"?new ce([[document.querySelector(e)]],[document.documentElement]):new ce([[e]],Dr)}function Sl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function de(e,t){if(e=Sl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const El={passive:!1},st={capture:!0,passive:!1};function mn(e){e.stopImmediatePropagation()}function Be(e){e.preventDefault(),e.stopImmediatePropagation()}function Pr(e){var t=e.document.documentElement,n=ae(e).on("dragstart.drag",Be,st);"onselectstart"in t?n.on("selectstart.drag",Be,st):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Tr(e,t){var n=e.document.documentElement,o=ae(e).on("dragstart.drag",null);t&&(o.on("click.drag",Be,st),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Mt=e=>()=>e;function Cn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Cn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Nl(e){return!e.ctrlKey&&!e.button}function Cl(){return this.parentNode}function kl(e,t){return t??{x:e.x,y:e.y}}function Ml(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hr(){var e=Nl,t=Cl,n=kl,o=Ml,r={},i=en("start","drag","end"),s=0,a,c,l,u,h=0;function d(w){w.on("mousedown.drag",f).filter(o).on("touchstart.drag",b).on("touchmove.drag",v,El).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(w,C){if(!(u||!e.call(this,w,C))){var N=g(this,t.call(this,w,C),w,C,"mouse");N&&(ae(w.view).on("mousemove.drag",y,st).on("mouseup.drag",m,st),Pr(w.view),mn(w),l=!1,a=w.clientX,c=w.clientY,N("start",w))}}function y(w){if(Be(w),!l){var C=w.clientX-a,N=w.clientY-c;l=C*C+N*N>h}r.mouse("drag",w)}function m(w){ae(w.view).on("mousemove.drag mouseup.drag",null),Tr(w.view,l),Be(w),r.mouse("end",w)}function b(w,C){if(e.call(this,w,C)){var N=w.changedTouches,$=t.call(this,w,C),P=N.length,T,j;for(T=0;T<P;++T)(j=g(this,$,w,C,N[T].identifier,N[T]))&&(mn(w),j("start",w,N[T]))}}function v(w){var C=w.changedTouches,N=C.length,$,P;for($=0;$<N;++$)(P=r[C[$].identifier])&&(Be(w),P("drag",w,C[$]))}function M(w){var C=w.changedTouches,N=C.length,$,P;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),$=0;$<N;++$)(P=r[C[$].identifier])&&(mn(w),P("end",w,C[$]))}function g(w,C,N,$,P,T){var j=i.copy(),R=de(T||N,C),k,A,p;if((p=n.call(w,new Cn("beforestart",{sourceEvent:N,target:d,identifier:P,active:s,x:R[0],y:R[1],dx:0,dy:0,dispatch:j}),$))!=null)return k=p.x-R[0]||0,A=p.y-R[1]||0,function _(S,E,H){var D=R,z;switch(S){case"start":r[P]=_,z=s++;break;case"end":delete r[P],--s;case"drag":R=de(H||E,C),z=s;break}j.call(S,w,new Cn(S,{sourceEvent:E,subject:p,target:d,identifier:P,active:z,x:R[0]+k,y:R[1]+A,dx:R[0]-D[0],dy:R[1]-D[1],dispatch:j}),$)}}return d.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Mt(!!w),d):e},d.container=function(w){return arguments.length?(t=typeof w=="function"?w:Mt(w),d):t},d.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Mt(w),d):n},d.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:Mt(!!w),d):o},d.on=function(){var w=i.on.apply(i,arguments);return w===i?d:w},d.clickDistance=function(w){return arguments.length?(h=(w=+w)*w,d):Math.sqrt(h)},d}function Bn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function zr(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function yt(){}var at=.7,Yt=1/at,Ve="\\s*([+-]?\\d+)\\s*",ct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ye="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$l=/^#([0-9a-f]{3,8})$/,Il=new RegExp(`^rgb\\(${Ve},${Ve},${Ve}\\)$`),Al=new RegExp(`^rgb\\(${ye},${ye},${ye}\\)$`),Dl=new RegExp(`^rgba\\(${Ve},${Ve},${Ve},${ct}\\)$`),Pl=new RegExp(`^rgba\\(${ye},${ye},${ye},${ct}\\)$`),Tl=new RegExp(`^hsl\\(${ct},${ye},${ye}\\)$`),Hl=new RegExp(`^hsla\\(${ct},${ye},${ye},${ct}\\)$`),mo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bn(yt,Pe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yo,formatHex:yo,formatHex8:zl,formatHsl:Ll,formatRgb:xo,toString:xo});function yo(){return this.rgb().formatHex()}function zl(){return this.rgb().formatHex8()}function Ll(){return Lr(this).formatHsl()}function xo(){return this.rgb().formatRgb()}function Pe(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=$l.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?wo(t):n===3?new se(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$t(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$t(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Il.exec(e))?new se(t[1],t[2],t[3],1):(t=Al.exec(e))?new se(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Dl.exec(e))?$t(t[1],t[2],t[3],t[4]):(t=Pl.exec(e))?$t(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Tl.exec(e))?_o(t[1],t[2]/100,t[3]/100,1):(t=Hl.exec(e))?_o(t[1],t[2]/100,t[3]/100,t[4]):mo.hasOwnProperty(e)?wo(mo[e]):e==="transparent"?new se(NaN,NaN,NaN,0):null}function wo(e){return new se(e>>16&255,e>>8&255,e&255,1)}function $t(e,t,n,o){return o<=0&&(e=t=n=NaN),new se(e,t,n,o)}function Rl(e){return e instanceof yt||(e=Pe(e)),e?(e=e.rgb(),new se(e.r,e.g,e.b,e.opacity)):new se}function kn(e,t,n,o){return arguments.length===1?Rl(e):new se(e,t,n,o??1)}function se(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}Bn(se,kn,zr(yt,{brighter(e){return e=e==null?Yt:Math.pow(Yt,e),new se(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?at:Math.pow(at,e),new se(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new se(Ae(this.r),Ae(this.g),Ae(this.b),Xt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vo,formatHex:vo,formatHex8:jl,formatRgb:bo,toString:bo}));function vo(){return`#${Ie(this.r)}${Ie(this.g)}${Ie(this.b)}`}function jl(){return`#${Ie(this.r)}${Ie(this.g)}${Ie(this.b)}${Ie((isNaN(this.opacity)?1:this.opacity)*255)}`}function bo(){const e=Xt(this.opacity);return`${e===1?"rgb(":"rgba("}${Ae(this.r)}, ${Ae(this.g)}, ${Ae(this.b)}${e===1?")":`, ${e})`}`}function Xt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ae(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ie(e){return e=Ae(e),(e<16?"0":"")+e.toString(16)}function _o(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fe(e,t,n,o)}function Lr(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);if(e instanceof yt||(e=Pe(e)),!e)return new fe;if(e instanceof fe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,c=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+r:2-i-r,s*=60):a=c>0&&c<1?0:s,new fe(s,a,c,e.opacity)}function Ol(e,t,n,o){return arguments.length===1?Lr(e):new fe(e,t,n,o??1)}function fe(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}Bn(fe,Ol,zr(yt,{brighter(e){return e=e==null?Yt:Math.pow(Yt,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?at:Math.pow(at,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new se(yn(e>=240?e-240:e+120,r,o),yn(e,r,o),yn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new fe(So(this.h),It(this.s),It(this.l),Xt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xt(this.opacity);return`${e===1?"hsl(":"hsla("}${So(this.h)}, ${It(this.s)*100}%, ${It(this.l)*100}%${e===1?")":`, ${e})`}`}}));function So(e){return e=(e||0)%360,e<0?e+360:e}function It(e){return Math.max(0,Math.min(1,e||0))}function yn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vn=e=>()=>e;function Bl(e,t){return function(n){return e+n*t}}function Vl(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function Fl(e){return(e=+e)==1?Rr:function(t,n){return n-t?Vl(t,n,e):Vn(isNaN(t)?n:t)}}function Rr(e,t){var n=t-e;return n?Bl(e,n):Vn(isNaN(e)?t:e)}const Wt=(function e(t){var n=Fl(t);function o(r,i){var s=n((r=kn(r)).r,(i=kn(i)).r),a=n(r.g,i.g),c=n(r.b,i.b),l=Rr(r.opacity,i.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=c(u),r.opacity=l(u),r+""}}return o.gamma=e,o})(1);function Yl(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),r;return function(i){for(r=0;r<n;++r)o[r]=e[r]*(1-i)+t[r]*i;return o}}function Xl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Wl(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,r=new Array(o),i=new Array(n),s;for(s=0;s<o;++s)r[s]=rt(e[s],t[s]);for(;s<n;++s)i[s]=t[s];return function(a){for(s=0;s<o;++s)i[s]=r[s](a);return i}}function Zl(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function pe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ql(e,t){var n={},o={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=rt(e[r],t[r]):o[r]=t[r];return function(i){for(r in n)o[r]=n[r](i);return o}}var Mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xn=new RegExp(Mn.source,"g");function Gl(e){return function(){return e}}function Kl(e){return function(t){return e(t)+""}}function jr(e,t){var n=Mn.lastIndex=xn.lastIndex=0,o,r,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(o=Mn.exec(e))&&(r=xn.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,c.push({i:s,x:pe(o,r)})),n=xn.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?Kl(c[0].x):Gl(t):(t=c.length,function(l){for(var u=0,h;u<t;++u)a[(h=c[u]).i]=h.x(l);return a.join("")})}function rt(e,t){var n=typeof t,o;return t==null||n==="boolean"?Vn(t):(n==="number"?pe:n==="string"?(o=Pe(t))?(t=o,Wt):jr:t instanceof Pe?Wt:t instanceof Date?Zl:Xl(t)?Yl:Array.isArray(t)?Wl:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ql:pe)(e,t)}var Eo=180/Math.PI,$n={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Or(e,t,n,o,r,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*o)&&(n-=e*c,o-=t*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),e*o<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*Eo,skewX:Math.atan(c)*Eo,scaleX:s,scaleY:a}}var At;function Ql(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$n:Or(t.a,t.b,t.c,t.d,t.e,t.f)}function Ul(e){return e==null||(At||(At=document.createElementNS("http://www.w3.org/2000/svg","g")),At.setAttribute("transform",e),!(e=At.transform.baseVal.consolidate()))?$n:(e=e.matrix,Or(e.a,e.b,e.c,e.d,e.e,e.f))}function Br(e,t,n,o){function r(l){return l.length?l.pop()+" ":""}function i(l,u,h,d,f,y){if(l!==h||u!==d){var m=f.push("translate(",null,t,null,n);y.push({i:m-4,x:pe(l,h)},{i:m-2,x:pe(u,d)})}else(h||d)&&f.push("translate("+h+t+d+n)}function s(l,u,h,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:h.push(r(h)+"rotate(",null,o)-2,x:pe(l,u)})):u&&h.push(r(h)+"rotate("+u+o)}function a(l,u,h,d){l!==u?d.push({i:h.push(r(h)+"skewX(",null,o)-2,x:pe(l,u)}):u&&h.push(r(h)+"skewX("+u+o)}function c(l,u,h,d,f,y){if(l!==h||u!==d){var m=f.push(r(f)+"scale(",null,",",null,")");y.push({i:m-4,x:pe(l,h)},{i:m-2,x:pe(u,d)})}else(h!==1||d!==1)&&f.push(r(f)+"scale("+h+","+d+")")}return function(l,u){var h=[],d=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,h,d),s(l.rotate,u.rotate,h,d),a(l.skewX,u.skewX,h,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,h,d),l=u=null,function(f){for(var y=-1,m=d.length,b;++y<m;)h[(b=d[y]).i]=b.x(f);return h.join("")}}}var Jl=Br(Ql,"px, ","px)","deg)"),eu=Br(Ul,", ",")",")"),tu=1e-12;function No(e){return((e=Math.exp(e))+1/e)/2}function nu(e){return((e=Math.exp(e))-1/e)/2}function ou(e){return((e=Math.exp(2*e))-1)/(e+1)}const jt=(function e(t,n,o){function r(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],h=s[1],d=s[2],f=u-a,y=h-c,m=f*f+y*y,b,v;if(m<tu)v=Math.log(d/l)/t,b=function($){return[a+$*f,c+$*y,l*Math.exp(t*$*v)]};else{var M=Math.sqrt(m),g=(d*d-l*l+o*m)/(2*l*n*M),w=(d*d-l*l-o*m)/(2*d*n*M),C=Math.log(Math.sqrt(g*g+1)-g),N=Math.log(Math.sqrt(w*w+1)-w);v=(N-C)/t,b=function($){var P=$*v,T=No(C),j=l/(n*M)*(T*ou(t*P+C)-nu(C));return[a+j*f,c+j*y,l*T/No(t*P+C)]}}return b.duration=v*1e3*t/Math.SQRT2,b}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},r})(Math.SQRT2,2,4);var Ye=0,tt=0,Je=0,Vr=1e3,Zt,nt,qt=0,Te=0,nn=0,lt=typeof performance=="object"&&performance.now?performance:Date,Fr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Fn(){return Te||(Fr(ru),Te=lt.now()+nn)}function ru(){Te=0}function Gt(){this._call=this._time=this._next=null}Gt.prototype=Yr.prototype={constructor:Gt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Fn():+n)+(t==null?0:+t),!this._next&&nt!==this&&(nt?nt._next=this:Zt=this,nt=this),this._call=e,this._time=n,In()},stop:function(){this._call&&(this._call=null,this._time=1/0,In())}};function Yr(e,t,n){var o=new Gt;return o.restart(e,t,n),o}function iu(){Fn(),++Ye;for(var e=Zt,t;e;)(t=Te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ye}function Co(){Te=(qt=lt.now())+nn,Ye=tt=0;try{iu()}finally{Ye=0,au(),Te=0}}function su(){var e=lt.now(),t=e-qt;t>Vr&&(nn-=t,qt=e)}function au(){for(var e,t=Zt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Zt=n);nt=e,In(o)}function In(e){if(!Ye){tt&&(tt=clearTimeout(tt));var t=e-Te;t>24?(e<1/0&&(tt=setTimeout(Co,e-lt.now()-nn)),Je&&(Je=clearInterval(Je))):(Je||(qt=lt.now(),Je=setInterval(su,Vr)),Ye=1,Fr(Co))}}function ko(e,t,n){var o=new Gt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var cu=en("start","end","cancel","interrupt"),lu=[],Xr=0,Mo=1,An=2,Ot=3,$o=4,Dn=5,Bt=6;function on(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;uu(e,n,{name:t,index:o,group:r,on:cu,tween:lu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Xr})}function Yn(e,t){var n=ge(e,t);if(n.state>Xr)throw new Error("too late; already scheduled");return n}function we(e,t){var n=ge(e,t);if(n.state>Ot)throw new Error("too late; already running");return n}function ge(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function uu(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=Yr(i,0,n.time);function i(l){n.state=Mo,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,h,d,f;if(n.state!==Mo)return c();for(u in o)if(f=o[u],f.name===n.name){if(f.state===Ot)return ko(s);f.state===$o?(f.state=Bt,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete o[u]):+u<t&&(f.state=Bt,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete o[u])}if(ko(function(){n.state===Ot&&(n.state=$o,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=An,n.on.call("start",e,e.__data__,n.index,n.group),n.state===An){for(n.state=Ot,r=new Array(d=n.tween.length),u=0,h=-1;u<d;++u)(f=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=f);r.length=h+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Dn,1),h=-1,d=r.length;++h<d;)r[h].call(e,u);n.state===Dn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Bt,n.timer.stop(),delete o[t];for(var l in o)return;delete e.__transition}}function Vt(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>An&&o.state<Dn,o.state=Bt,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function du(e){return this.each(function(){Vt(this,e)})}function fu(e,t){var n,o;return function(){var r=we(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function hu(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=we(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},c=0,l=r.length;c<l;++c)if(r[c].name===t){r[c]=a;break}c===l&&r.push(a)}i.tween=r}}function gu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ge(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?fu:hu)(n,e,t))}function Xn(e,t,n){var o=e._id;return e.each(function(){var r=we(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ge(r,o).value[t]}}function Wr(e,t){var n;return(typeof t=="number"?pe:t instanceof Pe?Wt:(n=Pe(t))?(t=n,Wt):jr)(e,t)}function pu(e){return function(){this.removeAttribute(e)}}function mu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function yu(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function xu(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function wu(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function vu(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function bu(e,t){var n=tn(e),o=n==="transform"?eu:Wr;return this.attrTween(e,typeof t=="function"?(n.local?vu:wu)(n,o,Xn(this,"attr."+e,t)):t==null?(n.local?mu:pu)(n):(n.local?xu:yu)(n,o,t))}function _u(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Su(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Eu(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Su(e,i)),n}return r._value=t,r}function Nu(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&_u(e,i)),n}return r._value=t,r}function Cu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=tn(e);return this.tween(n,(o.local?Eu:Nu)(o,t))}function ku(e,t){return function(){Yn(this,e).delay=+t.apply(this,arguments)}}function Mu(e,t){return t=+t,function(){Yn(this,e).delay=t}}function $u(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ku:Mu)(t,e)):ge(this.node(),t).delay}function Iu(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function Au(e,t){return t=+t,function(){we(this,e).duration=t}}function Du(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Iu:Au)(t,e)):ge(this.node(),t).duration}function Pu(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function Tu(e){var t=this._id;return arguments.length?this.each(Pu(t,e)):ge(this.node(),t).ease}function Hu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function zu(e){if(typeof e!="function")throw new Error;return this.each(Hu(this._id,e))}function Lu(e){typeof e!="function"&&(e=Sr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new Se(o,this._parents,this._name,this._id)}function Ru(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var c=t[a],l=n[a],u=c.length,h=s[a]=new Array(u),d,f=0;f<u;++f)(d=c[f]||l[f])&&(h[f]=d);for(;a<o;++a)s[a]=t[a];return new Se(s,this._parents,this._name,this._id)}function ju(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ou(e,t,n){var o,r,i=ju(t)?Yn:we;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function Bu(e,t){var n=this._id;return arguments.length<2?ge(this.node(),n).on.on(e):this.each(Ou(n,e,t))}function Vu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Fu(){return this.on("end.remove",Vu(this._id))}function Yu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=jn(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],c=a.length,l=i[s]=new Array(c),u,h,d=0;d<c;++d)(u=a[d])&&(h=e.call(u,u.__data__,d,a))&&("__data__"in u&&(h.__data__=u.__data__),l[d]=h,on(l[d],t,n,d,l,ge(u,n)));return new Se(i,this._parents,t,n)}function Xu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_r(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var c=o[a],l=c.length,u,h=0;h<l;++h)if(u=c[h]){for(var d=e.call(u,u.__data__,h,c),f,y=ge(u,n),m=0,b=d.length;m<b;++m)(f=d[m])&&on(f,t,n,m,d,y);i.push(d),s.push(u)}return new Se(i,s,t,n)}var Wu=mt.prototype.constructor;function Zu(){return new Wu(this._groups,this._parents)}function qu(e,t){var n,o,r;return function(){var i=Fe(this,e),s=(this.style.removeProperty(e),Fe(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Zr(e){return function(){this.style.removeProperty(e)}}function Gu(e,t,n){var o,r=n+"",i;return function(){var s=Fe(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function Ku(e,t,n){var o,r,i;return function(){var s=Fe(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Fe(this,e))),s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a))}}function Qu(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var c=we(this,e),l=c.on,u=c.value[i]==null?a||(a=Zr(t)):void 0;(l!==n||r!==u)&&(o=(n=l).copy()).on(s,r=u),c.on=o}}function Uu(e,t,n){var o=(e+="")=="transform"?Jl:Wr;return t==null?this.styleTween(e,qu(e,o)).on("end.style."+e,Zr(e)):typeof t=="function"?this.styleTween(e,Ku(e,o,Xn(this,"style."+e,t))).each(Qu(this._id,e)):this.styleTween(e,Gu(e,o,t),n).on("end.style."+e,null)}function Ju(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function ed(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&Ju(e,s,n)),o}return i._value=t,i}function td(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,ed(e,t,n??""))}function nd(e){return function(){this.textContent=e}}function od(e){return function(){var t=e(this);this.textContent=t??""}}function rd(e){return this.tween("text",typeof e=="function"?od(Xn(this,"text",e)):nd(e==null?"":e+""))}function id(e){return function(t){this.textContent=e.call(this,t)}}function sd(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&id(r)),t}return o._value=e,o}function ad(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,sd(e))}function cd(){for(var e=this._name,t=this._id,n=qr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=ge(c,t);on(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Se(o,this._parents,e,n)}function ld(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--r===0&&i()}};n.each(function(){var l=we(this,o),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),r===0&&i()})}var ud=0;function Se(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function qr(){return++ud}var ve=mt.prototype;Se.prototype={constructor:Se,select:Yu,selectAll:Xu,selectChild:ve.selectChild,selectChildren:ve.selectChildren,filter:Lu,merge:Ru,selection:Zu,transition:cd,call:ve.call,nodes:ve.nodes,node:ve.node,size:ve.size,empty:ve.empty,each:ve.each,on:Bu,attr:bu,attrTween:Cu,style:Uu,styleTween:td,text:rd,textTween:ad,remove:Fu,tween:gu,delay:$u,duration:Du,ease:Tu,easeVarying:zu,end:ld,[Symbol.iterator]:ve[Symbol.iterator]};function dd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var fd={time:null,delay:0,duration:250,ease:dd};function hd(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function gd(e){var t,n;e instanceof Se?(t=e._id,e=e._name):(t=qr(),(n=fd).time=Fn(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&on(c,e,t,l,s,n||hd(c,t));return new Se(o,this._parents,e,t)}mt.prototype.interrupt=du;mt.prototype.transition=gd;const Dt=e=>()=>e;function pd(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function be(e,t,n){this.k=e,this.x=t,this.y=n}be.prototype={constructor:be,scale:function(e){return e===1?this:new be(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new be(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var rn=new be(1,0,0);Gr.prototype=be.prototype;function Gr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return rn;return e.__zoom}function wn(e){e.stopImmediatePropagation()}function et(e){e.preventDefault(),e.stopImmediatePropagation()}function md(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function yd(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Io(){return this.__zoom||rn}function xd(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function wd(){return navigator.maxTouchPoints||"ontouchstart"in this}function vd(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Kr(){var e=md,t=yd,n=vd,o=xd,r=wd,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=jt,l=en("start","zoom","end"),u,h,d,f=500,y=150,m=0,b=10;function v(p){p.property("__zoom",Io).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",j).filter(r).on("touchstart.zoom",R).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(p,_,S,E){var H=p.selection?p.selection():p;H.property("__zoom",Io),p!==H?C(p,_,S,E):H.interrupt().each(function(){N(this,arguments).event(E).start().zoom(null,typeof _=="function"?_.apply(this,arguments):_).end()})},v.scaleBy=function(p,_,S,E){v.scaleTo(p,function(){var H=this.__zoom.k,D=typeof _=="function"?_.apply(this,arguments):_;return H*D},S,E)},v.scaleTo=function(p,_,S,E){v.transform(p,function(){var H=t.apply(this,arguments),D=this.__zoom,z=S==null?w(H):typeof S=="function"?S.apply(this,arguments):S,L=D.invert(z),B=typeof _=="function"?_.apply(this,arguments):_;return n(g(M(D,B),z,L),H,s)},S,E)},v.translateBy=function(p,_,S,E){v.transform(p,function(){return n(this.__zoom.translate(typeof _=="function"?_.apply(this,arguments):_,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,E)},v.translateTo=function(p,_,S,E,H){v.transform(p,function(){var D=t.apply(this,arguments),z=this.__zoom,L=E==null?w(D):typeof E=="function"?E.apply(this,arguments):E;return n(rn.translate(L[0],L[1]).scale(z.k).translate(typeof _=="function"?-_.apply(this,arguments):-_,typeof S=="function"?-S.apply(this,arguments):-S),D,s)},E,H)};function M(p,_){return _=Math.max(i[0],Math.min(i[1],_)),_===p.k?p:new be(_,p.x,p.y)}function g(p,_,S){var E=_[0]-S[0]*p.k,H=_[1]-S[1]*p.k;return E===p.x&&H===p.y?p:new be(p.k,E,H)}function w(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function C(p,_,S,E){p.on("start.zoom",function(){N(this,arguments).event(E).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(E).end()}).tween("zoom",function(){var H=this,D=arguments,z=N(H,D).event(E),L=t.apply(H,D),B=S==null?w(L):typeof S=="function"?S.apply(H,D):S,X=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),V=H.__zoom,Z=typeof _=="function"?_.apply(H,D):_,K=c(V.invert(B).concat(X/V.k),Z.invert(B).concat(X/Z.k));return function(F){if(F===1)F=Z;else{var O=K(F),W=X/O[2];F=new be(W,B[0]-O[0]*W,B[1]-O[1]*W)}z.zoom(null,F)}})}function N(p,_,S){return!S&&p.__zooming||new $(p,_)}function $(p,_){this.that=p,this.args=_,this.active=0,this.sourceEvent=null,this.extent=t.apply(p,_),this.taps=0}$.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,_){return this.mouse&&p!=="mouse"&&(this.mouse[1]=_.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=_.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=_.invert(this.touch1[0])),this.that.__zoom=_,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var _=ae(this.that).datum();l.call(p,this.that,new pd(p,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:l}),_)}};function P(p,..._){if(!e.apply(this,arguments))return;var S=N(this,_).event(p),E=this.__zoom,H=Math.max(i[0],Math.min(i[1],E.k*Math.pow(2,o.apply(this,arguments)))),D=de(p);if(S.wheel)(S.mouse[0][0]!==D[0]||S.mouse[0][1]!==D[1])&&(S.mouse[1]=E.invert(S.mouse[0]=D)),clearTimeout(S.wheel);else{if(E.k===H)return;S.mouse=[D,E.invert(D)],Vt(this),S.start()}et(p),S.wheel=setTimeout(z,y),S.zoom("mouse",n(g(M(E,H),S.mouse[0],S.mouse[1]),S.extent,s));function z(){S.wheel=null,S.end()}}function T(p,..._){if(d||!e.apply(this,arguments))return;var S=p.currentTarget,E=N(this,_,!0).event(p),H=ae(p.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",X,!0),D=de(p,S),z=p.clientX,L=p.clientY;Pr(p.view),wn(p),E.mouse=[D,this.__zoom.invert(D)],Vt(this),E.start();function B(V){if(et(V),!E.moved){var Z=V.clientX-z,K=V.clientY-L;E.moved=Z*Z+K*K>m}E.event(V).zoom("mouse",n(g(E.that.__zoom,E.mouse[0]=de(V,S),E.mouse[1]),E.extent,s))}function X(V){H.on("mousemove.zoom mouseup.zoom",null),Tr(V.view,E.moved),et(V),E.event(V).end()}}function j(p,..._){if(e.apply(this,arguments)){var S=this.__zoom,E=de(p.changedTouches?p.changedTouches[0]:p,this),H=S.invert(E),D=S.k*(p.shiftKey?.5:2),z=n(g(M(S,D),E,H),t.apply(this,_),s);et(p),a>0?ae(this).transition().duration(a).call(C,z,E,p):ae(this).call(v.transform,z,E,p)}}function R(p,..._){if(e.apply(this,arguments)){var S=p.touches,E=S.length,H=N(this,_,p.changedTouches.length===E).event(p),D,z,L,B;for(wn(p),z=0;z<E;++z)L=S[z],B=de(L,this),B=[B,this.__zoom.invert(B),L.identifier],H.touch0?!H.touch1&&H.touch0[2]!==B[2]&&(H.touch1=B,H.taps=0):(H.touch0=B,D=!0,H.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(H.taps<2&&(h=B[0],u=setTimeout(function(){u=null},f)),Vt(this),H.start())}}function k(p,..._){if(this.__zooming){var S=N(this,_).event(p),E=p.changedTouches,H=E.length,D,z,L,B;for(et(p),D=0;D<H;++D)z=E[D],L=de(z,this),S.touch0&&S.touch0[2]===z.identifier?S.touch0[0]=L:S.touch1&&S.touch1[2]===z.identifier&&(S.touch1[0]=L);if(z=S.that.__zoom,S.touch1){var X=S.touch0[0],V=S.touch0[1],Z=S.touch1[0],K=S.touch1[1],F=(F=Z[0]-X[0])*F+(F=Z[1]-X[1])*F,O=(O=K[0]-V[0])*O+(O=K[1]-V[1])*O;z=M(z,Math.sqrt(F/O)),L=[(X[0]+Z[0])/2,(X[1]+Z[1])/2],B=[(V[0]+K[0])/2,(V[1]+K[1])/2]}else if(S.touch0)L=S.touch0[0],B=S.touch0[1];else return;S.zoom("touch",n(g(z,L,B),S.extent,s))}}function A(p,..._){if(this.__zooming){var S=N(this,_).event(p),E=p.changedTouches,H=E.length,D,z;for(wn(p),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),D=0;D<H;++D)z=E[D],S.touch0&&S.touch0[2]===z.identifier?delete S.touch0:S.touch1&&S.touch1[2]===z.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(z=de(z,this),Math.hypot(h[0]-z[0],h[1]-z[1])<b)){var L=ae(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return v.wheelDelta=function(p){return arguments.length?(o=typeof p=="function"?p:Dt(+p),v):o},v.filter=function(p){return arguments.length?(e=typeof p=="function"?p:Dt(!!p),v):e},v.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Dt(!!p),v):r},v.extent=function(p){return arguments.length?(t=typeof p=="function"?p:Dt([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),v):t},v.scaleExtent=function(p){return arguments.length?(i[0]=+p[0],i[1]=+p[1],v):[i[0],i[1]]},v.translateExtent=function(p){return arguments.length?(s[0][0]=+p[0][0],s[1][0]=+p[1][0],s[0][1]=+p[0][1],s[1][1]=+p[1][1],v):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},v.constrain=function(p){return arguments.length?(n=p,v):n},v.duration=function(p){return arguments.length?(a=+p,v):a},v.interpolate=function(p){return arguments.length?(c=p,v):c},v.on=function(){var p=l.on.apply(l,arguments);return p===l?v:p},v.clickDistance=function(p){return arguments.length?(m=(p=+p)*p,v):Math.sqrt(m)},v.tapDistance=function(p){return arguments.length?(b=+p,v):b},v}const xe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},ut=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Qr=["Enter"," ","Escape"],Ur={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Xe;(function(e){e.Strict="strict",e.Loose="loose"})(Xe||(Xe={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var dt;(function(e){e.Partial="partial",e.Full="full"})(dt||(dt={}));const Jr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ke;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ke||(ke={}));var Kt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Kt||(Kt={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));const Ao={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top};function ei(e){return e===null?null:e?"valid":"invalid"}const ti=e=>"id"in e&&"source"in e&&"target"in e,bd=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Wn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),xt=(e,t=[0,0])=>{const{width:n,height:o}=Ee(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},_d=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const i=typeof r=="string";let s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):Wn(r)?r:t.nodeLookup.get(r.id));const a=s?Qt(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return sn(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return an(n)},wt=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const r=Qt(o);n=sn(n,r)}}),an(n)},Zn=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{const a={...bt(t,[n,o,r]),width:t.width/r,height:t.height/r},c=[];for(const l of e.values()){const{measured:u,selectable:h=!0,hidden:d=!1}=l;if(s&&!h||d)continue;const f=u.width??l.width??l.initialWidth??null,y=u.height??l.height??l.initialHeight??null,m=ft(a,Ze(l)),b=(f??0)*(y??0),v=i&&m>0;(!l.internals.handleBounds||v||m>=b||l.dragging)&&c.push(l)}return c},Sd=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Ed(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Nd({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const a=Ed(e,s),c=wt(a),l=qn(c,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(l,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function ni({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??o;let h=s.extent||r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",xe.error005());else{const f=a.measured.width,y=a.measured.height;f&&y&&(h=[[c,l],[c+f,l+y]])}else a&&qe(s.extent)&&(h=[[s.extent[0][0]+c,s.extent[0][1]+l],[s.extent[1][0]+c,s.extent[1][1]+l]]);const d=qe(h)?He(t,h,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",xe.error015()),{position:{x:d.x-c+(s.measured.width??0)*u[0],y:d.y-l+(s.measured.height??0)*u[1]},positionAbsolute:d}}async function Cd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(e.map(d=>d.id)),s=[];for(const d of n){if(d.deletable===!1)continue;const f=i.has(d.id),y=!f&&d.parentId&&s.find(m=>m.id===d.parentId);(f||y)&&s.push(d)}const a=new Set(t.map(d=>d.id)),c=o.filter(d=>d.deletable!==!1),u=Sd(s,c);for(const d of c)a.has(d.id)&&!u.find(y=>y.id===d.id)&&u.push(d);if(!r)return{edges:u,nodes:s};const h=await r({nodes:s,edges:u});return typeof h=="boolean"?h?{edges:u,nodes:s}:{edges:[],nodes:[]}:h}const We=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),He=(e={x:0,y:0},t,n)=>({x:We(e.x,t[0][0],t[1][0]-(n?.width??0)),y:We(e.y,t[0][1],t[1][1]-(n?.height??0))});function oi(e,t,n){const{width:o,height:r}=Ee(n),{x:i,y:s}=n.internals.positionAbsolute;return He(e,[[i,s],[i+o,s+r]],t)}const Do=(e,t,n)=>e<t?We(Math.abs(e-t),1,t)/t:e>n?-We(Math.abs(e-n),1,t)/t:0,ri=(e,t,n=15,o=40)=>{const r=Do(e.x,o,t.width-o)*n,i=Do(e.y,o,t.height-o)*n;return[r,i]},sn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pn=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),an=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ze=(e,t=[0,0])=>{const{x:n,y:o}=Wn(e)?e.internals.positionAbsolute:xt(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Qt=(e,t=[0,0])=>{const{x:n,y:o}=Wn(e)?e.internals.positionAbsolute:xt(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},ii=(e,t)=>an(sn(Pn(e),Pn(t))),ft=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Po=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),kd=(e,t)=>{},vt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),bt=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return i?vt(a,s):a},Ut=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Re(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Md(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Re(e,n),r=Re(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=Re(e.top??e.y??0,n),r=Re(e.bottom??e.y??0,n),i=Re(e.left??e.x??0,t),s=Re(e.right??e.x??0,t);return{top:o,right:s,bottom:r,left:i,x:i+s,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function $d(e,t,n,o,r,i){const{x:s,y:a}=Ut(e,[t,n,o]),{x:c,y:l}=Ut({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=r-c,h=i-l;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(h)}}const qn=(e,t,n,o,r,i)=>{const s=Md(i,t,n),a=(t-s.x)/e.width,c=(n-s.y)/e.height,l=Math.min(a,c),u=We(l,o,r),h=e.x+e.width/2,d=e.y+e.height/2,f=t/2-h*u,y=n/2-d*u,m=$d(e,f,y,u,t,n),b={left:Math.min(m.left-s.left,0),top:Math.min(m.top-s.top,0),right:Math.min(m.right-s.right,0),bottom:Math.min(m.bottom-s.bottom,0)};return{x:f-b.left+b.right,y:y-b.top+b.bottom,zoom:u}},ht=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function qe(e){return e!=null&&e!=="parent"}function Ee(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function si(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ai(e,t={width:0,height:0},n,o,r){const i={...e},s=o.get(n);if(s){const a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function To(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Id(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function Ad(e){return{...Ur,...e||{}}}function it(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:s}=me(e),a=bt({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:c,y:l}=n?vt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const Gn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ci=e=>e?.getRootNode?.()||window?.document,Dd=["INPUT","SELECT","TEXTAREA"];function li(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Dd.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ui=e=>"clientX"in e,me=(e,t)=>{const n=ui(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Ho=(e,t,n,o,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Gn(s)}})};function di({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+r*.375+s*.375+n*.125,l=t*.125+i*.375+a*.375+o*.125,u=Math.abs(c-e),h=Math.abs(l-t);return[c,l,u,h]}function Pt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function zo({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case Y.Left:return[t-Pt(t-o,i),n];case Y.Right:return[t+Pt(o-t,i),n];case Y.Top:return[t,n-Pt(n-r,i)];case Y.Bottom:return[t,n+Pt(r-n,i)]}}function fi({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:r,targetPosition:i=Y.Top,curvature:s=.25}){const[a,c]=zo({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[l,u]=zo({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[h,d,f,y]=di({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${o},${r}`,h,d,f,y]}function hi({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function Pd({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o,elevateOnSelect:r=!1}){if(o!==void 0)return o;const i=r&&n?1e3:0,s=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return i+s}function Td({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const i=sn(Qt(e),Qt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return ft(s,an(i))>0}const Hd=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,zd=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),gi=(e,t)=>{if(!e.source||!e.target)return t;let n;return ti(e)?n={...e}:n={...e,id:Hd(e)},zd(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function pi({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,s,a]=hi({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}const Lo={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},Ld=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ro=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Rd({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:o=Y.Top,center:r,offset:i,stepPosition:s}){const a=Lo[t],c=Lo[o],l={x:e.x+a.x*i,y:e.y+a.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},h=Ld({source:l,sourcePosition:t,target:u}),d=h.x!==0?"x":"y",f=h[d];let y=[],m,b;const v={x:0,y:0},M={x:0,y:0},[,,g,w]=hi({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*c[d]===-1){d==="x"?(m=r.x??l.x+(u.x-l.x)*s,b=r.y??(l.y+u.y)/2):(m=r.x??(l.x+u.x)/2,b=r.y??l.y+(u.y-l.y)*s);const N=[{x:m,y:l.y},{x:m,y:u.y}],$=[{x:l.x,y:b},{x:u.x,y:b}];a[d]===f?y=d==="x"?N:$:y=d==="x"?$:N}else{const N=[{x:l.x,y:u.y}],$=[{x:u.x,y:l.y}];if(d==="x"?y=a.x===f?$:N:y=a.y===f?N:$,t===o){const k=Math.abs(e[d]-n[d]);if(k<=i){const A=Math.min(i-1,i-k);a[d]===f?v[d]=(l[d]>e[d]?-1:1)*A:M[d]=(u[d]>n[d]?-1:1)*A}}if(t!==o){const k=d==="x"?"y":"x",A=a[d]===c[k],p=l[k]>u[k],_=l[k]<u[k];(a[d]===1&&(!A&&p||A&&_)||a[d]!==1&&(!A&&_||A&&p))&&(y=d==="x"?N:$)}const P={x:l.x+v.x,y:l.y+v.y},T={x:u.x+M.x,y:u.y+M.y},j=Math.max(Math.abs(P.x-y[0].x),Math.abs(T.x-y[0].x)),R=Math.max(Math.abs(P.y-y[0].y),Math.abs(T.y-y[0].y));j>=R?(m=(P.x+T.x)/2,b=y[0].y):(m=y[0].x,b=(P.y+T.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...y,{x:u.x+M.x,y:u.y+M.y},n],m,b,g,w]}function jd(e,t,n,o){const r=Math.min(Ro(e,t)/2,Ro(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+r*l},${s}Q ${i},${s} ${i},${s+r*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+r*c}Q ${i},${s} ${i+r*a},${s}`}function Tn({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:r,targetPosition:i=Y.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20,stepPosition:u=.5}){const[h,d,f,y,m]=Rd({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:c},offset:l,stepPosition:u});return[h.reduce((v,M,g)=>{let w="";return g>0&&g<h.length-1?w=jd(h[g-1],M,h[g+1],s):w=`${g===0?"M":"L"}${M.x} ${M.y}`,v+=w,v},""),d,f,y,m]}function jo(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Od(e){const{sourceNode:t,targetNode:n}=e;if(!jo(t)||!jo(n))return null;const o=t.internals.handleBounds||Oo(t.handles),r=n.internals.handleBounds||Oo(n.handles),i=Bo(o?.source??[],e.sourceHandle),s=Bo(e.connectionMode===Xe.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",xe.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=i?.position||Y.Bottom,c=s?.position||Y.Top,l=gt(t,i,a),u=gt(n,s,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function Oo(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function gt(e,t,n=Y.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Ee(e);if(o)return{x:r+s/2,y:i+a/2};switch(t?.position??n){case Y.Top:return{x:r+s/2,y:i};case Y.Right:return{x:r+s,y:i+a/2};case Y.Bottom:return{x:r+s/2,y:i+a};case Y.Left:return{x:r,y:i+a/2}}}function Bo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Hn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Bd(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(c=>{if(c&&typeof c=="object"){const l=Hn(c,t);i.has(l)||(s.push({id:l,color:c.color||n,...c}),i.add(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const Kn={nodeOrigin:[0,0],nodeExtent:ut,elevateNodesOnSelect:!0,defaults:{}},Vd={...Kn,checkEquality:!0};function Qn(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function Fd(e,t,n){const o=Qn(Kn,n);for(const r of e.values())if(r.parentId)Un(r,e,t,o);else{const i=xt(r,o.nodeOrigin),s=qe(r.extent)?r.extent:o.nodeExtent,a=He(i,s,Ee(r));r.internals.positionAbsolute=a}}function zn(e,t,n,o){const r=Qn(Vd,o);let i=e.length>0;const s=new Map(t),a=r?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const c of e){let l=s.get(c.id);if(r.checkEquality&&c===l?.internals.userNode)t.set(c.id,l);else{const u=xt(c,r.nodeOrigin),h=qe(c.extent)?c.extent:r.nodeExtent,d=He(u,h,Ee(c));l={...r.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:d,handleBounds:c.measured?l?.internals.handleBounds:void 0,z:mi(c,a),userNode:c}},t.set(c.id,l)}(l.measured===void 0||l.measured.width===void 0||l.measured.height===void 0)&&!l.hidden&&(i=!1),c.parentId&&Un(l,t,n,o)}return i}function Yd(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Un(e,t,n,o){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:s}=Qn(Kn,o),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Yd(e,n);const l=r?1e3:0,{x:u,y:h,z:d}=Xd(e,c,i,s,l),{positionAbsolute:f}=e.internals,y=u!==f.x||h!==f.y;(y||d!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:u,y:h}:f,z:d}})}function mi(e,t){return(he(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Xd(e,t,n,o,r){const{x:i,y:s}=t.internals.positionAbsolute,a=Ee(e),c=xt(e,n),l=qe(e.extent)?He(c,e.extent,a):c;let u=He({x:i+l.x,y:s+l.y},o,a);e.extent==="parent"&&(u=oi(u,a,t));const h=mi(e,r),d=t.internals.z??0;return{x:u.x,y:u.y,z:d>=h?d+1:h}}function Jn(e,t,n,o=[0,0]){const r=[],i=new Map;for(const s of e){const a=t.get(s.parentId);if(!a)continue;const c=i.get(s.parentId)?.expandedRect??Ze(a),l=ii(c,s.rect);i.set(s.parentId,{expandedRect:l,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},c)=>{const l=a.internals.positionAbsolute,u=Ee(a),h=a.origin??o,d=s.x<l.x?Math.round(Math.abs(l.x-s.x)):0,f=s.y<l.y?Math.round(Math.abs(l.y-s.y)):0,y=Math.max(u.width,Math.round(s.width)),m=Math.max(u.height,Math.round(s.height)),b=(y-u.width)*h[0],v=(m-u.height)*h[1];(d>0||f>0||b||v)&&(r.push({id:c,type:"position",position:{x:a.position.x-d+b,y:a.position.y-f+v}}),n.get(c)?.forEach(M=>{e.some(g=>g.id===M.id)||r.push({id:M.id,type:"position",position:{x:M.position.x+d,y:M.position.y+f}})})),(u.width<s.width||u.height<s.height||d||f)&&r.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:y+(d?h[0]*d-b:0),height:m+(f?h[1]*f-v:0)}})}),r}function Wd(e,t,n,o,r,i){const s=o?.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(l.transform),h=[];for(const d of e.values()){const f=t.get(d.id);if(!f)continue;if(f.hidden){t.set(f.id,{...f,internals:{...f.internals,handleBounds:void 0}}),a=!0;continue}const y=Gn(d.nodeElement),m=f.measured.width!==y.width||f.measured.height!==y.height;if(!!(y.width&&y.height&&(m||!f.internals.handleBounds||d.force))){const v=d.nodeElement.getBoundingClientRect(),M=qe(f.extent)?f.extent:i;let{positionAbsolute:g}=f.internals;f.parentId&&f.extent==="parent"?g=oi(g,y,t.get(f.parentId)):M&&(g=He(g,M,y));const w={...f,measured:y,internals:{...f.internals,positionAbsolute:g,handleBounds:{source:Ho("source",d.nodeElement,v,u,f.id),target:Ho("target",d.nodeElement,v,u,f.id)}}};t.set(f.id,w),f.parentId&&Un(w,t,n,{nodeOrigin:r}),a=!0,m&&(c.push({id:f.id,type:"dimensions",dimensions:y}),f.expandParent&&f.parentId&&h.push({id:f.id,parentId:f.parentId,rect:Ze(w,r)}))}}if(h.length>0){const d=Jn(h,t,n,r);c.push(...d)}return{changes:c,updatedInternals:a}}async function Zd({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Vo(e,t,n,o,r,i){let s=r;const a=o.get(s)||new Map;o.set(s,a.set(n,t)),s=`${r}-${e}`;const c=o.get(s)||new Map;if(o.set(s,c.set(n,t)),i){s=`${r}-${e}-${i}`;const l=o.get(s)||new Map;o.set(s,l.set(n,t))}}function yi(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,c={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},l=`${r}-${s}--${i}-${a}`,u=`${i}-${a}--${r}-${s}`;Vo("source",c,u,e,r,s),Vo("target",c,l,e,i,a),t.set(o.id,o)}}function xi(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:xi(n,t):!1}function Fo(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function qd(e,t,n,o){const r=new Map;for(const[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!xi(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function vn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[s,a]of t){const c=n.get(s)?.internals.userNode;c&&r.push({...c,position:a.position,dragging:o})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function Gd({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:o-r.distance.y},s=vt(i,t);return{x:s.x-i.x,y:s.y-i.y}}function Kd({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,c=!1,l={x:0,y:0},u=null,h=!1,d=null,f=!1,y=!1,m=null;function b({noDragClassName:M,handleSelector:g,domNode:w,isSelectable:C,nodeId:N,nodeClickDistance:$=0}){d=ae(w);function P({x:k,y:A}){const{nodeLookup:p,nodeExtent:_,snapGrid:S,snapToGrid:E,nodeOrigin:H,onNodeDrag:D,onSelectionDrag:z,onError:L,updateNodePositions:B}=t();i={x:k,y:A};let X=!1;const V=a.size>1,Z=V&&_?Pn(wt(a)):null,K=V&&E?Gd({dragItems:a,snapGrid:S,x:k,y:A}):null;for(const[F,O]of a){if(!p.has(F))continue;let W={x:k-O.distance.x,y:A-O.distance.y};E&&(W=K?{x:Math.round(W.x+K.x),y:Math.round(W.y+K.y)}:vt(W,S));let J=null;if(V&&_&&!O.extent&&Z){const{positionAbsolute:Q}=O.internals,G=Q.x-Z.x+_[0][0],te=Q.x+O.measured.width-Z.x2+_[1][0],ie=Q.y-Z.y+_[0][1],le=Q.y+O.measured.height-Z.y2+_[1][1];J=[[G,ie],[te,le]]}const{position:ee,positionAbsolute:q}=ni({nodeId:F,nextPosition:W,nodeLookup:p,nodeExtent:J||_,nodeOrigin:H,onError:L});X=X||O.position.x!==ee.x||O.position.y!==ee.y,O.position=ee,O.internals.positionAbsolute=q}if(y=y||X,!!X&&(B(a,!0),m&&(o||D||!N&&z))){const[F,O]=vn({nodeId:N,dragItems:a,nodeLookup:p});o?.(m,a,F,O),D?.(m,F,O),N||z?.(m,O)}}async function T(){if(!u)return;const{transform:k,panBy:A,autoPanSpeed:p,autoPanOnNodeDrag:_}=t();if(!_){c=!1,cancelAnimationFrame(s);return}const[S,E]=ri(l,u,p);(S!==0||E!==0)&&(i.x=(i.x??0)-S/k[2],i.y=(i.y??0)-E/k[2],await A({x:S,y:E})&&P(i)),s=requestAnimationFrame(T)}function j(k){const{nodeLookup:A,multiSelectionActive:p,nodesDraggable:_,transform:S,snapGrid:E,snapToGrid:H,selectNodesOnDrag:D,onNodeDragStart:z,onSelectionDragStart:L,unselectNodesAndEdges:B}=t();h=!0,(!D||!C)&&!p&&N&&(A.get(N)?.selected||B()),C&&D&&N&&e?.(N);const X=it(k.sourceEvent,{transform:S,snapGrid:E,snapToGrid:H,containerBounds:u});if(i=X,a=qd(A,_,X,N),a.size>0&&(n||z||!N&&L)){const[V,Z]=vn({nodeId:N,dragItems:a,nodeLookup:A});n?.(k.sourceEvent,a,V,Z),z?.(k.sourceEvent,V,Z),N||L?.(k.sourceEvent,Z)}}const R=Hr().clickDistance($).on("start",k=>{const{domNode:A,nodeDragThreshold:p,transform:_,snapGrid:S,snapToGrid:E}=t();u=A?.getBoundingClientRect()||null,f=!1,y=!1,m=k.sourceEvent,p===0&&j(k),i=it(k.sourceEvent,{transform:_,snapGrid:S,snapToGrid:E,containerBounds:u}),l=me(k.sourceEvent,u)}).on("drag",k=>{const{autoPanOnNodeDrag:A,transform:p,snapGrid:_,snapToGrid:S,nodeDragThreshold:E,nodeLookup:H}=t(),D=it(k.sourceEvent,{transform:p,snapGrid:_,snapToGrid:S,containerBounds:u});if(m=k.sourceEvent,(k.sourceEvent.type==="touchmove"&&k.sourceEvent.touches.length>1||N&&!H.has(N))&&(f=!0),!f){if(!c&&A&&h&&(c=!0,T()),!h){const z=D.xSnapped-(i.x??0),L=D.ySnapped-(i.y??0);Math.sqrt(z*z+L*L)>E&&j(k)}(i.x!==D.xSnapped||i.y!==D.ySnapped)&&a&&h&&(l=me(k.sourceEvent,u),P(D))}}).on("end",k=>{if(!(!h||f)&&(c=!1,h=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:A,updateNodePositions:p,onNodeDragStop:_,onSelectionDragStop:S}=t();if(y&&(p(a,!1),y=!1),r||_||!N&&S){const[E,H]=vn({nodeId:N,dragItems:a,nodeLookup:A,dragging:!1});r?.(k.sourceEvent,a,E,H),_?.(k.sourceEvent,E,H),N||S?.(k.sourceEvent,H)}}}).filter(k=>{const A=k.target;return!k.button&&(!M||!Fo(A,`.${M}`,w))&&(!g||Fo(A,g,w))});d.call(R)}function v(){d?.on(".drag",null)}return{update:b,destroy:v}}function Qd(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())ft(r,Ze(i))>0&&o.push(i);return o}const Ud=250;function Jd(e,t,n,o){let r=[],i=1/0;const s=Qd(e,n,t+Ud);for(const a of s){const c=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const l of c){if(o.nodeId===l.nodeId&&o.type===l.type&&o.id===l.id)continue;const{x:u,y:h}=gt(a,l,l.position,!0),d=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(h-e.y,2));d>t||(d<i?(r=[{...l,x:u,y:h}],i=d):d===i&&r.push({...l,x:u,y:h}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(c=>c.type===a)??r[0]}return r[0]}function wi(e,t,n,o,r,i=!1){const s=o.get(e);if(!s)return null;const a=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],c=(n?a?.find(l=>l.id===n):a?.[0])??null;return c&&i?{...c,...gt(s,c,c.position,!0)}:c}function vi(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function ef(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const bi=()=>!0;function tf(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:h,panBy:d,cancelConnection:f,onConnectStart:y,onConnect:m,onConnectEnd:b,isValidConnection:v=bi,onReconnectEnd:M,updateConnection:g,getTransform:w,getFromHandle:C,autoPanSpeed:N,dragThreshold:$=1,handleDomNode:P}){const T=ci(e.target);let j=0,R;const{x:k,y:A}=me(e),p=vi(i,P),_=a?.getBoundingClientRect();let S=!1;if(!_||!p)return;const E=wi(r,p,o,c,t);if(!E)return;let H=me(e,_),D=!1,z=null,L=!1,B=null;function X(){if(!u||!_)return;const[ee,q]=ri(H,_,N);d({x:ee,y:q}),j=requestAnimationFrame(X)}const V={...E,nodeId:r,type:p,position:E.position},Z=c.get(r);let F={inProgress:!0,isValid:null,from:gt(Z,V,Y.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:Z,to:H,toHandle:null,toPosition:Ao[V.position],toNode:null};function O(){S=!0,g(F),y?.(e,{nodeId:r,handleId:o,handleType:p})}$===0&&O();function W(ee){if(!S){const{x:te,y:ie}=me(ee),le=te-k,ze=ie-A;if(!(le*le+ze*ze>$*$))return;O()}if(!C()||!V){J(ee);return}const q=w();H=me(ee,_),R=Jd(bt(H,q,!1,[1,1]),n,c,V),D||(X(),D=!0);const Q=_i(ee,{handle:R,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:v,doc:T,lib:l,flowId:h,nodeLookup:c});B=Q.handleDomNode,z=Q.connection,L=ef(!!R,Q.isValid);const G={...F,isValid:L,to:Q.toHandle&&L?Ut({x:Q.toHandle.x,y:Q.toHandle.y},q):H,toHandle:Q.toHandle,toPosition:L&&Q.toHandle?Q.toHandle.position:Ao[V.position],toNode:Q.toHandle?c.get(Q.toHandle.nodeId):null};L&&R&&F.toHandle&&G.toHandle&&F.toHandle.type===G.toHandle.type&&F.toHandle.nodeId===G.toHandle.nodeId&&F.toHandle.id===G.toHandle.id&&F.to.x===G.to.x&&F.to.y===G.to.y||(g(G),F=G)}function J(ee){if(S){(R||B)&&z&&L&&m?.(z);const{inProgress:q,...Q}=F,G={...Q,toPosition:F.toHandle?F.toPosition:null};b?.(ee,G),i&&M?.(ee,G)}f(),cancelAnimationFrame(j),D=!1,L=!1,z=null,B=null,T.removeEventListener("mousemove",W),T.removeEventListener("mouseup",J),T.removeEventListener("touchmove",W),T.removeEventListener("touchend",J)}T.addEventListener("mousemove",W),T.addEventListener("mouseup",J),T.addEventListener("touchmove",W),T.addEventListener("touchend",J)}function _i(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:c,isValidConnection:l=bi,nodeLookup:u}){const h=i==="target",d=t?s.querySelector(`.${a}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:f,y}=me(e),m=s.elementFromPoint(f,y),b=m?.classList.contains(`${a}-flow__handle`)?m:d,v={handleDomNode:b,isValid:!1,connection:null,toHandle:null};if(b){const M=vi(void 0,b),g=b.getAttribute("data-nodeid"),w=b.getAttribute("data-handleid"),C=b.classList.contains("connectable"),N=b.classList.contains("connectableend");if(!g||!M)return v;const $={source:h?g:o,sourceHandle:h?w:r,target:h?o:g,targetHandle:h?r:w};v.connection=$;const T=C&&N&&(n===Xe.Strict?h&&M==="source"||!h&&M==="target":g!==o||w!==r);v.isValid=T&&l($),v.toHandle=wi(g,M,w,u,n,!0)}return v}const Ln={onPointerDown:tf,isValid:_i};function nf({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=ae(e);function i({translateExtent:a,width:c,height:l,zoomStep:u=1,pannable:h=!0,zoomable:d=!0,inversePan:f=!1}){const y=g=>{if(g.sourceEvent.type!=="wheel"||!t)return;const w=n(),C=g.sourceEvent.ctrlKey&&ht()?10:1,N=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*u,$=w[2]*Math.pow(2,N*C);t.scaleTo($)};let m=[0,0];const b=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(m=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},v=g=>{const w=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const C=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],N=[C[0]-m[0],C[1]-m[1]];m=C;const $=o()*Math.max(w[2],Math.log(w[2]))*(f?-1:1),P={x:w[0]-N[0]*$,y:w[1]-N[1]*$},T=[[0,0],[c,l]];t.setViewportConstrained({x:P.x,y:P.y,zoom:w[2]},T,a)},M=Kr().on("start",b).on("zoom",h?v:null).on("zoom.wheel",d?y:null);r.call(M,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:de}}const of=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,cn=e=>({x:e.x,y:e.y,zoom:e.k}),bn=({x:e,y:t,zoom:n})=>rn.translate(e,t).scale(n),je=(e,t)=>e.target.closest(`.${t}`),Si=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),rf=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,_n=(e,t=0,n=rf,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},Ei=e=>{const t=e.ctrlKey&&ht()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function sf({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(je(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(u.ctrlKey&&s){const b=de(u),v=Ei(u),M=h*Math.pow(2,v);o.scaleTo(n,M,b,u);return}const d=u.deltaMode===1?20:1;let f=r===De.Vertical?0:u.deltaX*d,y=r===De.Horizontal?0:u.deltaY*d;!ht()&&u.shiftKey&&r!==De.Vertical&&(f=u.deltaY*d,y=0),o.translateBy(n,-(f/h)*i,-(y/h)*i,{internal:!0});const m=cn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a?.(u,m)),e.isPanScrolling&&(c?.(u,m),e.panScrollTimeout=setTimeout(()=>{l?.(u,m),e.isPanScrolling=!1},150))}}function af({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const i=o.type==="wheel",s=!t&&i&&!o.ctrlKey,a=je(o,e);if(o.ctrlKey&&i&&a&&o.preventDefault(),s||a)return null;o.preventDefault(),n.call(this,o,r)}}function cf({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=cn(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function lf({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&Si(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,cn(i.transform))}}function uf({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&Si(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&of(e.prevViewport,s.transform))){const a=cn(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function df({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{const h=e||t,d=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(je(u,`${l}-flow__node`)||je(u,`${l}-flow__edge`)))return!0;if(!o&&!h&&!r&&!i&&!n||s||je(u,a)&&u.type==="wheel"||je(u,c)&&(u.type!=="wheel"||r&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&u.touches?.length>1)return u.preventDefault(),!1;if(!h&&!r&&!d&&u.type==="wheel"||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;const f=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&f}}function ff({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),d=Kr().clickDistance(!he(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),f=ae(e).call(d);g({x:i.x,y:i.y,zoom:We(i.zoom,t,n)},[[0,0],[h.width,h.height]],r);const y=f.on("wheel.zoom"),m=f.on("dblclick.zoom");d.wheelDelta(Ei);function b(k,A){return f?new Promise(p=>{d?.interpolate(A?.interpolate==="linear"?rt:jt).transform(_n(f,A?.duration,A?.ease,()=>p(!0)),k)}):Promise.resolve(!1)}function v({noWheelClassName:k,noPanClassName:A,onPaneContextMenu:p,userSelectionActive:_,panOnScroll:S,panOnDrag:E,panOnScrollMode:H,panOnScrollSpeed:D,preventScrolling:z,zoomOnPinch:L,zoomOnScroll:B,zoomOnDoubleClick:X,zoomActivationKeyPressed:V,lib:Z,onTransformChange:K}){_&&!u.isZoomingOrPanning&&M();const O=S&&!V&&!_?sf({zoomPanValues:u,noWheelClassName:k,d3Selection:f,d3Zoom:d,panOnScrollMode:H,panOnScrollSpeed:D,zoomOnPinch:L,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:c}):af({noWheelClassName:k,preventScrolling:z,d3ZoomHandler:y});if(f.on("wheel.zoom",O,{passive:!1}),!_){const J=cf({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});d.on("start",J);const ee=lf({zoomPanValues:u,panOnDrag:E,onPaneContextMenu:!!p,onPanZoom:s,onTransformChange:K});d.on("zoom",ee);const q=uf({zoomPanValues:u,panOnDrag:E,panOnScroll:S,onPaneContextMenu:p,onPanZoomEnd:c,onDraggingChange:l});d.on("end",q)}const W=df({zoomActivationKeyPressed:V,panOnDrag:E,zoomOnScroll:B,panOnScroll:S,zoomOnDoubleClick:X,zoomOnPinch:L,userSelectionActive:_,noPanClassName:A,noWheelClassName:k,lib:Z});d.filter(W),X?f.on("dblclick.zoom",m):f.on("dblclick.zoom",null)}function M(){d.on("zoom",null)}async function g(k,A,p){const _=bn(k),S=d?.constrain()(_,A,p);return S&&await b(S),new Promise(E=>E(S))}async function w(k,A){const p=bn(k);return await b(p,A),new Promise(_=>_(p))}function C(k){if(f){const A=bn(k),p=f.property("__zoom");(p.k!==k.zoom||p.x!==k.x||p.y!==k.y)&&d?.transform(f,A,null,{sync:!0})}}function N(){const k=f?Gr(f.node()):{x:0,y:0,k:1};return{x:k.x,y:k.y,zoom:k.k}}function $(k,A){return f?new Promise(p=>{d?.interpolate(A?.interpolate==="linear"?rt:jt).scaleTo(_n(f,A?.duration,A?.ease,()=>p(!0)),k)}):Promise.resolve(!1)}function P(k,A){return f?new Promise(p=>{d?.interpolate(A?.interpolate==="linear"?rt:jt).scaleBy(_n(f,A?.duration,A?.ease,()=>p(!0)),k)}):Promise.resolve(!1)}function T(k){d?.scaleExtent(k)}function j(k){d?.translateExtent(k)}function R(k){const A=!he(k)||k<0?0:k;d?.clickDistance(A)}return{update:v,destroy:M,setViewport:w,setViewportConstrained:g,getViewport:N,scaleTo:$,scaleBy:P,setScaleExtent:T,setTranslateExtent:j,syncViewport:C,setClickDistance:R}}var Ge;(function(e){e.Line="line",e.Handle="handle"})(Ge||(Ge={}));function hf({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){const s=e-t,a=n-o,c=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(c[0]=c[0]*-1),a&&i&&(c[1]=c[1]*-1),c}function gf(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ne(e,t){return Math.max(0,t-e)}function Ce(e,t){return Math.max(0,e-t)}function Tt(e,t,n){return Math.max(0,t-e,e-n)}function Yo(e,t){return e?!t:t}function pf(e,t,n,o,r,i,s,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:h}=t,d=u&&h,{xSnapped:f,ySnapped:y}=n,{minWidth:m,maxWidth:b,minHeight:v,maxHeight:M}=o,{x:g,y:w,width:C,height:N,aspectRatio:$}=e;let P=Math.floor(u?f-e.pointerX:0),T=Math.floor(h?y-e.pointerY:0);const j=C+(c?-P:P),R=N+(l?-T:T),k=-i[0]*C,A=-i[1]*N;let p=Tt(j,m,b),_=Tt(R,v,M);if(s){let H=0,D=0;c&&P<0?H=Ne(g+P+k,s[0][0]):!c&&P>0&&(H=Ce(g+j+k,s[1][0])),l&&T<0?D=Ne(w+T+A,s[0][1]):!l&&T>0&&(D=Ce(w+R+A,s[1][1])),p=Math.max(p,H),_=Math.max(_,D)}if(a){let H=0,D=0;c&&P>0?H=Ce(g+P,a[0][0]):!c&&P<0&&(H=Ne(g+j,a[1][0])),l&&T>0?D=Ce(w+T,a[0][1]):!l&&T<0&&(D=Ne(w+R,a[1][1])),p=Math.max(p,H),_=Math.max(_,D)}if(r){if(u){const H=Tt(j/$,v,M)*$;if(p=Math.max(p,H),s){let D=0;!c&&!l||c&&!l&&d?D=Ce(w+A+j/$,s[1][1])*$:D=Ne(w+A+(c?P:-P)/$,s[0][1])*$,p=Math.max(p,D)}if(a){let D=0;!c&&!l||c&&!l&&d?D=Ne(w+j/$,a[1][1])*$:D=Ce(w+(c?P:-P)/$,a[0][1])*$,p=Math.max(p,D)}}if(h){const H=Tt(R*$,m,b)/$;if(_=Math.max(_,H),s){let D=0;!c&&!l||l&&!c&&d?D=Ce(g+R*$+k,s[1][0])/$:D=Ne(g+(l?T:-T)*$+k,s[0][0])/$,_=Math.max(_,D)}if(a){let D=0;!c&&!l||l&&!c&&d?D=Ne(g+R*$,a[1][0])/$:D=Ce(g+(l?T:-T)*$,a[0][0])/$,_=Math.max(_,D)}}}T=T+(T<0?_:-_),P=P+(P<0?p:-p),r&&(d?j>R*$?T=(Yo(c,l)?-P:P)/$:P=(Yo(c,l)?-T:T)*$:u?(T=P/$,l=c):(P=T*$,c=l));const S=c?g+P:g,E=l?w+T:w;return{width:C+(c?-P:P),height:N+(l?-T:T),x:i[0]*P*(c?-1:1)+S,y:i[1]*T*(l?-1:1)+E}}const Ni={width:0,height:0,x:0,y:0},mf={...Ni,pointerX:0,pointerY:0,aspectRatio:1};function yf(e){return[[0,0],[e.measured.width,e.measured.height]]}function xf(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,c=n[1]*s;return[[o-a,r-c],[o+i-a,r+s-c]]}function wf({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const i=ae(e);function s({controlPosition:c,boundaries:l,keepAspectRatio:u,resizeDirection:h,onResizeStart:d,onResize:f,onResizeEnd:y,shouldResize:m}){let b={...Ni},v={...mf};const M=gf(c);let g,w=null,C=[],N,$,P;const T=Hr().on("start",j=>{const{nodeLookup:R,transform:k,snapGrid:A,snapToGrid:p,nodeOrigin:_,paneDomNode:S}=n();if(g=R.get(t),!g)return;w=S?.getBoundingClientRect()??null;const{xSnapped:E,ySnapped:H}=it(j.sourceEvent,{transform:k,snapGrid:A,snapToGrid:p,containerBounds:w});b={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},v={...b,pointerX:E,pointerY:H,aspectRatio:b.width/b.height},N=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(N=R.get(g.parentId),$=N&&g.extent==="parent"?yf(N):void 0),C=[],P=void 0;for(const[D,z]of R)if(z.parentId===t&&(C.push({id:D,position:{...z.position},extent:z.extent}),z.extent==="parent"||z.expandParent)){const L=xf(z,g,z.origin??_);P?P=[[Math.min(L[0][0],P[0][0]),Math.min(L[0][1],P[0][1])],[Math.max(L[1][0],P[1][0]),Math.max(L[1][1],P[1][1])]]:P=L}d?.(j,{...b})}).on("drag",j=>{const{transform:R,snapGrid:k,snapToGrid:A,nodeOrigin:p}=n(),_=it(j.sourceEvent,{transform:R,snapGrid:k,snapToGrid:A,containerBounds:w}),S=[];if(!g)return;const{x:E,y:H,width:D,height:z}=b,L={},B=g.origin??p,{width:X,height:V,x:Z,y:K}=pf(v,M,_,l,u,B,$,P),F=X!==D,O=V!==z,W=Z!==E&&F,J=K!==H&&O;if(!W&&!J&&!F&&!O)return;if((W||J||B[0]===1||B[1]===1)&&(L.x=W?Z:b.x,L.y=J?K:b.y,b.x=L.x,b.y=L.y,C.length>0)){const G=Z-E,te=K-H;for(const ie of C)ie.position={x:ie.position.x-G+B[0]*(X-D),y:ie.position.y-te+B[1]*(V-z)},S.push(ie)}if((F||O)&&(L.width=F&&(!h||h==="horizontal")?X:b.width,L.height=O&&(!h||h==="vertical")?V:b.height,b.width=L.width,b.height=L.height),N&&g.expandParent){const G=B[0]*(L.width??0);L.x&&L.x<G&&(b.x=G,v.x=v.x-(L.x-G));const te=B[1]*(L.height??0);L.y&&L.y<te&&(b.y=te,v.y=v.y-(L.y-te))}const ee=hf({width:b.width,prevWidth:D,height:b.height,prevHeight:z,affectsX:M.affectsX,affectsY:M.affectsY}),q={...b,direction:ee};m?.(j,q)!==!1&&(f?.(j,q),o(L,S))}).on("end",j=>{y?.(j,{...b}),r?.({...b})});i.call(T)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}const vf={},Xo=e=>{let t;const n=new Set,o=(u,h)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const f=t;t=h??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(y=>y(t,f))}},r=()=>t,c={setState:o,getState:r,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(vf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(o,r,c);return c},bf=e=>e?Xo(e):Xo,{useDebugValue:_f}=da,{useSyncExternalStoreWithSelector:Sf}=ua,Ef=e=>e;function Ci(e,t=Ef,n){const o=Sf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return _f(o),o}const Wo=(e,t)=>{const n=bf(e),o=(r,i=t)=>Ci(n,r,i);return Object.assign(o,n),o},Nf=(e,t)=>e?Wo(e,t):Wo;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ln=I.createContext(null),Cf=ln.Provider,ki=xe.error001();function U(e,t){const n=I.useContext(ln);if(n===null)throw new Error(ki);return Ci(n,e,t)}function ne(){const e=I.useContext(ln);if(e===null)throw new Error(ki);return I.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Zo={display:"none"},kf={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Mi="react-flow__node-desc",$i="react-flow__edge-desc",Mf="react-flow__aria-live",$f=e=>e.ariaLiveMessage,If=e=>e.ariaLabelConfig;function Af({rfId:e}){const t=U($f);return x.jsx("div",{id:`${Mf}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:kf,children:t})}function Df({rfId:e,disableKeyboardA11y:t}){const n=U(If);return x.jsxs(x.Fragment,{children:[x.jsx("div",{id:`${Mi}-${e}`,style:Zo,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),x.jsx("div",{id:`${$i}-${e}`,style:Zo,children:n["edge.a11yDescription.default"]}),!t&&x.jsx(Af,{rfId:e})]})}const _t=I.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{const s=`${e}`.split("-");return x.jsx("div",{className:re(["react-flow__panel",n,...s]),style:o,ref:i,...r,children:t})});_t.displayName="Panel";function Pf({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:x.jsx(_t,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:x.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Tf=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Ht=e=>e.id;function Hf(e,t){return oe(e.selectedNodes.map(Ht),t.selectedNodes.map(Ht))&&oe(e.selectedEdges.map(Ht),t.selectedEdges.map(Ht))}function zf({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:o}=U(Tf,Hf);return I.useEffect(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,e]),null}const Lf=e=>!!e.onSelectionChangeHandlers;function Rf({onSelectionChange:e}){const t=U(Lf);return e||t?x.jsx(zf,{onSelectionChange:e}):null}const Ii=[0,0],jf={x:0,y:0,zoom:1},Of=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],qo=[...Of,"rfId"],Bf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Go={translateExtent:ut,nodeOrigin:Ii,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Vf(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=U(Bf,oe),u=ne();I.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{h.current=Go,a()}),[]);const h=I.useRef(Go);return I.useEffect(()=>{for(const d of qo){const f=e[d],y=h.current[d];f!==y&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?n(f):d==="minZoom"?o(f):d==="maxZoom"?r(f):d==="translateExtent"?i(f):d==="nodeExtent"?s(f):d==="paneClickDistance"?l(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:Ad(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}h.current=e},qo.map(d=>e[d])),null}function Ko(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Ff(e){const[t,n]=I.useState(e==="system"?null:e);return I.useEffect(()=>{if(e!=="system"){n(e);return}const o=Ko(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:Ko()?.matches?"dark":"light"}const Qo=typeof document<"u"?document:null;function pt(e=null,t={target:Qo,actInsideInputWithModifier:!0}){const[n,o]=I.useState(!1),r=I.useRef(!1),i=I.useRef(new Set([])),[s,a]=I.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((h,d)=>h.concat(...d),[]);return[l,u]}return[[],[]]},[e]);return I.useEffect(()=>{const c=t?.target??Qo,l=t?.actInsideInputWithModifier??!0;if(e!==null){const u=f=>{if(r.current=f.ctrlKey||f.metaKey||f.shiftKey||f.altKey,(!r.current||r.current&&!l)&&li(f))return!1;const m=Jo(f.code,a);if(i.current.add(f[m]),Uo(s,i.current,!1)){const b=f.composedPath?.()?.[0]||f.target,v=b?.nodeName==="BUTTON"||b?.nodeName==="A";t.preventDefault!==!1&&(r.current||!v)&&f.preventDefault(),o(!0)}},h=f=>{const y=Jo(f.code,a);Uo(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[y]),f.key==="Meta"&&i.current.clear(),r.current=!1},d=()=>{i.current.clear(),o(!1)};return c?.addEventListener("keydown",u),c?.addEventListener("keyup",h),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c?.removeEventListener("keydown",u),c?.removeEventListener("keyup",h),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,o]),n}function Uo(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function Jo(e,t){return t.includes(e)?"code":"key"}const Yf=()=>{const e=ne();return I.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),c=qn(t,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(c,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:c}=s.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??r,h=n.snapToGrid??i;return bt(l,o,h,u)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:i}=o.getBoundingClientRect(),s=Ut(t,n);return{x:s.x+r,y:s.y+i}}}),[])};function Ai(e,t){const n=[],o=new Map,r=[];for(const i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{const s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(const i of t){const s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const c of s)Xf(c,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function Xf(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Di(e,t){return Ai(e,t)}function Pi(e,t){return Ai(e,t)}function $e(e,t){return{id:e,type:"select",selected:t}}function Oe(e,t=new Set,n=!1){const o=[];for(const[r,i]of e){const s=t.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push($e(i.id,s)))}return o}function er({items:e=[],lookup:t}){const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function tr(e){return{id:e.id,type:"remove"}}const nr=e=>bd(e),Wf=e=>ti(e);function Ti(e){return I.forwardRef(e)}const Zf=typeof window<"u"?I.useLayoutEffect:I.useEffect;function or(e){const[t,n]=I.useState(BigInt(0)),[o]=I.useState(()=>qf(()=>n(r=>r+BigInt(1))));return Zf(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function qf(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Hi=I.createContext(null);function Gf({children:e}){const t=ne(),n=I.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:h,nodeLookup:d,fitViewQueued:f}=t.getState();let y=c;for(const b of a)y=typeof b=="function"?b(y):b;const m=er({items:y,lookup:d});u&&l(y),m.length>0?h?.(m):f&&window.requestAnimationFrame(()=>{const{fitViewQueued:b,nodes:v,setNodes:M}=t.getState();b&&M(v)})},[]),o=or(n),r=I.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:h,edgeLookup:d}=t.getState();let f=c;for(const y of a)f=typeof y=="function"?y(f):y;u?l(f):h&&h(er({items:f,lookup:d}))},[]),i=or(r),s=I.useMemo(()=>({nodeQueue:o,edgeQueue:i}),[]);return x.jsx(Hi.Provider,{value:s,children:e})}function Kf(){const e=I.useContext(Hi);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Qf=e=>!!e.panZoom;function un(){const e=Yf(),t=ne(),n=Kf(),o=U(Qf),r=I.useMemo(()=>{const i=h=>t.getState().nodeLookup.get(h),s=h=>{n.nodeQueue.push(h)},a=h=>{n.edgeQueue.push(h)},c=h=>{const{nodeLookup:d,nodeOrigin:f}=t.getState(),y=nr(h)?h:d.get(h.id),m=y.parentId?ai(y.position,y.measured,y.parentId,d,f):y.position,b={...y,position:m,width:y.measured?.width??y.width,height:y.measured?.height??y.height};return Ze(b)},l=(h,d,f={replace:!1})=>{s(y=>y.map(m=>{if(m.id===h){const b=typeof d=="function"?d(m):d;return f.replace&&nr(b)?b:{...m,...b}}return m}))},u=(h,d,f={replace:!1})=>{a(y=>y.map(m=>{if(m.id===h){const b=typeof d=="function"?d(m):d;return f.replace&&Wf(b)?b:{...m,...b}}return m}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>i(h)?.internals.userNode,getInternalNode:i,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(d=>({...d}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:s,setEdges:a,addNodes:h=>{const d=Array.isArray(h)?h:[h];n.nodeQueue.push(f=>[...f,...d])},addEdges:h=>{const d=Array.isArray(h)?h:[h];n.edgeQueue.push(f=>[...f,...d])},toObject:()=>{const{nodes:h=[],edges:d=[],transform:f}=t.getState(),[y,m,b]=f;return{nodes:h.map(v=>({...v})),edges:d.map(v=>({...v})),viewport:{x:y,y:m,zoom:b}}},deleteElements:async({nodes:h=[],edges:d=[]})=>{const{nodes:f,edges:y,onNodesDelete:m,onEdgesDelete:b,triggerNodeChanges:v,triggerEdgeChanges:M,onDelete:g,onBeforeDelete:w}=t.getState(),{nodes:C,edges:N}=await Cd({nodesToRemove:h,edgesToRemove:d,nodes:f,edges:y,onBeforeDelete:w}),$=N.length>0,P=C.length>0;if($){const T=N.map(tr);b?.(N),M(T)}if(P){const T=C.map(tr);m?.(C),v(T)}return(P||$)&&g?.({nodes:C,edges:N}),{deletedNodes:C,deletedEdges:N}},getIntersectingNodes:(h,d=!0,f)=>{const y=Po(h),m=y?h:c(h),b=f!==void 0;return m?(f||t.getState().nodes).filter(v=>{const M=t.getState().nodeLookup.get(v.id);if(M&&!y&&(v.id===h.id||!M.internals.positionAbsolute))return!1;const g=Ze(b?v:M),w=ft(g,m);return d&&w>0||w>=g.width*g.height||w>=m.width*m.height}):[]},isNodeIntersecting:(h,d,f=!0)=>{const m=Po(h)?h:c(h);if(!m)return!1;const b=ft(m,d);return f&&b>0||b>=m.width*m.height},updateNode:l,updateNodeData:(h,d,f={replace:!1})=>{l(h,y=>{const m=typeof d=="function"?d(y):d;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},updateEdge:u,updateEdgeData:(h,d,f={replace:!1})=>{u(h,y=>{const m=typeof d=="function"?d(y):d;return f.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},f)},getNodesBounds:h=>{const{nodeLookup:d,nodeOrigin:f}=t.getState();return _d(h,{nodeLookup:d,nodeOrigin:f})},getHandleConnections:({type:h,id:d,nodeId:f})=>Array.from(t.getState().connectionLookup.get(`${f}-${h}${d?`-${d}`:""}`)?.values()??[]),getNodeConnections:({type:h,handleId:d,nodeId:f})=>Array.from(t.getState().connectionLookup.get(`${f}${h?d?`-${h}-${d}`:`-${h}`:""}`)?.values()??[]),fitView:async h=>{const d=t.getState().fitViewResolver??Id();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:d}),n.nodeQueue.push(f=>[...f]),d.promise}}},[]);return I.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const rr=e=>e.selected,Uf=typeof window<"u"?window:void 0;function Jf({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:o}=un(),r=pt(e,{actInsideInputWithModifier:!1}),i=pt(t,{target:Uf});I.useEffect(()=>{if(r){const{edges:s,nodes:a}=n.getState();o({nodes:a.filter(rr),edges:s.filter(rr)}),n.setState({nodesSelectionActive:!1})}},[r]),I.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function eh(e){const t=ne();I.useEffect(()=>{const n=()=>{if(!e.current)return!1;const o=Gn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",xe.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const dn={position:"absolute",width:"100%",height:"100%",top:0,left:0},th=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function nh({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=De.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:h,zoomActivationKeyCode:d,preventScrolling:f=!0,children:y,noWheelClassName:m,noPanClassName:b,onViewportChange:v,isControlledViewport:M,paneClickDistance:g}){const w=ne(),C=I.useRef(null),{userSelectionActive:N,lib:$}=U(th,oe),P=pt(d),T=I.useRef();eh(C);const j=I.useCallback(R=>{v?.({x:R[0],y:R[1],zoom:R[2]}),M||w.setState({transform:R})},[v,M]);return I.useEffect(()=>{if(C.current){T.current=ff({domNode:C.current,minZoom:u,maxZoom:h,translateExtent:l,viewport:c,paneClickDistance:g,onDraggingChange:p=>w.setState({paneDragging:p}),onPanZoomStart:(p,_)=>{const{onViewportChangeStart:S,onMoveStart:E}=w.getState();E?.(p,_),S?.(_)},onPanZoom:(p,_)=>{const{onViewportChange:S,onMove:E}=w.getState();E?.(p,_),S?.(_)},onPanZoomEnd:(p,_)=>{const{onViewportChangeEnd:S,onMoveEnd:E}=w.getState();E?.(p,_),S?.(_)}});const{x:R,y:k,zoom:A}=T.current.getViewport();return w.setState({panZoom:T.current,transform:[R,k,A],domNode:C.current.closest(".react-flow")}),()=>{T.current?.destroy()}}},[]),I.useEffect(()=>{T.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:P,preventScrolling:f,noPanClassName:b,userSelectionActive:N,noWheelClassName:m,lib:$,onTransformChange:j})},[e,t,n,o,r,i,s,a,P,f,b,N,m,$,j]),x.jsx("div",{className:"react-flow__renderer",ref:C,style:dn,children:y})}const oh=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function rh(){const{userSelectionActive:e,userSelectionRect:t}=U(oh,oe);return e&&t?x.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Sn=(e,t)=>n=>{n.target===t.current&&e?.(n)},ih=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function sh({isSelecting:e,selectionKeyPressed:t,selectionMode:n=dt.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:h,onPaneMouseLeave:d,children:f}){const y=ne(),{userSelectionActive:m,elementsSelectable:b,dragging:v,connectionInProgress:M}=U(ih,oe),g=b&&(e||m),w=I.useRef(null),C=I.useRef(),N=I.useRef(new Set),$=I.useRef(new Set),P=I.useRef(!1),T=I.useRef(!1),j=E=>{if(P.current||M){P.current=!1;return}a?.(E),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},R=E=>{if(Array.isArray(o)&&o?.includes(2)){E.preventDefault();return}c?.(E)},k=l?E=>l(E):void 0,A=E=>{const{resetSelectedElements:H,domNode:D}=y.getState();if(C.current=D?.getBoundingClientRect(),!b||!e||E.button!==0||E.target!==w.current||!C.current)return;E.target?.setPointerCapture?.(E.pointerId),T.current=!0,P.current=!1;const{x:z,y:L}=me(E.nativeEvent,C.current);H(),y.setState({userSelectionRect:{width:0,height:0,startX:z,startY:L,x:z,y:L}}),i?.(E)},p=E=>{const{userSelectionRect:H,transform:D,nodeLookup:z,edgeLookup:L,connectionLookup:B,triggerNodeChanges:X,triggerEdgeChanges:V,defaultEdgeOptions:Z}=y.getState();if(!C.current||!H)return;P.current=!0;const{x:K,y:F}=me(E.nativeEvent,C.current),{startX:O,startY:W}=H,J={startX:O,startY:W,x:K<O?K:O,y:F<W?F:W,width:Math.abs(K-O),height:Math.abs(F-W)},ee=N.current,q=$.current;N.current=new Set(Zn(z,J,D,n===dt.Partial,!0).map(G=>G.id)),$.current=new Set;const Q=Z?.selectable??!0;for(const G of N.current){const te=B.get(G);if(te)for(const{edgeId:ie}of te.values()){const le=L.get(ie);le&&(le.selectable??Q)&&$.current.add(ie)}}if(!To(ee,N.current)){const G=Oe(z,N.current,!0);X(G)}if(!To(q,$.current)){const G=Oe(L,$.current);V(G)}y.setState({userSelectionRect:J,userSelectionActive:!0,nodesSelectionActive:!1})},_=E=>{if(E.button!==0||!T.current)return;E.target?.releasePointerCapture?.(E.pointerId);const{userSelectionRect:H}=y.getState();!m&&H&&E.target===w.current&&j?.(E),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:N.current.size>0}),s?.(E),(t||r)&&(P.current=!1),T.current=!1},S=o===!0||Array.isArray(o)&&o.includes(0);return x.jsxs("div",{className:re(["react-flow__pane",{draggable:S,dragging:v,selection:e}]),onClick:g?void 0:Sn(j,w),onContextMenu:Sn(R,w),onWheel:Sn(k,w),onPointerEnter:g?void 0:u,onPointerDown:g?A:h,onPointerMove:g?p:h,onPointerUp:g?_:void 0,onPointerLeave:d,ref:w,style:dn,children:[f,x.jsx(rh,{})]})}function Rn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c?.("012",xe.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function zi({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){const a=ne(),[c,l]=I.useState(!1),u=I.useRef();return I.useEffect(()=>{u.current=Kd({getStoreItems:()=>a.getState(),onNodeMouseDown:h=>{Rn({id:h,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),I.useEffect(()=>{if(t)u.current?.destroy();else if(e.current)return u.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{u.current?.destroy()}},[n,o,t,i,e,r]),c}const ah=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Li(){const e=ne();return I.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),h=new Map,d=ah(s),f=r?i[0]:5,y=r?i[1]:5,m=n.direction.x*f*n.factor,b=n.direction.y*y*n.factor;for(const[,v]of l){if(!d(v))continue;let M={x:v.internals.positionAbsolute.x+m,y:v.internals.positionAbsolute.y+b};r&&(M=vt(M,i));const{position:g,positionAbsolute:w}=ni({nodeId:v.id,nextPosition:M,nodeLookup:l,nodeExtent:o,nodeOrigin:u,onError:a});v.position=g,v.internals.positionAbsolute=w,h.set(v.id,v)}c(h)},[])}const eo=I.createContext(null),ch=eo.Provider;eo.Consumer;const Ri=()=>I.useContext(eo),lh=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),uh=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:c,isValid:l}=s,u=c?.nodeId===e&&c?.id===t&&c?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:u,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===Xe.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:u&&l}};function dh({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:h,...d},f){const y=s||null,m=e==="target",b=ne(),v=Ri(),{connectOnClick:M,noPanClassName:g,rfId:w}=U(lh,oe),{connectingFrom:C,connectingTo:N,clickConnecting:$,isPossibleEndHandle:P,connectionInProcess:T,clickConnectionInProcess:j,valid:R}=U(uh(v,y,e),oe);v||b.getState().onError?.("010",xe.error010());const k=_=>{const{defaultEdgeOptions:S,onConnect:E,hasDefaultEdges:H}=b.getState(),D={...S,..._};if(H){const{edges:z,setEdges:L}=b.getState();L(gi(D,z))}E?.(D),a?.(D)},A=_=>{if(!v)return;const S=ui(_.nativeEvent);if(r&&(S&&_.button===0||!S)){const E=b.getState();Ln.onPointerDown(_.nativeEvent,{handleDomNode:_.currentTarget,autoPanOnConnect:E.autoPanOnConnect,connectionMode:E.connectionMode,connectionRadius:E.connectionRadius,domNode:E.domNode,nodeLookup:E.nodeLookup,lib:E.lib,isTarget:m,handleId:y,nodeId:v,flowId:E.rfId,panBy:E.panBy,cancelConnection:E.cancelConnection,onConnectStart:E.onConnectStart,onConnectEnd:E.onConnectEnd,updateConnection:E.updateConnection,onConnect:k,isValidConnection:n||E.isValidConnection,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,autoPanSpeed:E.autoPanSpeed,dragThreshold:E.connectionDragThreshold})}S?u?.(_):h?.(_)},p=_=>{const{onClickConnectStart:S,onClickConnectEnd:E,connectionClickStartHandle:H,connectionMode:D,isValidConnection:z,lib:L,rfId:B,nodeLookup:X,connection:V}=b.getState();if(!v||!H&&!r)return;if(!H){S?.(_.nativeEvent,{nodeId:v,handleId:y,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:v,type:e,id:y}});return}const Z=ci(_.target),K=n||z,{connection:F,isValid:O}=Ln.isValid(_.nativeEvent,{handle:{nodeId:v,id:y,type:e},connectionMode:D,fromNodeId:H.nodeId,fromHandleId:H.id||null,fromType:H.type,isValidConnection:K,flowId:B,doc:Z,lib:L,nodeLookup:X});O&&F&&k(F);const W=structuredClone(V);delete W.inProgress,W.toPosition=W.toHandle?W.toHandle.position:null,E?.(_,W),b.setState({connectionClickStartHandle:null})};return x.jsx("div",{"data-handleid":y,"data-nodeid":v,"data-handlepos":t,"data-id":`${w}-${v}-${y}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,l,{source:!m,target:m,connectable:o,connectablestart:r,connectableend:i,clickconnecting:$,connectingfrom:C,connectingto:N,valid:R,connectionindicator:o&&(!T||P)&&(T||j?i:r)}]),onMouseDown:A,onTouchStart:A,onClick:M?p:void 0,ref:f,...d,children:c})}const Me=I.memo(Ti(dh));function fh({data:e,isConnectable:t,sourcePosition:n=Y.Bottom}){return x.jsxs(x.Fragment,{children:[e?.label,x.jsx(Me,{type:"source",position:n,isConnectable:t})]})}function hh({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:o=Y.Bottom}){return x.jsxs(x.Fragment,{children:[x.jsx(Me,{type:"target",position:n,isConnectable:t}),e?.label,x.jsx(Me,{type:"source",position:o,isConnectable:t})]})}function gh(){return null}function ph({data:e,isConnectable:t,targetPosition:n=Y.Top}){return x.jsxs(x.Fragment,{children:[x.jsx(Me,{type:"target",position:n,isConnectable:t}),e?.label]})}const Jt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ir={input:fh,default:hh,output:ph,group:gh};function mh(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const yh=e=>{const{width:t,height:n,x:o,y:r}=wt(e.nodeLookup,{filter:i=>!!i.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function xh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:r,height:i,transformString:s,userSelectionActive:a}=U(yh,oe),c=Li(),l=I.useRef(null);if(I.useEffect(()=>{n||l.current?.focus({preventScroll:!0})},[n]),zi({nodeRef:l}),a||!r||!i)return null;const u=e?d=>{const f=o.getState().nodes.filter(y=>y.selected);e(d,f)}:void 0,h=d=>{Object.prototype.hasOwnProperty.call(Jt,d.key)&&(d.preventDefault(),c({direction:Jt[d.key],factor:d.shiftKey?4:1}))};return x.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:x.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:r,height:i}})})}const sr=typeof window<"u"?window:void 0,wh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ji({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:h,onSelectionStart:d,onSelectionEnd:f,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:b,elementsSelectable:v,zoomOnScroll:M,zoomOnPinch:g,panOnScroll:w,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:$,panOnDrag:P,defaultViewport:T,translateExtent:j,minZoom:R,maxZoom:k,preventScrolling:A,onSelectionContextMenu:p,noWheelClassName:_,noPanClassName:S,disableKeyboardA11y:E,onViewportChange:H,isControlledViewport:D}){const{nodesSelectionActive:z,userSelectionActive:L}=U(wh),B=pt(l,{target:sr}),X=pt(m,{target:sr}),V=X||P,Z=X||w,K=u&&V!==!0,F=B||L||K;return Jf({deleteKeyCode:c,multiSelectionKeyCode:y}),x.jsx(nh,{onPaneContextMenu:i,elementsSelectable:v,zoomOnScroll:M,zoomOnPinch:g,panOnScroll:Z,panOnScrollSpeed:C,panOnScrollMode:N,zoomOnDoubleClick:$,panOnDrag:!B&&V,defaultViewport:T,translateExtent:j,minZoom:R,maxZoom:k,zoomActivationKeyCode:b,preventScrolling:A,noWheelClassName:_,noPanClassName:S,onViewportChange:H,isControlledViewport:D,paneClickDistance:a,children:x.jsxs(sh,{onSelectionStart:d,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:V,isSelecting:!!F,selectionMode:h,selectionKeyPressed:B,selectionOnDrag:K,children:[e,z&&x.jsx(xh,{onSelectionContextMenu:p,noPanClassName:S,disableKeyboardA11y:E})]})})}ji.displayName="FlowRenderer";const vh=I.memo(ji),bh=e=>t=>e?Zn(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function _h(e){return U(I.useCallback(bh(e),[e]),oe)}const Sh=e=>e.updateNodeInternals;function Eh(){const e=U(Sh),[t]=I.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),e(o)}));return I.useEffect(()=>()=>{t?.disconnect()},[t]),t}function Nh({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=ne(),i=I.useRef(null),s=I.useRef(null),a=I.useRef(e.sourcePosition),c=I.useRef(e.targetPosition),l=I.useRef(t),u=n&&!!e.internals.handleBounds;return I.useEffect(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[u,e.hidden]),I.useEffect(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),I.useEffect(()=>{if(i.current){const h=l.current!==t,d=a.current!==e.sourcePosition,f=c.current!==e.targetPosition;(h||d||f)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Ch({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:h,noDragClassName:d,noPanClassName:f,disableKeyboardA11y:y,rfId:m,nodeTypes:b,nodeClickDistance:v,onError:M}){const{node:g,internals:w,isParent:C}=U(O=>{const W=O.nodeLookup.get(e),J=O.parentLookup.has(e);return{node:W,internals:W.internals,isParent:J}},oe);let N=g.type||"default",$=b?.[N]||ir[N];$===void 0&&(M?.("003",xe.error003(N)),N="default",$=b?.default||ir.default);const P=!!(g.draggable||a&&typeof g.draggable>"u"),T=!!(g.selectable||c&&typeof g.selectable>"u"),j=!!(g.connectable||l&&typeof g.connectable>"u"),R=!!(g.focusable||u&&typeof g.focusable>"u"),k=ne(),A=si(g),p=Nh({node:g,nodeType:N,hasDimensions:A,resizeObserver:h}),_=zi({nodeRef:p,disabled:g.hidden||!P,noDragClassName:d,handleSelector:g.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:v}),S=Li();if(g.hidden)return null;const E=Ee(g),H=mh(g),D=T||P||t||n||o||r,z=n?O=>n(O,{...w.userNode}):void 0,L=o?O=>o(O,{...w.userNode}):void 0,B=r?O=>r(O,{...w.userNode}):void 0,X=i?O=>i(O,{...w.userNode}):void 0,V=s?O=>s(O,{...w.userNode}):void 0,Z=O=>{const{selectNodesOnDrag:W,nodeDragThreshold:J}=k.getState();T&&(!W||!P||J>0)&&Rn({id:e,store:k,nodeRef:p}),t&&t(O,{...w.userNode})},K=O=>{if(!(li(O.nativeEvent)||y)){if(Qr.includes(O.key)&&T){const W=O.key==="Escape";Rn({id:e,store:k,unselect:W,nodeRef:p})}else if(P&&g.selected&&Object.prototype.hasOwnProperty.call(Jt,O.key)){O.preventDefault();const{ariaLabelConfig:W}=k.getState();k.setState({ariaLiveMessage:W["node.a11yDescription.ariaLiveMessage"]({direction:O.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),S({direction:Jt[O.key],factor:O.shiftKey?4:1})}}},F=()=>{if(y||!p.current?.matches(":focus-visible"))return;const{transform:O,width:W,height:J,autoPanOnNodeFocus:ee,setCenter:q}=k.getState();if(!ee)return;Zn(new Map([[e,g]]),{x:0,y:0,width:W,height:J},O,!0).length>0||q(g.position.x+E.width/2,g.position.y+E.height/2,{zoom:O[2]})};return x.jsx("div",{className:re(["react-flow__node",`react-flow__node-${N}`,{[f]:P},g.className,{selected:g.selected,selectable:T,parent:C,draggable:P,dragging:_}]),ref:p,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:D?"all":"none",visibility:A?"visible":"hidden",...g.style,...H},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:L,onMouseLeave:B,onContextMenu:X,onClick:Z,onDoubleClick:V,onKeyDown:R?K:void 0,tabIndex:R?0:void 0,onFocus:R?F:void 0,role:g.ariaRole??(R?"group":void 0),"aria-roledescription":"node","aria-describedby":y?void 0:`${Mi}-${m}`,"aria-label":g.ariaLabel,...g.domAttributes,children:x.jsx(ch,{value:e,children:x.jsx($,{id:e,data:g.data,type:N,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:g.selected??!1,selectable:T,draggable:P,deletable:g.deletable??!0,isConnectable:j,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:_,dragHandle:g.dragHandle,zIndex:w.z,parentId:g.parentId,...E})})})}const kh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Oi(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=U(kh,oe),s=_h(e.onlyRenderVisibleElements),a=Eh();return x.jsx("div",{className:"react-flow__nodes",style:dn,children:s.map(c=>x.jsx(Ch,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}Oi.displayName="NodeRenderer";const Mh=I.memo(Oi);function $h(e){return U(I.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&Td({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),oe)}const Ih=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return x.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},Ah=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return x.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},ar={[Kt.Arrow]:Ih,[Kt.ArrowClosed]:Ah};function Dh(e){const t=ne();return I.useMemo(()=>Object.prototype.hasOwnProperty.call(ar,e)?ar[e]:(t.getState().onError?.("009",xe.error009(e)),null),[e])}const Ph=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=Dh(t);return c?x.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:x.jsx(c,{color:n,strokeWidth:s})}):null},Bi=({defaultColor:e,rfId:t})=>{const n=U(i=>i.edges),o=U(i=>i.defaultEdgeOptions),r=I.useMemo(()=>Bd(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?x.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:x.jsx("defs",{children:r.map(i=>x.jsx(Ph,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Bi.displayName="MarkerDefinitions";var Th=I.memo(Bi);function Vi({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[h,d]=I.useState({x:1,y:0,width:0,height:0}),f=re(["react-flow__edge-textwrapper",l]),y=I.useRef(null);return I.useEffect(()=>{if(y.current){const m=y.current.getBBox();d({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?x.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:f,visibility:h.width?"visible":"hidden",...u,children:[r&&x.jsx("rect",{width:h.width+2*s[0],x:-s[0],y:-s[1],height:h.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),x.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:y,style:o,children:n}),c]}):null}Vi.displayName="EdgeText";const Hh=I.memo(Vi);function St({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return x.jsxs(x.Fragment,{children:[x.jsx("path",{...u,d:e,fill:"none",className:re(["react-flow__edge-path",u.className])}),l?x.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,o&&he(t)&&he(n)?x.jsx(Hh,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function cr({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===Y.Left||e===Y.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function Fi({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:o,targetY:r,targetPosition:i=Y.Top}){const[s,a]=cr({pos:n,x1:e,y1:t,x2:o,y2:r}),[c,l]=cr({pos:i,x1:o,y1:r,x2:e,y2:t}),[u,h,d,f]=di({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${o},${r}`,u,h,d,f]}function Yi(e){return I.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s,targetPosition:a,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:d,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:b,interactionWidth:v})=>{const[M,g,w]=Fi({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),C=e.isInternal?void 0:t;return x.jsx(St,{id:C,path:M,labelX:g,labelY:w,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:d,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:b,interactionWidth:v})})}const zh=Yi({isInternal:!1}),Xi=Yi({isInternal:!0});zh.displayName="SimpleBezierEdge";Xi.displayName="SimpleBezierEdgeInternal";function Wi(e){return I.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:d,sourcePosition:f=Y.Bottom,targetPosition:y=Y.Top,markerEnd:m,markerStart:b,pathOptions:v,interactionWidth:M})=>{const[g,w,C]=Tn({sourceX:n,sourceY:o,sourcePosition:f,targetX:r,targetY:i,targetPosition:y,borderRadius:v?.borderRadius,offset:v?.offset,stepPosition:v?.stepPosition}),N=e.isInternal?void 0:t;return x.jsx(St,{id:N,path:g,labelX:w,labelY:C,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:m,markerStart:b,interactionWidth:M})})}const Zi=Wi({isInternal:!1}),qi=Wi({isInternal:!0});Zi.displayName="SmoothStepEdge";qi.displayName="SmoothStepEdgeInternal";function Gi(e){return I.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return x.jsx(Zi,{...n,id:o,pathOptions:I.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const Lh=Gi({isInternal:!1}),Ki=Gi({isInternal:!0});Lh.displayName="StepEdge";Ki.displayName="StepEdgeInternal";function Qi(e){return I.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:f,markerStart:y,interactionWidth:m})=>{const[b,v,M]=pi({sourceX:n,sourceY:o,targetX:r,targetY:i}),g=e.isInternal?void 0:t;return x.jsx(St,{id:g,path:b,labelX:v,labelY:M,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:h,style:d,markerEnd:f,markerStart:y,interactionWidth:m})})}const Rh=Qi({isInternal:!1}),Ui=Qi({isInternal:!0});Rh.displayName="StraightEdge";Ui.displayName="StraightEdgeInternal";function Ji(e){return I.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=Y.Bottom,targetPosition:a=Y.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:d,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:b,pathOptions:v,interactionWidth:M})=>{const[g,w,C]=fi({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:v?.curvature}),N=e.isInternal?void 0:t;return x.jsx(St,{id:N,path:g,labelX:w,labelY:C,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:h,labelBgPadding:d,labelBgBorderRadius:f,style:y,markerEnd:m,markerStart:b,interactionWidth:M})})}const jh=Ji({isInternal:!1}),es=Ji({isInternal:!0});jh.displayName="BezierEdge";es.displayName="BezierEdgeInternal";const lr={default:es,straight:Ui,step:Ki,smoothstep:qi,simplebezier:Xi},ur={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Oh=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,Bh=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,dr="react-flow__edgeupdater";function fr({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return x.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:re([dr,`${dr}-${a}`]),cx:Oh(t,o,e),cy:Bh(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function Vh({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:h,setReconnecting:d,setUpdateHover:f}){const y=ne(),m=(w,C)=>{if(w.button!==0)return;const{autoPanOnConnect:N,domNode:$,isValidConnection:P,connectionMode:T,connectionRadius:j,lib:R,onConnectStart:k,onConnectEnd:A,cancelConnection:p,nodeLookup:_,rfId:S,panBy:E,updateConnection:H}=y.getState(),D=C.type==="target",z=(X,V)=>{d(!1),h?.(X,n,C.type,V)},L=X=>l?.(n,X),B=(X,V)=>{d(!0),u?.(w,n,C.type),k?.(X,V)};Ln.onPointerDown(w.nativeEvent,{autoPanOnConnect:N,connectionMode:T,connectionRadius:j,domNode:$,handleId:C.id,nodeId:C.nodeId,nodeLookup:_,isTarget:D,edgeUpdaterType:C.type,lib:R,flowId:S,cancelConnection:p,panBy:E,isValidConnection:P,onConnect:L,onConnectStart:B,onConnectEnd:A,onReconnectEnd:z,updateConnection:H,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,dragThreshold:y.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},b=w=>m(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),v=w=>m(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),M=()=>f(!0),g=()=>f(!1);return x.jsxs(x.Fragment,{children:[(e===!0||e==="source")&&x.jsx(fr,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:b,onMouseEnter:M,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&x.jsx(fr,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:v,onMouseEnter:M,onMouseOut:g,type:"target"})]})}function Fh({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:h,onReconnectStart:d,onReconnectEnd:f,rfId:y,edgeTypes:m,noPanClassName:b,onError:v,disableKeyboardA11y:M}){let g=U(q=>q.edgeLookup.get(e));const w=U(q=>q.defaultEdgeOptions);g=w?{...w,...g}:g;let C=g.type||"default",N=m?.[C]||lr[C];N===void 0&&(v?.("011",xe.error011(C)),C="default",N=m?.default||lr.default);const $=!!(g.focusable||t&&typeof g.focusable>"u"),P=typeof h<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),T=!!(g.selectable||o&&typeof g.selectable>"u"),j=I.useRef(null),[R,k]=I.useState(!1),[A,p]=I.useState(!1),_=ne(),{zIndex:S,sourceX:E,sourceY:H,targetX:D,targetY:z,sourcePosition:L,targetPosition:B}=U(I.useCallback(q=>{const Q=q.nodeLookup.get(g.source),G=q.nodeLookup.get(g.target);if(!Q||!G)return{zIndex:g.zIndex,...ur};const te=Od({id:e,sourceNode:Q,targetNode:G,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:q.connectionMode,onError:v});return{zIndex:Pd({selected:g.selected,zIndex:g.zIndex,sourceNode:Q,targetNode:G,elevateOnSelect:q.elevateEdgesOnSelect}),...te||ur}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),oe),X=I.useMemo(()=>g.markerStart?`url('#${Hn(g.markerStart,y)}')`:void 0,[g.markerStart,y]),V=I.useMemo(()=>g.markerEnd?`url('#${Hn(g.markerEnd,y)}')`:void 0,[g.markerEnd,y]);if(g.hidden||E===null||H===null||D===null||z===null)return null;const Z=q=>{const{addSelectedEdges:Q,unselectNodesAndEdges:G,multiSelectionActive:te}=_.getState();T&&(_.setState({nodesSelectionActive:!1}),g.selected&&te?(G({nodes:[],edges:[g]}),j.current?.blur()):Q([e])),r&&r(q,g)},K=i?q=>{i(q,{...g})}:void 0,F=s?q=>{s(q,{...g})}:void 0,O=a?q=>{a(q,{...g})}:void 0,W=c?q=>{c(q,{...g})}:void 0,J=l?q=>{l(q,{...g})}:void 0,ee=q=>{if(!M&&Qr.includes(q.key)&&T){const{unselectNodesAndEdges:Q,addSelectedEdges:G}=_.getState();q.key==="Escape"?(j.current?.blur(),Q({edges:[g]})):G([e])}};return x.jsx("svg",{style:{zIndex:S},children:x.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${C}`,g.className,b,{selected:g.selected,animated:g.animated,inactive:!T&&!r,updating:R,selectable:T}]),onClick:Z,onDoubleClick:K,onContextMenu:F,onMouseEnter:O,onMouseMove:W,onMouseLeave:J,onKeyDown:$?ee:void 0,tabIndex:$?0:void 0,role:g.ariaRole??($?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":$?`${$i}-${y}`:void 0,ref:j,...g.domAttributes,children:[!A&&x.jsx(N,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:T,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:E,sourceY:H,targetX:D,targetY:z,sourcePosition:L,targetPosition:B,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:X,markerEnd:V,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),P&&x.jsx(Vh,{edge:g,isReconnectable:P,reconnectRadius:u,onReconnect:h,onReconnectStart:d,onReconnectEnd:f,sourceX:E,sourceY:H,targetX:D,targetY:z,sourcePosition:L,targetPosition:B,setUpdateHover:k,setReconnecting:p})]})})}const Yh=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ts({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:h,onEdgeDoubleClick:d,onReconnectStart:f,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:b,edgesReconnectable:v,elementsSelectable:M,onError:g}=U(Yh,oe),w=$h(t);return x.jsxs("div",{className:"react-flow__edges",children:[x.jsx(Th,{defaultColor:e,rfId:n}),w.map(C=>x.jsx(Fh,{id:C,edgesFocusable:b,edgesReconnectable:v,elementsSelectable:M,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:h,onDoubleClick:d,onReconnectStart:f,onReconnectEnd:y,rfId:n,onError:g,edgeTypes:o,disableKeyboardA11y:m},C))]})}ts.displayName="EdgeRenderer";const Xh=I.memo(ts),Wh=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Zh({children:e}){const t=U(Wh);return x.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function qh(e){const t=un(),n=I.useRef(!1);I.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Gh=e=>e.panZoom?.syncViewport;function Kh(e){const t=U(Gh),n=ne();return I.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Qh(e){return e.connection.inProgress?{...e.connection,to:bt(e.connection.to,e.transform)}:{...e.connection}}function Uh(e){return Qh}function Jh(e){const t=Uh();return U(t,oe)}const eg=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function tg({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:c}=U(eg,oe);return!(i&&r&&c)?null:x.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:x.jsx("g",{className:re(["react-flow__connection",ei(a)]),children:x.jsx(ns,{style:t,type:n,CustomComponent:o,isValid:a})})})}const ns=({style:e,type:t=ke.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:h,toPosition:d}=Jh();if(!r)return;if(n)return x.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:d,connectionStatus:ei(o),toNode:u,toHandle:h});let f="";const y={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:d};switch(t){case ke.Bezier:[f]=fi(y);break;case ke.SimpleBezier:[f]=Fi(y);break;case ke.Step:[f]=Tn({...y,borderRadius:0});break;case ke.SmoothStep:[f]=Tn(y);break;default:[f]=pi(y)}return x.jsx("path",{d:f,fill:"none",className:"react-flow__connection-path",style:e})};ns.displayName="ConnectionLine";const ng={};function hr(e=ng){I.useRef(e),ne(),I.useEffect(()=>{},[e])}function og(){ne(),I.useRef(!1),I.useEffect(()=>{},[])}function os({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:h,onSelectionStart:d,onSelectionEnd:f,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:b,connectionLineContainerStyle:v,selectionKeyCode:M,selectionOnDrag:g,selectionMode:w,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:$,deleteKeyCode:P,onlyRenderVisibleElements:T,elementsSelectable:j,defaultViewport:R,translateExtent:k,minZoom:A,maxZoom:p,preventScrolling:_,defaultMarkerColor:S,zoomOnScroll:E,zoomOnPinch:H,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:L,zoomOnDoubleClick:B,panOnDrag:X,onPaneClick:V,onPaneMouseEnter:Z,onPaneMouseMove:K,onPaneMouseLeave:F,onPaneScroll:O,onPaneContextMenu:W,paneClickDistance:J,nodeClickDistance:ee,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:G,onEdgeMouseLeave:te,reconnectRadius:ie,onReconnect:le,onReconnectStart:ze,onReconnectEnd:Et,noDragClassName:Nt,noWheelClassName:Ct,noPanClassName:Ke,disableKeyboardA11y:Qe,nodeExtent:fn,rfId:kt,viewport:Le,onViewportChange:Ue}){return hr(e),hr(t),og(),qh(n),Kh(Le),x.jsx(vh,{onPaneClick:V,onPaneMouseEnter:Z,onPaneMouseMove:K,onPaneMouseLeave:F,onPaneContextMenu:W,onPaneScroll:O,paneClickDistance:J,deleteKeyCode:P,selectionKeyCode:M,selectionOnDrag:g,selectionMode:w,onSelectionStart:d,onSelectionEnd:f,multiSelectionKeyCode:C,panActivationKeyCode:N,zoomActivationKeyCode:$,elementsSelectable:j,zoomOnScroll:E,zoomOnPinch:H,zoomOnDoubleClick:B,panOnScroll:D,panOnScrollSpeed:z,panOnScrollMode:L,panOnDrag:X,defaultViewport:R,translateExtent:k,minZoom:A,maxZoom:p,onSelectionContextMenu:h,preventScrolling:_,noDragClassName:Nt,noWheelClassName:Ct,noPanClassName:Ke,disableKeyboardA11y:Qe,onViewportChange:Ue,isControlledViewport:!!Le,children:x.jsxs(Zh,{children:[x.jsx(Xh,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:le,onReconnectStart:ze,onReconnectEnd:Et,onlyRenderVisibleElements:T,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:G,onEdgeMouseLeave:te,reconnectRadius:ie,defaultMarkerColor:S,noPanClassName:Ke,disableKeyboardA11y:Qe,rfId:kt}),x.jsx(tg,{style:m,type:y,component:b,containerStyle:v}),x.jsx("div",{className:"react-flow__edgelabel-renderer"}),x.jsx(Mh,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:ee,onlyRenderVisibleElements:T,noPanClassName:Ke,noDragClassName:Nt,disableKeyboardA11y:Qe,nodeExtent:fn,rfId:kt}),x.jsx("div",{className:"react-flow__viewport-portal"})]})})}os.displayName="GraphView";const rg=I.memo(os),gr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:h}={})=>{const d=new Map,f=new Map,y=new Map,m=new Map,b=o??t??[],v=n??e??[],M=u??[0,0],g=h??ut;yi(y,m,b);const w=zn(v,d,f,{nodeOrigin:M,nodeExtent:g,elevateNodesOnSelect:!1});let C=[0,0,1];if(s&&r&&i){const N=wt(d,{filter:j=>!!((j.width||j.initialWidth)&&(j.height||j.initialHeight))}),{x:$,y:P,zoom:T}=qn(N,r,i,c,l,a?.padding??.1);C=[$,P,T]}return{rfId:"1",width:0,height:0,transform:C,nodes:v,nodesInitialized:w,nodeLookup:d,parentLookup:f,edges:b,edgeLookup:m,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:ut,nodeExtent:g,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Xe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:M,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Jr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:kd,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Ur}},ig=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h})=>Nf((d,f)=>{async function y(){const{nodeLookup:m,panZoom:b,fitViewOptions:v,fitViewResolver:M,width:g,height:w,minZoom:C,maxZoom:N}=f();b&&(await Nd({nodes:m,width:g,height:w,panZoom:b,minZoom:C,maxZoom:N},v),M?.resolve(!0),d({fitViewResolver:null}))}return{...gr({nodes:e,edges:t,width:r,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:h,defaultNodes:n,defaultEdges:o}),setNodes:m=>{const{nodeLookup:b,parentLookup:v,nodeOrigin:M,elevateNodesOnSelect:g,fitViewQueued:w}=f(),C=zn(m,b,v,{nodeOrigin:M,nodeExtent:h,elevateNodesOnSelect:g,checkEquality:!0});w&&C?(y(),d({nodes:m,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):d({nodes:m,nodesInitialized:C})},setEdges:m=>{const{connectionLookup:b,edgeLookup:v}=f();yi(b,v,m),d({edges:m})},setDefaultNodesAndEdges:(m,b)=>{if(m){const{setNodes:v}=f();v(m),d({hasDefaultNodes:!0})}if(b){const{setEdges:v}=f();v(b),d({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:b,nodeLookup:v,parentLookup:M,domNode:g,nodeOrigin:w,nodeExtent:C,debug:N,fitViewQueued:$}=f(),{changes:P,updatedInternals:T}=Wd(m,v,M,g,w,C);T&&(Fd(v,M,{nodeOrigin:w,nodeExtent:C}),$?(y(),d({fitViewQueued:!1,fitViewOptions:void 0})):d({}),P?.length>0&&(N&&console.log("React Flow: trigger node changes",P),b?.(P)))},updateNodePositions:(m,b=!1)=>{const v=[],M=[],{nodeLookup:g,triggerNodeChanges:w}=f();for(const[C,N]of m){const $=g.get(C),P=!!($?.expandParent&&$?.parentId&&N?.position),T={id:C,type:"position",position:P?{x:Math.max(0,N.position.x),y:Math.max(0,N.position.y)}:N.position,dragging:b};P&&$.parentId&&v.push({id:C,parentId:$.parentId,rect:{...N.internals.positionAbsolute,width:N.measured.width??0,height:N.measured.height??0}}),M.push(T)}if(v.length>0){const{parentLookup:C,nodeOrigin:N}=f(),$=Jn(v,g,C,N);M.push(...$)}w(M)},triggerNodeChanges:m=>{const{onNodesChange:b,setNodes:v,nodes:M,hasDefaultNodes:g,debug:w}=f();if(m?.length){if(g){const C=Di(m,M);v(C)}w&&console.log("React Flow: trigger node changes",m),b?.(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:b,setEdges:v,edges:M,hasDefaultEdges:g,debug:w}=f();if(m?.length){if(g){const C=Pi(m,M);v(C)}w&&console.log("React Flow: trigger edge changes",m),b?.(m)}},addSelectedNodes:m=>{const{multiSelectionActive:b,edgeLookup:v,nodeLookup:M,triggerNodeChanges:g,triggerEdgeChanges:w}=f();if(b){const C=m.map(N=>$e(N,!0));g(C);return}g(Oe(M,new Set([...m]),!0)),w(Oe(v))},addSelectedEdges:m=>{const{multiSelectionActive:b,edgeLookup:v,nodeLookup:M,triggerNodeChanges:g,triggerEdgeChanges:w}=f();if(b){const C=m.map(N=>$e(N,!0));w(C);return}w(Oe(v,new Set([...m]))),g(Oe(M,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:b}={})=>{const{edges:v,nodes:M,nodeLookup:g,triggerNodeChanges:w,triggerEdgeChanges:C}=f(),N=m||M,$=b||v,P=N.map(j=>{const R=g.get(j.id);return R&&(R.selected=!1),$e(j.id,!1)}),T=$.map(j=>$e(j.id,!1));w(P),C(T)},setMinZoom:m=>{const{panZoom:b,maxZoom:v}=f();b?.setScaleExtent([m,v]),d({minZoom:m})},setMaxZoom:m=>{const{panZoom:b,minZoom:v}=f();b?.setScaleExtent([v,m]),d({maxZoom:m})},setTranslateExtent:m=>{f().panZoom?.setTranslateExtent(m),d({translateExtent:m})},setPaneClickDistance:m=>{f().panZoom?.setClickDistance(m)},resetSelectedElements:()=>{const{edges:m,nodes:b,triggerNodeChanges:v,triggerEdgeChanges:M,elementsSelectable:g}=f();if(!g)return;const w=b.reduce((N,$)=>$.selected?[...N,$e($.id,!1)]:N,[]),C=m.reduce((N,$)=>$.selected?[...N,$e($.id,!1)]:N,[]);v(w),M(C)},setNodeExtent:m=>{const{nodes:b,nodeLookup:v,parentLookup:M,nodeOrigin:g,elevateNodesOnSelect:w,nodeExtent:C}=f();m[0][0]===C[0][0]&&m[0][1]===C[0][1]&&m[1][0]===C[1][0]&&m[1][1]===C[1][1]||(zn(b,v,M,{nodeOrigin:g,nodeExtent:m,elevateNodesOnSelect:w,checkEquality:!1}),d({nodeExtent:m}))},panBy:m=>{const{transform:b,width:v,height:M,panZoom:g,translateExtent:w}=f();return Zd({delta:m,panZoom:g,transform:b,translateExtent:w,width:v,height:M})},setCenter:async(m,b,v)=>{const{width:M,height:g,maxZoom:w,panZoom:C}=f();if(!C)return Promise.resolve(!1);const N=typeof v?.zoom<"u"?v.zoom:w;return await C.setViewport({x:M/2-m*N,y:g/2-b*N,zoom:N},{duration:v?.duration,ease:v?.ease,interpolate:v?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{d({connection:{...Jr}})},updateConnection:m=>{d({connection:m})},reset:()=>d({...gr()})}},Object.is);function rs({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:h,children:d}){const[f]=I.useState(()=>ig({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:l,minZoom:s,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:h}));return x.jsx(Cf,{value:f,children:x.jsx(Gf,{children:d})})}function sg({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:h,nodeExtent:d}){return I.useContext(ln)?x.jsx(x.Fragment,{children:e}):x.jsx(rs,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:h,nodeExtent:d,children:e})}const ag={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function cg({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:h,onMoveEnd:d,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:b,onClickConnectEnd:v,onNodeMouseEnter:M,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:N,onNodeDragStart:$,onNodeDrag:P,onNodeDragStop:T,onNodesDelete:j,onEdgesDelete:R,onDelete:k,onSelectionChange:A,onSelectionDragStart:p,onSelectionDrag:_,onSelectionDragStop:S,onSelectionContextMenu:E,onSelectionStart:H,onSelectionEnd:D,onBeforeDelete:z,connectionMode:L,connectionLineType:B=ke.Bezier,connectionLineStyle:X,connectionLineComponent:V,connectionLineContainerStyle:Z,deleteKeyCode:K="Backspace",selectionKeyCode:F="Shift",selectionOnDrag:O=!1,selectionMode:W=dt.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:ee=ht()?"Meta":"Control",zoomActivationKeyCode:q=ht()?"Meta":"Control",snapToGrid:Q,snapGrid:G,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:ie,nodesDraggable:le,autoPanOnNodeFocus:ze,nodesConnectable:Et,nodesFocusable:Nt,nodeOrigin:Ct=Ii,edgesFocusable:Ke,edgesReconnectable:Qe,elementsSelectable:fn=!0,defaultViewport:kt=jf,minZoom:Le=.5,maxZoom:Ue=2,translateExtent:to=ut,preventScrolling:cs=!0,nodeExtent:hn,defaultMarkerColor:ls="#b1b1b7",zoomOnScroll:us=!0,zoomOnPinch:ds=!0,panOnScroll:fs=!1,panOnScrollSpeed:hs=.5,panOnScrollMode:gs=De.Free,zoomOnDoubleClick:ps=!0,panOnDrag:ms=!0,onPaneClick:ys,onPaneMouseEnter:xs,onPaneMouseMove:ws,onPaneMouseLeave:vs,onPaneScroll:bs,onPaneContextMenu:_s,paneClickDistance:no=0,nodeClickDistance:Ss=0,children:Es,onReconnect:Ns,onReconnectStart:Cs,onReconnectEnd:ks,onEdgeContextMenu:Ms,onEdgeDoubleClick:$s,onEdgeMouseEnter:Is,onEdgeMouseMove:As,onEdgeMouseLeave:Ds,reconnectRadius:Ps=10,onNodesChange:Ts,onEdgesChange:Hs,noDragClassName:zs="nodrag",noWheelClassName:Ls="nowheel",noPanClassName:oo="nopan",fitView:ro,fitViewOptions:io,connectOnClick:Rs,attributionPosition:js,proOptions:Os,defaultEdgeOptions:Bs,elevateNodesOnSelect:Vs,elevateEdgesOnSelect:Fs,disableKeyboardA11y:so=!1,autoPanOnConnect:Ys,autoPanOnNodeDrag:Xs,autoPanSpeed:Ws,connectionRadius:Zs,isValidConnection:qs,onError:Gs,style:Ks,id:ao,nodeDragThreshold:Qs,connectionDragThreshold:Us,viewport:Js,onViewportChange:ea,width:ta,height:na,colorMode:oa="light",debug:ra,onScroll:co,ariaLabelConfig:ia,...sa},aa){const gn=ao||"1",ca=Ff(oa),la=I.useCallback(lo=>{lo.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),co?.(lo)},[co]);return x.jsx("div",{"data-testid":"rf__wrapper",...sa,onScroll:la,style:{...Ks,...ag},ref:aa,className:re(["react-flow",r,ca]),id:ao,role:"application",children:x.jsxs(sg,{nodes:e,edges:t,width:ta,height:na,fitView:ro,fitViewOptions:io,minZoom:Le,maxZoom:Ue,nodeOrigin:Ct,nodeExtent:hn,children:[x.jsx(rg,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:M,onNodeMouseMove:g,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:N,nodeTypes:i,edgeTypes:s,connectionLineType:B,connectionLineStyle:X,connectionLineComponent:V,connectionLineContainerStyle:Z,selectionKeyCode:F,selectionOnDrag:O,selectionMode:W,deleteKeyCode:K,multiSelectionKeyCode:ee,panActivationKeyCode:J,zoomActivationKeyCode:q,onlyRenderVisibleElements:te,defaultViewport:kt,translateExtent:to,minZoom:Le,maxZoom:Ue,preventScrolling:cs,zoomOnScroll:us,zoomOnPinch:ds,zoomOnDoubleClick:ps,panOnScroll:fs,panOnScrollSpeed:hs,panOnScrollMode:gs,panOnDrag:ms,onPaneClick:ys,onPaneMouseEnter:xs,onPaneMouseMove:ws,onPaneMouseLeave:vs,onPaneScroll:bs,onPaneContextMenu:_s,paneClickDistance:no,nodeClickDistance:Ss,onSelectionContextMenu:E,onSelectionStart:H,onSelectionEnd:D,onReconnect:Ns,onReconnectStart:Cs,onReconnectEnd:ks,onEdgeContextMenu:Ms,onEdgeDoubleClick:$s,onEdgeMouseEnter:Is,onEdgeMouseMove:As,onEdgeMouseLeave:Ds,reconnectRadius:Ps,defaultMarkerColor:ls,noDragClassName:zs,noWheelClassName:Ls,noPanClassName:oo,rfId:gn,disableKeyboardA11y:so,nodeExtent:hn,viewport:Js,onViewportChange:ea}),x.jsx(Vf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:y,onConnectEnd:m,onClickConnectStart:b,onClickConnectEnd:v,nodesDraggable:le,autoPanOnNodeFocus:ze,nodesConnectable:Et,nodesFocusable:Nt,edgesFocusable:Ke,edgesReconnectable:Qe,elementsSelectable:fn,elevateNodesOnSelect:Vs,elevateEdgesOnSelect:Fs,minZoom:Le,maxZoom:Ue,nodeExtent:hn,onNodesChange:Ts,onEdgesChange:Hs,snapToGrid:Q,snapGrid:G,connectionMode:L,translateExtent:to,connectOnClick:Rs,defaultEdgeOptions:Bs,fitView:ro,fitViewOptions:io,onNodesDelete:j,onEdgesDelete:R,onDelete:k,onNodeDragStart:$,onNodeDrag:P,onNodeDragStop:T,onSelectionDrag:_,onSelectionDragStart:p,onSelectionDragStop:S,onMove:u,onMoveStart:h,onMoveEnd:d,noPanClassName:oo,nodeOrigin:Ct,rfId:gn,autoPanOnConnect:Ys,autoPanOnNodeDrag:Xs,autoPanSpeed:Ws,onError:Gs,connectionRadius:Zs,isValidConnection:qs,selectNodesOnDrag:ie,nodeDragThreshold:Qs,connectionDragThreshold:Us,onBeforeDelete:z,paneClickDistance:no,debug:ra,ariaLabelConfig:ia}),x.jsx(Rf,{onSelectionChange:A}),Es,x.jsx(Pf,{proOptions:Os,position:js}),x.jsx(Df,{rfId:gn,disableKeyboardA11y:so})]})})}var lg=Ti(cg);const ug=e=>e.domNode?.querySelector(".react-flow__edgelabel-renderer");function dg({children:e}){const t=U(ug);return t?xr.createPortal(e,t):null}function fg({dimensions:e,lineWidth:t,variant:n,className:o}){return x.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function hg({radius:e,className:t}){return x.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var _e;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(_e||(_e={}));const gg={[_e.Dots]:1,[_e.Lines]:1,[_e.Cross]:6},pg=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function is({id:e,variant:t=_e.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:c,className:l,patternClassName:u}){const h=I.useRef(null),{transform:d,patternId:f}=U(pg,oe),y=o||gg[t],m=t===_e.Dots,b=t===_e.Cross,v=Array.isArray(n)?n:[n,n],M=[v[0]*d[2]||1,v[1]*d[2]||1],g=y*d[2],w=Array.isArray(i)?i:[i,i],C=b?[g,g]:M,N=[w[0]*d[2]||1+C[0]/2,w[1]*d[2]||1+C[1]/2],$=`${f}${e||""}`;return x.jsxs("svg",{className:re(["react-flow__background",l]),style:{...c,...dn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:h,"data-testid":"rf__background",children:[x.jsx("pattern",{id:$,x:d[0]%M[0],y:d[1]%M[1],width:M[0],height:M[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`,children:m?x.jsx(hg,{radius:g/2,className:u}):x.jsx(fg,{dimensions:C,lineWidth:r,variant:t,className:u})}),x.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${$})`})]})}is.displayName="Background";const mg=I.memo(is);function yg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:x.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function xg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:x.jsx("path",{d:"M0 0h32v4.2H0z"})})}function wg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:x.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function vg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:x.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function bg(){return x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:x.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function zt({children:e,className:t,...n}){return x.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const _g=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ss({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:h="bottom-left",orientation:d="vertical","aria-label":f}){const y=ne(),{isInteractive:m,minZoomReached:b,maxZoomReached:v,ariaLabelConfig:M}=U(_g,oe),{zoomIn:g,zoomOut:w,fitView:C}=un(),N=()=>{g(),i?.()},$=()=>{w(),s?.()},P=()=>{C(r),a?.()},T=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c?.(!m)},j=d==="horizontal"?"horizontal":"vertical";return x.jsxs(_t,{className:re(["react-flow__controls",j,l]),position:h,style:e,"data-testid":"rf__controls","aria-label":f??M["controls.ariaLabel"],children:[t&&x.jsxs(x.Fragment,{children:[x.jsx(zt,{onClick:N,className:"react-flow__controls-zoomin",title:M["controls.zoomIn.ariaLabel"],"aria-label":M["controls.zoomIn.ariaLabel"],disabled:v,children:x.jsx(yg,{})}),x.jsx(zt,{onClick:$,className:"react-flow__controls-zoomout",title:M["controls.zoomOut.ariaLabel"],"aria-label":M["controls.zoomOut.ariaLabel"],disabled:b,children:x.jsx(xg,{})})]}),n&&x.jsx(zt,{className:"react-flow__controls-fitview",onClick:P,title:M["controls.fitView.ariaLabel"],"aria-label":M["controls.fitView.ariaLabel"],children:x.jsx(wg,{})}),o&&x.jsx(zt,{className:"react-flow__controls-interactive",onClick:T,title:M["controls.interactive.ariaLabel"],"aria-label":M["controls.interactive.ariaLabel"],children:m?x.jsx(bg,{}):x.jsx(vg,{})}),u]})}ss.displayName="Controls";const Sg=I.memo(ss);function Eg({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:h,selected:d,onClick:f}){const{background:y,backgroundColor:m}=i||{},b=s||y||m;return x.jsx("rect",{className:re(["react-flow__minimap-node",{selected:d},l]),x:t,y:n,rx:u,ry:u,width:o,height:r,style:{fill:b,stroke:a,strokeWidth:c},shapeRendering:h,onClick:f?v=>f(v,e):void 0})}const Ng=I.memo(Eg),Cg=e=>e.nodes.map(t=>t.id),En=e=>e instanceof Function?e:()=>e;function kg({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=Ng,onClick:s}){const a=U(Cg,oe),c=En(t),l=En(e),u=En(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return x.jsx(x.Fragment,{children:a.map(d=>x.jsx($g,{id:d,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:h},d))})}function Mg({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:c}){const{node:l,x:u,y:h,width:d,height:f}=U(y=>{const{internals:m}=y.nodeLookup.get(e),b=m.userNode,{x:v,y:M}=m.positionAbsolute,{width:g,height:w}=Ee(b);return{node:b,x:v,y:M,width:g,height:w}},oe);return!l||l.hidden||!si(l)?null:x.jsx(a,{x:u,y:h,width:d,height:f,style:l.style,selected:!!l.selected,className:o(l),color:t(l),borderRadius:r,strokeColor:n(l),strokeWidth:i,shapeRendering:s,onClick:c,id:l.id})}const $g=I.memo(Mg);var Ig=I.memo(kg);const Ag=200,Dg=150,Pg=e=>!e.hidden,Tg=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?ii(wt(e.nodeLookup,{filter:Pg}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Hg="react-flow__minimap-desc";function as({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:h,position:d="bottom-right",onClick:f,onNodeClick:y,pannable:m=!1,zoomable:b=!1,ariaLabel:v,inversePan:M,zoomStep:g=1,offsetScale:w=5}){const C=ne(),N=I.useRef(null),{boundingRect:$,viewBB:P,rfId:T,panZoom:j,translateExtent:R,flowWidth:k,flowHeight:A,ariaLabelConfig:p}=U(Tg,oe),_=e?.width??Ag,S=e?.height??Dg,E=$.width/_,H=$.height/S,D=Math.max(E,H),z=D*_,L=D*S,B=w*D,X=$.x-(z-$.width)/2-B,V=$.y-(L-$.height)/2-B,Z=z+B*2,K=L+B*2,F=`${Hg}-${T}`,O=I.useRef(0),W=I.useRef();O.current=D,I.useEffect(()=>{if(N.current&&j)return W.current=nf({domNode:N.current,panZoom:j,getTransform:()=>C.getState().transform,getViewScale:()=>O.current}),()=>{W.current?.destroy()}},[j]),I.useEffect(()=>{W.current?.update({translateExtent:R,width:k,height:A,inversePan:M,pannable:m,zoomStep:g,zoomable:b})},[m,b,M,g,R,k,A]);const J=f?Q=>{const[G,te]=W.current?.pointer(Q)||[0,0];f(Q,{x:G,y:te})}:void 0,ee=y?I.useCallback((Q,G)=>{const te=C.getState().nodeLookup.get(G).internals.userNode;y(Q,te)},[]):void 0,q=v??p["minimap.ariaLabel"];return x.jsx(_t,{position:d,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*D:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:x.jsxs("svg",{width:_,height:S,viewBox:`${X} ${V} ${Z} ${K}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":F,ref:N,onClick:J,children:[q&&x.jsx("title",{id:F,children:q}),x.jsx(Ig,{onClick:ee,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),x.jsx("path",{className:"react-flow__minimap-mask",d:`M${X-B},${V-B}h${Z+B*2}v${K+B*2}h${-Z-B*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}as.displayName="MiniMap";const zg=I.memo(as),Lg=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Rg={[Ge.Line]:"right",[Ge.Handle]:"bottom-right"};function jg({nodeId:e,position:t,variant:n=Ge.Handle,className:o,style:r=void 0,children:i,color:s,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:d,autoScale:f=!0,shouldResize:y,onResizeStart:m,onResize:b,onResizeEnd:v}){const M=Ri(),g=typeof e=="string"?e:M,w=ne(),C=I.useRef(null),N=n===Ge.Handle,$=U(I.useCallback(Lg(N&&f),[N,f]),oe),P=I.useRef(null),T=t??Rg[n];I.useEffect(()=>{if(!(!C.current||!g))return P.current||(P.current=wf({domNode:C.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:R,transform:k,snapGrid:A,snapToGrid:p,nodeOrigin:_,domNode:S}=w.getState();return{nodeLookup:R,transform:k,snapGrid:A,snapToGrid:p,nodeOrigin:_,paneDomNode:S}},onChange:(R,k)=>{const{triggerNodeChanges:A,nodeLookup:p,parentLookup:_,nodeOrigin:S}=w.getState(),E=[],H={x:R.x,y:R.y},D=p.get(g);if(D&&D.expandParent&&D.parentId){const z=D.origin??S,L=R.width??D.measured.width??0,B=R.height??D.measured.height??0,X={id:D.id,parentId:D.parentId,rect:{width:L,height:B,...ai({x:R.x??D.position.x,y:R.y??D.position.y},{width:L,height:B},D.parentId,p,z)}},V=Jn([X],p,_,S);E.push(...V),H.x=R.x?Math.max(z[0]*L,R.x):void 0,H.y=R.y?Math.max(z[1]*B,R.y):void 0}if(H.x!==void 0&&H.y!==void 0){const z={id:g,type:"position",position:{...H}};E.push(z)}if(R.width!==void 0&&R.height!==void 0){const L={id:g,type:"dimensions",resizing:!0,setAttributes:d?d==="horizontal"?"width":"height":!0,dimensions:{width:R.width,height:R.height}};E.push(L)}for(const z of k){const L={...z,type:"position"};E.push(L)}A(E)},onEnd:({width:R,height:k})=>{const A={id:g,type:"dimensions",resizing:!1,dimensions:{width:R,height:k}};w.getState().triggerNodeChanges([A])}})),P.current.update({controlPosition:T,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:h,resizeDirection:d,onResizeStart:m,onResize:b,onResizeEnd:v,shouldResize:y}),()=>{P.current?.destroy()}},[T,a,c,l,u,h,m,b,v,y]);const j=T.split("-");return x.jsx("div",{className:re(["react-flow__resize-control","nodrag",...j,n,o]),ref:C,style:{...r,scale:$,...s&&{[N?"backgroundColor":"borderColor"]:s}},children:i})}I.memo(jg);function Og({assistants:e}){const t=(n,o)=>{n.dataTransfer.setData("application/reactflow",JSON.stringify(o)),n.dataTransfer.effectAllowed="move"};return x.jsxs("div",{className:"space-y-2",children:[x.jsx("h3",{className:"font-semibold",children:"Assistants"}),x.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag to the workflow canvas"}),x.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2",children:e.length>0?e.map(n=>x.jsxs("div",{className:"p-2 bg-muted rounded cursor-grab active:cursor-grabbing border",draggable:!0,onDragStart:o=>t(o,n),children:[x.jsx("div",{className:"font-medium",children:n.name}),n.description&&x.jsx("div",{className:"text-sm text-muted-foreground truncate",children:n.description})]},n.id)):x.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"All assistants are on the canvas."})})]})}function Bg({anchor:e,onDelete:t,onClose:n,items:o,autoFocus:r=!0}){const i=I.useRef(null),[s,a]=I.useState({top:e.y,left:e.x});I.useLayoutEffect(()=>{const u=i.current;if(!u)return;const h=u.getBoundingClientRect();let d=e.y,f=e.x;const y=4;h.height+d>window.innerHeight&&(d=Math.max(y,window.innerHeight-h.height-y)),h.width+f>window.innerWidth&&(f=Math.max(y,window.innerWidth-h.width-y)),a({top:d,left:f})},[e.x,e.y]),I.useEffect(()=>{const u=d=>{i.current&&(i.current.contains(d.target)||n())},h=d=>{d.key==="Escape"&&n()};return window.addEventListener("mousedown",u),window.addEventListener("keydown",h),()=>{window.removeEventListener("mousedown",u),window.removeEventListener("keydown",h)}},[n]),I.useEffect(()=>{r&&i.current?.focus()},[r]);const c=o??[{key:"delete",label:"Delete Node",danger:!0,onClick:t}],l=x.jsx("div",{ref:i,role:"menu",tabIndex:-1,style:{position:"fixed",top:s.top,left:s.left,zIndex:1e4,minWidth:180},className:"rounded-md border border-border bg-popover text-popover-foreground shadow-md outline-none backdrop-blur-md",children:c.map(u=>x.jsx("button",{role:"menuitem",disabled:u.disabled,onClick:()=>{u.disabled||(u.onClick(e.id),n())},className:`w-full px-4 py-2 text-left text-sm flex items-center gap-2
            ${u.danger?"text-red-600":""}
            ${u.disabled?"opacity-40 cursor-not-allowed":"hover:bg-accent hover:text-accent-foreground"}
          `,children:u.label},u.key))});return xr.createPortal(l,document.body)}function Vg({onCreateWorkflow:e}){const[t,n]=I.useState(!1),[o,r]=I.useState(""),[i,s]=I.useState(""),a=c=>{c.preventDefault(),o.trim()&&(e({name:o.trim(),description:i.trim()||void 0}),r(""),s(""),n(!1))};return x.jsxs(Na,{open:t,onOpenChange:n,children:[x.jsx(Ca,{asChild:!0,children:x.jsxs(ot,{className:"gap-2",children:[x.jsx(ja,{size:16}),"New Workflow"]})}),x.jsxs(ka,{children:[x.jsx(Ma,{children:x.jsx($a,{children:"Create New Workflow"})}),x.jsxs("form",{onSubmit:a,className:"space-y-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(ho,{htmlFor:"name",children:"Name"}),x.jsx(fo,{id:"name",value:o,onChange:c=>r(c.target.value),placeholder:"Enter workflow name",required:!0})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(ho,{htmlFor:"description",children:"Description (Optional)"}),x.jsx(fo,{id:"description",value:i,onChange:c=>s(c.target.value),placeholder:"Enter workflow description"})]}),x.jsxs("div",{className:"flex justify-end gap-2",children:[x.jsx(ot,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),x.jsx(ot,{type:"submit",children:"Create"})]})]})]})]})}const Lt={width:10,height:10,borderRadius:"50%",position:"absolute",top:"50%",transform:"translateY(-50%)",border:"2px solid #fff",boxShadow:"0 0 0 1px rgba(0,0,0,0.05)",cursor:"crosshair"},Fg=({data:e})=>{const t=!!e.isStart,n=t?"#16a34a":"#cbd5e1",o=t?"linear-gradient(145deg,#dcfce7,#f0fdf4)":"linear-gradient(145deg,#ffffff,#f1f5f9)";return x.jsxs("div",{className:"workflow-assistant-node group",style:{border:`2px solid ${n}`,background:o,width:100,height:80,padding:"16px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",position:"relative",borderRadius:18,boxShadow:t?"0 4px 14px -4px rgba(22,163,74,0.35),0 1px 0 rgba(255,255,255,0.7) inset":"0 4px 10px -2px rgba(0,0,0,0.08),0 1px 0 rgba(255,255,255,0.6) inset",fontSize:12,lineHeight:1.3,transition:"box-shadow .25s, border-color .25s, transform .25s",overflow:"hidden"},"data-start":t?"true":"false",children:[x.jsx(Me,{type:"target",position:Y.Left,id:"left-in",style:{...Lt,left:-8,background:"#64748b"}}),x.jsx(Me,{type:"source",position:Y.Left,id:"left-out",style:{...Lt,left:-8,background:"#10b981"}}),x.jsx(Me,{type:"target",position:Y.Right,id:"right-in",style:{...Lt,right:-8,background:"#64748b"}}),x.jsx(Me,{type:"source",position:Y.Right,id:"right-out",style:{...Lt,right:-8,background:"#10b981"}}),x.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[x.jsx("div",{title:e.assistantName,style:{fontWeight:600,fontSize:8,color:"#0f172a",letterSpacing:.2,marginBottom:4,maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.assistantName}),e.description&&x.jsx("div",{title:e.description,style:{fontSize:6,color:"#64748b",lineHeight:1.4,maxWidth:"100%",overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3},children:e.description})]})]})};function Yg(e,t,n,o,r=14){const i=n-e,s=o-t,a=Math.abs(i)>=Math.abs(s),c=Math.min(r,Math.abs(i)/2-2||r,Math.abs(s)/2-2||r);if(a){const l=e+i/2,u=l-c,h=l+c;return[`M ${e} ${t}`,`L ${u} ${t}`,`Q ${l} ${t} ${l} ${t+(s>0?c:-c)}`,`L ${l} ${o-(s>0?c:-c)}`,`Q ${l} ${o} ${h} ${o}`,`L ${n} ${o}`].join(" ")}else{const l=t+s/2,u=l-c,h=l+c;return[`M ${e} ${t}`,`L ${e} ${u}`,`Q ${e} ${l} ${e+(i>0?c:-c)} ${l}`,`L ${n-(i>0?c:-c)} ${l}`,`Q ${n} ${l} ${n} ${h}`,`L ${n} ${o}`].join(" ")}}const pr="#2563eb",mr="#a855f7";let yr=!1;function Xg(e){const{id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,data:s,style:a,selected:c}=e,l=s?.mode==="bidirectional"?"bidirectional":"single",u=l==="bidirectional"?mr:pr,h=l==="bidirectional"&&s?.animate!==!1,d=I.useMemo(()=>Yg(n,o,r,i,14),[n,o,r,i]),f=`m-end-${t}`,y=`m-start-${t}`;if(!yr&&typeof document<"u"){if(!document.getElementById("__global_edge_defs__")){const b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width","0"),b.setAttribute("height","0"),b.style.position="absolute",b.style.opacity="0",b.id="__global_edge_defs__",b.innerHTML=`
        <defs>
          <filter id="edge-glow" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="${mr}" flood-opacity="0.45"/>
          </filter>
          <filter id="edge-glow-blue" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="${pr}" flood-opacity="0.4"/>
          </filter>
        </defs>
      `,document.body.appendChild(b)}yr=!0}return x.jsxs("g",{className:`custom-directional-edge ${l} ${c?"selected":""}`,"data-edgeid":t,children:[x.jsxs("defs",{children:[x.jsx("marker",{id:f,viewBox:"0 0 10 10",refX:"9",refY:"5",markerWidth:"5",markerHeight:"5",orient:"auto-start-reverse",children:x.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:u})}),l==="bidirectional"&&x.jsx("marker",{id:y,viewBox:"0 0 10 10",refX:"1",refY:"5",markerWidth:"5",markerHeight:"5",orient:"auto",children:x.jsx("path",{d:"M 10 0 L 0 5 L 10 10 z",fill:u})})]}),x.jsx(St,{path:d,style:{stroke:u,strokeWidth:2.8,fill:"none",filter:c?`url(#${l==="bidirectional"?"edge-glow":"edge-glow-blue"})`:"none",...a||{}},markerEnd:`url(#${f})`,markerStart:l==="bidirectional"?`url(#${y})`:void 0,interactionWidth:24,className:h?"edge-animatable":void 0}),s?.showLabel&&x.jsx(dg,{children:x.jsx("div",{style:{position:"absolute",transform:"translate(-50%, -50%)",left:(n+r)/2,top:(o+i)/2,pointerEvents:"all",background:"rgba(17,24,39,0.75)",color:"#fff",padding:"2px 6px",fontSize:10,borderRadius:4,backdropFilter:"blur(4px)",boxShadow:"0 0 4px rgba(0,0,0,0.4)"},children:l==="bidirectional"?"bidirectional":"single"})})]})}const Wg={assistant:Fg},Zg={directional:Xg};function qg({nodes:e,edges:t,onNodesChange:n,onEdgesChange:o,onConnect:r,onNodeAdd:i,onSave:s,isSaving:a,onNodeContextMenu:c,onPaneClick:l}){const{screenToFlowPosition:u}=un(),h=I.useCallback(f=>{f.preventDefault(),f.dataTransfer.dropEffect="move"},[]),d=I.useCallback(f=>{f.preventDefault();const y=f.dataTransfer.getData("application/reactflow");if(!y)return;let m=null;try{m=JSON.parse(y)}catch{return}if(!m)return;const b=u({x:f.clientX,y:f.clientY}),v={id:m.id,type:"assistant",position:b,data:{assistantId:m.id,assistantName:m.name,description:m.description}};i(v)},[u,i]);return x.jsx("div",{className:"h-full border rounded-lg relative",children:x.jsxs(lg,{nodes:e,edges:t,nodeTypes:Wg,edgeTypes:Zg,onNodesChange:n,onEdgesChange:o,onConnect:r,onDrop:d,onDragOver:h,onNodeContextMenu:c,onPaneClick:l,fitView:!0,panOnScroll:!0,selectionOnDrag:!0,panOnDrag:[1,2],zoomOnPinch:!0,children:[x.jsx(Sg,{position:"top-left"}),x.jsx(zg,{pannable:!0,zoomable:!0,style:{background:"#f8fafc",border:"1px solid #e2e8f0"},nodeColor:f=>f.data?.isStart?"#16a34a":"#3b82f6"}),x.jsx(mg,{id:"dots",variant:_e.Dots,gap:18,size:1.4,color:"#cbd5e1"}),x.jsx(_t,{position:"top-right",children:x.jsxs(ot,{onClick:s,disabled:a,className:"gap-2",children:[x.jsx(Ia,{size:16}),a?"Saving...":"Save Workflow"]})})]})})}function Gg({workflows:e,selectedWorkflow:t,onSelect:n,onDelete:o}){return x.jsxs("div",{children:[x.jsx("h3",{className:"mb-2 font-semibold",children:"Workflows"}),e.length===0?x.jsx(wr,{title:"No workflows",description:"Create your first workflow to get started"}):x.jsx("div",{className:"max-h-[300px] space-y-2 overflow-y-auto",children:e.map(r=>x.jsx("div",{className:`hover:bg-muted cursor-pointer rounded border p-3 ${t?.id===r.id?"bg-primary/10 border-primary":""}`,onClick:()=>n(r),children:x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{children:[x.jsx("div",{className:"font-medium",children:r.name}),r.description&&x.jsx("div",{className:"text-muted-foreground text-sm",children:r.description})]}),x.jsxs(Aa,{children:[x.jsx(Da,{asChild:!0,children:x.jsx(ot,{variant:"ghost",size:"sm",className:"h-auto p-1",onClick:i=>i.stopPropagation(),children:x.jsx(Ba,{size:14})})}),x.jsxs(Pa,{children:[x.jsx(Ta,{children:"Delete Workflow"}),x.jsxs(Ha,{children:['Are you sure you want to delete "',r.name,'"? This action cannot be undone.']}),x.jsxs("div",{className:"flex justify-end gap-2",children:[x.jsx(za,{children:"Cancel"}),x.jsx(La,{onClick:()=>o(r.id),children:"Delete"})]})]})]})]})},r.id))})]})}function Kg(){const e=fa(),[t,n]=I.useState(null),o=I.useRef(null),[r,i]=I.useState(null),[s,a]=I.useState([]),[c,l]=I.useState([]),u=uo({queryKey:["workflows"],queryFn:async()=>await ya()??[]}),h=uo({queryKey:["assistants"],queryFn:async()=>await xa()??[]}),d=u.data||[],f=h.data||[];I.useEffect(()=>{if(t){const k=structuredClone(t.nodes??[]);let A=!1;const p=k.map(_=>_.type==="start"||_.data?.isStart?(A=!0,{..._,type:"assistant",data:{..._.data||{},isStart:!0}}):{..._,type:"assistant",data:{..._.data||{},isStart:_.data?.isStart===!0}});!A&&p.length>0&&(p[0].data.isStart=!0),a(p),l(structuredClone(t.edges??[]))}else a([]),l([])},[t]);const y=pn({mutationFn:({name:k,description:A})=>ga(k,A),onSuccess:k=>{ue.success("Workflow created"),e.invalidateQueries({queryKey:["workflows"]}),n(k)},onError:k=>ue.error(`Failed to create workflow: ${k.message}`)}),m=pn({mutationFn:ma,onSuccess:()=>{ue.success("Workflow saved"),e.invalidateQueries({queryKey:["workflows"]})},onError:k=>ue.error(`Failed to save workflow: ${k.message}`)}),b=I.useCallback(k=>{a(A=>{if(A.some(S=>S.id===k.id))return ue.warning("Assistant is already in the workflow."),A;const p=A.length===0,_={...k,type:"assistant",data:{...k.data||{},isStart:p}};return[...A,_]})},[]),v=I.useCallback(k=>{a(A=>A.some(p=>p.id===k)?A.map(p=>({...p,data:{...p.data||{},isStart:p.id===k}})):A)},[]),M=I.useCallback((k,A)=>{k.preventDefault(),i({id:A.id,x:k.clientX,y:k.clientY})},[]),g=k=>{if(s.find(p=>p.id===k)?.data?.isStart){ue.warning("The Start node cannot be deleted."),i(null);return}a(p=>p.filter(_=>_.id!==k)),l(p=>p.filter(_=>_.source!==k&&_.target!==k)),i(null)},w=I.useCallback(()=>i(null),[]),C=pn({mutationFn:pa,onSuccess:()=>{ue.success("Workflow deleted"),e.invalidateQueries({queryKey:["workflows"]}),n(null)},onError:k=>ue.error(`Failed to delete workflow: ${k.message}`)}),N=I.useCallback(k=>{if(k.filter(p=>p.type==="remove"&&s.find(_=>_.id===p.id)?.data?.isStart).length>0){ue.warning("The Start node cannot be deleted.");return}a(p=>Di(k,p))},[s]),$=I.useCallback(k=>{console.log("onEdgesChange triggered. Changes:",k),l(A=>{console.log("Edges before applying changes:",A);const p=Pi(k,A);return console.log("Edges after applying changes:",p),p})},[l]),P=I.useCallback(k=>{const{source:A,target:p}=k;!A||!p||A!==p&&l(_=>{const S=_.find(E=>E.source===A&&E.target===p||E.source===p&&E.target===A);if(!S){const E={id:`e-${A}->${p}`,source:A,target:p,sourceHandle:k.sourceHandle,targetHandle:k.targetHandle,type:"directional",data:{mode:"single"}};return gi(E,_)}return S.source===A&&S.target===p?S.data?.mode==="bidirectional"?(ue.warning("This pair is already bidirectional."),_):(ue.warning("A connection in this direction already exists."),_):S.data?.mode!=="bidirectional"?_.map(E=>E.id===S.id?{...E,data:{...E.data||{},mode:"bidirectional"}}:E):_})},[s,c]),T=()=>{t&&m.mutate({...t,nodes:s,edges:c})},j=I.useMemo(()=>{const k=new Set(s.map(A=>A.data?.assistantId).filter(Boolean));return f.filter(A=>!k.has(A.id))},[f,s]),R=I.useMemo(()=>{if(!r)return[];const A=s.find(p=>p.id===r.id)?.data?.isStart;return[{key:"set-start",label:A?"Already Start Node":"Set as Start Node",disabled:!!A,onClick:p=>v(p)},{key:"delete",label:"Delete Node",danger:!0,disabled:A,onClick:g}]},[r,s,v]);return u.isLoading||h.isLoading?x.jsx(ha,{lines:5}):u.error||h.error?x.jsx("div",{className:"text-red-600",children:"Failed to load data."}):x.jsxs(x.Fragment,{children:[x.jsxs(wa,{children:[x.jsx(va,{}),x.jsxs("div",{className:"ms-auto flex items-center gap-4",children:[x.jsx(ba,{}),x.jsx(_a,{}),x.jsx(Sa,{})]})]}),x.jsx(Ea,{fixed:!0,children:x.jsxs(rs,{children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Workflows"}),x.jsx("p",{className:"text-muted-foreground",children:"Design and manage task handoff workflows between assistants"})]}),x.jsxs("div",{className:"mt-4 flex min-h-0 w-full flex-1 gap-8 px-4 md:px-8",children:[x.jsxs("aside",{className:"flex w-full max-w-3xs flex-shrink-0 flex-col gap-6",children:[x.jsx(Vg,{onCreateWorkflow:y.mutate}),x.jsx(Gg,{workflows:d,selectedWorkflow:t,onSelect:n,onDelete:C.mutate}),x.jsx(Og,{assistants:j})]}),x.jsx("main",{className:"min-h-0 flex-1",children:t?x.jsxs("div",{className:"flex h-full flex-col gap-4",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-xl font-semibold",children:t.name}),t.description&&x.jsx("p",{className:"text-muted-foreground",children:t.description})]}),x.jsx("div",{ref:o,className:"min-h-0 flex-1",children:x.jsx(qg,{nodes:s,edges:c,onNodesChange:N,onEdgesChange:$,onConnect:P,onNodeAdd:b,onSave:T,isSaving:m.isPending,onPaneClick:w,onNodeContextMenu:M},t.id)})]}):x.jsx(wr,{title:"No workflow selected",description:"Select a workflow from the list or create a new one to start designing"})})]}),r&&x.jsx(Bg,{anchor:r,onDelete:g,onClose:()=>i(null),items:R})]})})]})}const _p=Kg;export{_p as component};
