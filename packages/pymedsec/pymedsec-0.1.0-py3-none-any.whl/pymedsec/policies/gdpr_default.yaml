schema_version: '1.0'
name: 'GDPR Default Policy'
description: 'Default policy for GDPR compliance in healthcare image processing'

sanitization:
  dicom:
    remove_private_tags: true
    regenerate_uids: true
    preserve_technical_tags: true
    burned_in_annotation_policy: 'strict'

  exif:
    strip_all_metadata: true
    preserve_orientation: false

  ocr:
    enabled: true # Required for thorough pseudonymization
    confidence_threshold: 50
    redaction_method: 'blackout'

encryption:
  algorithm: 'AES-256-GCM'
  key_rotation_days: 90
  require_kms: true
  nonce_size_bits: 96

security:
  allow_plaintext_disk: false
  require_policy_match: true # Stricter than HIPAA
  require_integrity_verification: true
  max_batch_size: 16 # Smaller batches for better control
  require_tee: false

audit:
  log_all_operations: true
  include_file_hashes: true
  retention_days: 2557 # Configurable per use case
  hmac_secret_rotation_days: 180 # More frequent rotation
  rolling_anchor_interval: 500

compliance:
  hipaa_mode: false
  gdpr_mode: true
  gxp_mode: false
  purpose_limitation: 'specified_purpose_only'
  data_minimization: true
  allowed_purposes:
    - 'medical_research'
    - 'public_health'
    - 'scientific_research'

gdpr_specific:
  # Article 6 - Lawfulness of processing
  lawful_basis: 'consent' # consent, legitimate_interest, vital_interest, etc.

  # Article 9 - Special categories (health data)
  special_category_basis: 'explicit_consent'

  # Article 25 - Data protection by design and by default
  data_protection_by_design: true
  data_protection_by_default: true

  # Article 32 - Security of processing
  pseudonymisation_required: true
  encryption_required: true
  resilience_required: true

  # Rights management
  right_to_erasure_support: true # Technical capability to delete
  right_to_rectification_support: true
  right_to_portability_support: true

  # Data transfer controls
  restrict_third_country_transfer: true
  adequacy_decision_required: false

  # Breach notification
  breach_detection_enabled: true
  breach_notification_required: true

  # Record keeping (Article 30)
  processing_records_required: true

data_subject_rights:
  access_request_support: true
  rectification_request_support: true
  erasure_request_support: true
  restriction_request_support: true
  portability_request_support: true
  objection_request_support: true
