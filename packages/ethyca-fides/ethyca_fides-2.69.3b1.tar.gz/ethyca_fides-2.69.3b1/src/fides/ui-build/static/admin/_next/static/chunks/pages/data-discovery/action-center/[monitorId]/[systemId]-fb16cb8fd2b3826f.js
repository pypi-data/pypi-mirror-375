(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,r=null==e?0:e.length;++n<r;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),r=s(1129),a=s(58263);e.exports=function(e,t,s){return t==t?a(e,t,s):n(e,r,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),r=s(58095),a=s(21796),o=s(65581),i=s(47111),l=s(43735);e.exports=function(e,t,s){var d=-1,c=r,u=e.length,m=!0,y=[],v=y;if(s)m=!1,c=a;else if(u>=200){var g=t?null:i(e);if(g)return l(g);m=!1,c=o,v=new n}else v=t?[]:y;e:for(;++d<u;){var p=e[d],h=t?t(p):p;if(p=s||0!==p?p:0,m&&h==h){for(var f=v.length;f--;)if(v[f]===h)continue e;t&&v.push(h),y.push(p)}else c(v,h,s)||(v!==y&&v.push(h),y.push(p))}return y}},47111:function(e,t,s){var n=s(46151),r=s(50344),a=s(43735),o=n&&1/a(new n([,-0]))[1]==1/0?function(e){return new n(e)}:r;e.exports=o},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,r=e.length;++n<r;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},25654:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return s(74473)}])},79283:function(e,t,s){"use strict";s.d(t,{l:function(){return l}});var n=s(24246),r=s(96306),a=s(72707),o=s.n(a);let i=e=>{let{data:{formattedTitle:t,description:s,name:a,primaryName:o}}=e;return(0,n.jsxs)(r.jqI,{gap:12,title:"".concat(t," - ").concat(s),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:o||a}),o&&": ".concat(a)]}),(0,n.jsx)("em",{children:s})]})},l=e=>{let{options:t,...s}=e,a=null==t?void 0:t.map(e=>({...e,className:o().option,formattedTitle:[e.primaryName,e.name].filter(e=>e).join(": ")}));return(0,n.jsx)(r.WPr,{options:a,filterOption:(e,t)=>(null==t?void 0:t.formattedTitle.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:t.value.toLowerCase().includes(e.toLowerCase()))||!1,optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:i,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...s})}},45938:function(e,t,s){"use strict";s.d(t,{Gt:function(){return m},eB:function(){return y},oI:function(){return u}});var n=s(24246),r=s(34090),a=s(27378),o=s(16134),i=s(38602),l=s(58452);let d=(0,a.createRef)(),c=(0,a.createRef)(),u=()=>{let e=(0,o.T)(),t=(0,o.C)(i.DB),s=(0,a.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,a.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!0),s())},[e,s]),r=(0,a.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,a.useCallback)(()=>t?(e((0,i.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:r}},m=e=>{let{id:t,name:s}=e,{dirty:n}=(0,r.u6)(),l=(0,o.T)();return(0,a.useEffect)(()=>(l((0,i.Zu)({id:t,name:s})),()=>{l((0,i.dz)({id:t}))}),[l,t,s]),(0,a.useEffect)(()=>{l((0,i.$p)({id:t,isDirty:n}))},[n,l,t]),null},y=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,o.C)(i.uv);return(0,n.jsx)(l.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},25415:function(e,t,s){"use strict";s.d(t,{a:function(){return a}});var n=s(24246);let{Text:r}=s(96306).AntTypography,a=e=>{let{count:t}=e;return(0,n.jsx)(r,{size:"sm",strong:!0,"data-testid":"selected-count",children:"".concat(t," selected")})}},54762:function(e,t,s){"use strict";s.d(t,{l:function(){return i}});var n=s(24246),r=s(96306),a=s(62165),o=s(21910);let i=e=>{let{consentStatus:t}=e,{flags:s}=(0,a.hz)(),{assetConsentStatusLabels:i}=s;return i&&(null==t?void 0:t.status)===o.pF.ALERT?(0,n.jsx)(r.esZ,{title:null==t?void 0:t.message,"data-testid":"discovery-status-icon-alert-tooltip",children:(0,n.jsx)("div",{className:"mb-px","data-testid":"discovery-status-icon-alert",children:(0,n.jsx)(r.PJP.OdJ,{style:{color:"var(--fidesui-error)"}})})}):null}},9320:function(e,t,s){"use strict";s.d(t,{_:function(){return a}});var n=s(24246),r=s(26089);let a=(e,t)=>(0,n.jsxs)(n.Fragment,{children:[e," ",t&&(0,n.jsx)(r.Z,{onClick:t,children:"View"})]})},37059:function(e,t,s){"use strict";s.d(t,{Ak:function(){return p},EY:function(){return m},Tj:function(){return v},Ud:function(){return i},Vr:function(){return h},WJ:function(){return d},mi:function(){return f},nP:function(){return u},nS:function(){return y},rs:function(){return c},sX:function(){return g},ut:function(){return _},wi:function(){return l}});var n=s(78780),r=s(16394),a=s(21910),o=s(98145);let{useGetAggregateMonitorResultsQuery:i,useGetDiscoveredSystemAggregateQuery:l,useGetDiscoveredAssetsQuery:d,useAddMonitorResultSystemsMutation:c,useIgnoreMonitorResultSystemsMutation:u,useAddMonitorResultAssetsMutation:m,useIgnoreMonitorResultAssetsMutation:y,useRestoreMonitorResultAssetsMutation:v,useUpdateAssetsSystemMutation:g,useUpdateAssetsDataUseMutation:p,useUpdateAssetsMutation:h,useGetConsentBreakdownQuery:f,useGetWebsiteMonitorResourceFiltersQuery:_}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:s=20,search:n}=e;return{url:"/plus/discovery-monitor/aggregate-results",params:{page:t,size:s,search:n,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,page:s=1,size:n=20,search:r,diff_status:a}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,page:s,size:n,search:r,diff_status:a}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:s,page:n=1,size:i=20,search:l,diff_status:d=[a.LL.ADDITION],sort_by:c=[o.r6.CONSENT_AGGREGATED,"urn"],sort_asc:u=!0,resource_type:m,data_uses:y,locations:v,consent_aggregated:g}=e,p=Array.isArray(c)?c:[c],h=(0,r.$J)({sort_by:p,resource_type:m,data_uses:y,locations:v,consent_aggregated:g});return{url:"/plus/discovery-monitor/".concat(t,"/results?").concat(h.toString()),params:{resolved_system_id:s,page:n,size:i,search:l,diff_status:d,sort_asc:u}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,r.du)(s,"resolved_system_ids");return{url:"/plus/discovery-monitor/".concat(t,"/promote"),method:"POST",params:n?new URLSearchParams(n):new URLSearchParams}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,r.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),restoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams({status_to_set:a.LL.ADDITION});return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/un-mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]}),getConsentBreakdown:e.query({query:e=>{let{stagedResourceUrn:t,status:s,page:n=1,size:r=20}=e;return{url:"/plus/discovery-monitor/staged_resource/".concat(encodeURIComponent(t),"/consent"),params:{status:s,page:n,size:r}}}}),getWebsiteMonitorResourceFilters:e.query({query:e=>{let{monitor_config_id:t,resolved_system_id:s,diff_status:n=[a.LL.ADDITION],search:o,resource_type:i,data_uses:l,locations:d,consent_aggregated:c}=e,u={monitor_config_id:t,resolved_system_id:s,diff_status:n};o&&(u.search=o);let m=(0,r.$J)({resource_type:i,data_uses:l,locations:d,consent_aggregated:c}).toString();return{url:m?"/plus/filters/website_monitor_resources?".concat(m):"/plus/filters/website_monitor_resources",params:u}},providesTags:["Discovery Monitor Results"]})})})},98145:function(e,t,s){"use strict";var n,r,a,o,i,l,d,c;s.d(t,{EI:function(){return o},X1:function(){return n},r6:function(){return r},vQ:function(){return a}}),(i=n||(n={})).WITH_CONSENT="With consent",i.WITHOUT_CONSENT="Without consent",i.EXEMPT="Exempt",i.UNKNOWN="Unknown",(l=r||(r={})).NAME="name",l.RESOURCE_TYPE="resource_type",l.SYSTEM="system",l.DATA_USES="data_uses",l.LOCATIONS="locations",l.DOMAIN="domain",l.PAGE="page",l.CONSENT_AGGREGATED="consent_aggregated",l.ACTIONS="actions",(d=a||(a={})).SYSTEM_NAME="system_name",d.TOTAL_UPDATES="total_updates",d.DATA_USE="data_use",d.LOCATIONS="locations",d.DOMAINS="domains",d.ACTIONS="actions",(c=o||(o={})).LOCATION="location",c.PAGE="page"},88708:function(e,t,s){"use strict";s.d(t,{A:function(){return r}});var n,r,a=s(27378),o=s(14908),i=s(21910);(n=r||(r={})).ATTENTION_REQUIRED="attention-required",n.RECENT_ACTIVITY="recent-activity",n.IGNORED="ignored",t.Z=e=>{let{activeTab:t,onTabChange:s}=(0,o.Z)({tabKeys:Object.values(r)}),n=(0,a.useMemo)(()=>[{label:"Attention required",params:{diff_status:[i.LL.ADDITION],system:e},hash:"attention-required"},{label:"Recent activity",params:{diff_status:[i.LL.MONITORED]},hash:"recent-activity"},{label:"Ignored",params:{diff_status:[i.LL.MUTED],system:e},hash:"ignored"}],[e]),{diff_status:l,system:d}=(0,a.useMemo)(()=>{var e;return null!==(e=n.find(e=>e.hash===t))&&void 0!==e?e:n[0]},[n,t]).params,c=(0,a.useMemo)(()=>l.includes(i.LL.MONITORED),[l]);return{filterTabs:n,activeTab:t,onTabChange:s,activeParams:(0,a.useMemo)(()=>e?{diff_status:l,system:d}:{diff_status:l},[e,l,d]),actionsDisabled:c}}},78238:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});let n=["essential","functional.service.improve","personalize","analytics","marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"];t.Z=e=>n.includes(e)},74473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return en}});var n=s(24246),r=s(86677),a=s(27378),o=s(35287),i=s(77830),l=s(58754),d=s(96306),c=s(25415),u=s(21910),m=s(30952),y=s(8133),v=s(79283),g=s(34929),p=s(78238),h=e=>{let{selectedTaxonomies:t,...s}=e,{getDataUseDisplayNameProps:r,getDataUses:a}=(0,g.Z)(),o=a().filter(e=>e.active&&p.g.includes(e.fides_key)).map(e=>{let{name:t,primaryName:s}=r(e.fides_key);return{value:e.fides_key,name:t,primaryName:s,description:e.description||""}});return(0,n.jsx)(v.l,{options:o,...s})};let{Text:f}=d.AntTypography;var _=e=>{let{onSave:t,isSaving:s,onClose:r,...o}=e,[i,l]=(0,a.useState)([]),c=()=>{l([]),r()};return(0,n.jsxs)(y.Z,{title:"Add consent category",...o,onClose:c,children:[(0,n.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(f,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(h,{mode:"tags",selectedTaxonomies:i,onSelect:(e,t)=>l([...i,t.value]),variant:"outlined"})]}),(0,n.jsxs)(d.jqI,{justify:"space-between",children:[(0,n.jsx)(d.wpx,{htmlType:"reset",onClick:c,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!i.length,loading:s,onClick:()=>{t(i),c()},"data-testid":"save-btn",children:"Save"})]})]})},x=s(29850),T=s(77685);let{Text:j}=d.AntTypography,C=e=>{let{onSave:t,isSaving:s,...r}=e,[o,i]=(0,a.useState)(),[l,c]=(0,a.useState)(!1),u=(0,a.useCallback)(e=>{e.preventDefault(),c(!0)},[]),m=()=>{c(!1)},v=()=>{i(void 0),r.onClose()};return(0,n.jsxs)(y.Z,{title:"Assign system",...r,onClose:v,children:[(0,n.jsxs)(d.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(j,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(x.R,{placeholder:"Search or select...",onSelect:(e,t)=>{i(t)},onAddSystem:u,value:o})]})," ",(0,n.jsxs)(d.jqI,{justify:"space-between",children:[(0,n.jsx)(d.wpx,{htmlType:"reset",onClick:v,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(d.wpx,{htmlType:"submit",type:"primary",disabled:!o,loading:s,onClick:()=>{t(o),v()},"data-testid":"save-btn",children:"Save"})]}),l&&(0,n.jsx)(T.i,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),i({label:t,value:e})},toastOnSuccess:!0})]})};var S=s(8411),b=s(32735),E=s(8125),A=s(37059),w=s(98145);let{Link:k}=d.AntTypography,N=e=>{let{stagedResource:t,status:s}=e,r=(0,E.o)({pagination:{defaultPageSize:10,pageSizeOptions:[10,...b.VZ]}}),{pageIndex:o,pageSize:i}=r,{data:l,isFetching:d,isError:c}=(0,A.mi)({stagedResourceUrn:t.urn,status:s,page:o,size:i}),{items:u,total:m}=(0,a.useMemo)(()=>l||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[l]),y=(0,a.useMemo)(()=>({enableSelection:!1,getRowKey:e=>e.location,isLoading:d,dataSource:u,totalRows:null!=m?m:0}),[d,u,m]),v=(0,E.V)(r,y);return{columns:(0,a.useMemo)(()=>[{title:"Location",dataIndex:w.EI.LOCATION,key:w.EI.LOCATION,render:e=>{var t;return null!==(t=S.Z8[e])&&void 0!==t?t:e}},{title:"Page",dataIndex:w.EI.PAGE,key:w.EI.PAGE,render:e=>(0,n.jsx)(k,{href:e,target:"_blank",rel:"noopener noreferrer",children:e})}],[]),data:l,isLoading:d,isError:c,totalRows:m,tableProps:v.tableProps,hasData:u.length>0}},{Paragraph:I,Text:O}=d.AntTypography,D=e=>{var t,s,r;let{isOpen:a,stagedResource:o,status:i,onCancel:l,onDownload:c}=e,{columns:u,tableProps:m,isError:y}=N({stagedResource:o,status:i});return(0,n.jsx)(d.$zI,{title:"Consent discovery",width:768,open:a,onCancel:l,footer:[(0,n.jsx)(d.wpx,{onClick:l,children:"Cancel"},"cancel"),!!c&&(0,n.jsx)(d.wpx,{type:"primary",onClick:c,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,n.jsxs)(d.jqI,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(I,{children:"View all instances where this asset was detected without consent, organized by location and page. Use this to investigate potential compliance issues."}),(0,n.jsxs)(I,{children:[(0,n.jsx)(O,{strong:!0,children:"Asset name:"})," ",null!==(t=o.name)&&void 0!==t?t:(0,n.jsx)(O,{italic:!0,children:"Unknown"}),","," ",(0,n.jsx)(O,{strong:!0,children:"System:"})," ",null!==(s=o.system)&&void 0!==s?s:(0,n.jsx)(O,{italic:!0,children:"Unassigned"}),","," ",(0,n.jsx)(O,{strong:!0,children:"Domain:"})," ",null!==(r=o.domain)&&void 0!==r?r:(0,n.jsx)(O,{italic:!0,children:"Unknown"})]})]}),y?(0,n.jsx)(d.DUx,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,n.jsx)(d.V5H,{...m,columns:u,"data-testid":"consent-breakdown-modal-table"})]})})};var R=s(83766),L=s.n(R),P=s(62165),M=s(812),U=s(26070),G=s(3110),q=s(46628),Z=s(16394),V=s(54762),W=s(9320),z=s(88708);let Y=e=>{let{asset:t,onTabChange:s}=e,[a,{isLoading:o}]=(0,A.EY)(),[l,{isLoading:c}]=(0,A.nS)(),[m,{isLoading:y}]=(0,A.Tj)(),v=(0,d.pmc)(),g=(0,r.useRouter)(),p=o||c||y,{urn:h,name:f,resource_type:_,diff_status:x,system_key:T,user_assigned_system_key:j}=t,C=async()=>{let e=await a({urnList:[h]});if((0,M.D4)(e))v((0,q.Vo)((0,M.e$)(e.error)));else{let e=j||T,t="".concat(i.So,"/configure/").concat(e,"#assets");v((0,q.t5)((0,W._)("".concat(_,' "').concat(f,'" has been added to the system inventory.'),e?()=>g.push(t):void 0)))}},S=async()=>{let e=await l({urnList:[h]});(0,M.D4)(e)?v((0,q.Vo)((0,M.e$)(e.error))):v((0,q.t5)((0,W._)("".concat(_,' "').concat(f,'" has been ignored and will not appear in future scans.'),async()=>{await s(z.A.IGNORED)})))},b=async()=>{let e=await m({urnList:[h]});(0,M.D4)(e)?v((0,q.Vo)((0,M.e$)(e.error))):v((0,q.t5)("".concat(_,' "').concat(f,'" is no longer ignored and will appear in future scans.')))};return(0,n.jsxs)(d.vyj,{children:[x!==u.LL.MUTED&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(d.wpx,{"data-testid":"add-btn",size:"small",onClick:C,disabled:!t.system||p,loading:o,children:"Add"})}),(0,n.jsx)(d.wpx,{"data-testid":"ignore-btn",size:"small",onClick:S,disabled:p,loading:c,children:"Ignore"})]}),x===u.LL.MUTED&&(0,n.jsx)(d.wpx,{"data-testid":"restore-btn",size:"small",onClick:b,disabled:p,loading:y,children:"Restore"})]})};var K=s(41841),X=s(18992),$=s.n(X),B=s(2525),H=s(31883),F=e=>{var t,s,r;let{asset:o,readonly:i,columnState:l}=e,[c,u]=(0,a.useState)(!1),[m]=(0,A.Ak)(),{successAlert:y,errorAlert:v}=(0,K.VY)(),{getDataUseDisplayName:f}=(0,g.Z)(),_=(null===(t=o.user_assigned_data_uses)||void 0===t?void 0:t.length)?o.user_assigned_data_uses:(null===(s=o.data_uses)||void 0===s?void 0:s.length)?o.data_uses:[],x=async e=>{let t=await m({monitorId:o.monitor_config_id,urnList:[o.urn],dataUses:[..._,e]});(0,H.D4)(t)?v((0,M.e$)(t.error)):y("Consent category added to ".concat(o.resource_type,' "').concat(o.name,'" .'),"Confirmed"),u(!1)},T=async e=>{let t=await m({monitorId:o.monitor_config_id,urnList:[o.urn],dataUses:_.filter(t=>t!==e)});(0,H.D4)(t)?v((0,M.e$)(t.error)):y("Consent category removed from ".concat(o.resource_type,' "').concat(o.name,'".'),"Confirmed")},j=(null===(r=o.user_assigned_data_uses)||void 0===r?void 0:r.length)?o.user_assigned_data_uses:o.data_uses,C=null==j?void 0:j.filter(e=>(0,p.Z)(e));return i?(0,n.jsx)(B.Q,{values:null==C?void 0:C.map(e=>({label:f(e),key:e})),columnState:l}):(0,n.jsxs)(n.Fragment,{children:[!c&&(0,n.jsxs)(d.vyj,{align:"start",children:[(0,n.jsx)(d.j8w,{onClick:()=>u(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"}),(0,n.jsx)(B.Q,{values:null==C?void 0:C.map(e=>({label:f(e),key:e})),columnState:l,tagProps:{closable:!0,closeButtonLabel:"Remove data use"},onTagClose:T})]}),c&&(0,n.jsx)("div",{className:$().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,n.jsx)(h,{selectedTaxonomies:C||[],onSelect:x,onBlur:()=>u(!1),open:!0})})]})};let J=e=>{let{consentAggregated:t,stagedResource:s,onShowBreakdown:r}=e;return(0,n.jsxs)(n.Fragment,{children:[t===u.lg.WITHOUT_CONSENT&&(0,n.jsx)(d.esZ,{title:"Asset was detected before the user gave consent or without any consent. Click the info icon for more details.",children:(0,n.jsx)(d.j8w,{color:"error",closeIcon:(0,n.jsx)(d.PJP.daM,{style:{width:12,height:12}}),closeButtonLabel:"View details",onClose:()=>{null==r||r(s,t)},"data-testid":"status-badge_without-consent",children:w.X1.WITHOUT_CONSENT})}),t===u.lg.WITH_CONSENT&&(0,n.jsx)(d.esZ,{title:"Asset was detected after the user gave consent",children:(0,n.jsx)(d.j8w,{color:"success","data-testid":"status-badge_with-consent",children:w.X1.WITH_CONSENT})}),t===u.lg.EXEMPT&&(0,n.jsx)(d.esZ,{title:"Asset is valid regardless of consent",children:(0,n.jsx)(d.j8w,{"data-testid":"status-badge_consent-exempt",children:w.X1.EXEMPT})}),t===u.lg.UNKNOWN&&(0,n.jsx)(d.esZ,{title:"Did not find consent information for this asset. You may need to re-run the monitor.",children:(0,n.jsx)(d.j8w,{"data-testid":"status-badge_unknown",children:w.X1.UNKNOWN})})]})};var Q=s(70675);let ee=e=>{let{aggregateSystem:t,monitorConfigId:s,readonly:r}=e,{resource_type:o,name:i,urn:l,system:c,user_assigned_system_key:u,system_key:m}=t,[y,v]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),[h,{isLoading:f}]=(0,Q.NA)(),{successAlert:_,errorAlert:j}=(0,K.VY)(),C=(0,a.useCallback)(e=>{e.preventDefault(),p(!0)},[]),S=async(e,t,n)=>{let r=await h({staged_resource_urn:l,monitor_config_id:s,user_assigned_system_key:e});(0,M.D4)(r)?j((0,M.e$)(r.error)):_(n?"".concat(t," has been added to your system inventory and the ").concat(o,' "').concat(i,'" has been assigned to that system.'):"".concat(o,' "').concat(i,'" has been assigned to ').concat(t,"."),"Confirmed"),v(!1)};return r?c?(0,n.jsx)(d.j8w,{"data-testid":"system-badge",color:"white",children:c}):null:(0,n.jsxs)(n.Fragment,{children:[!y&&(c?(0,n.jsxs)(d.j8w,{onClick:()=>v(!0),"data-testid":"system-badge",children:[c,(0,n.jsx)(d.PJP.I8b,{})]}):(0,n.jsx)(d.j8w,{onClick:()=>v(!0),"data-testid":"add-system-btn",addable:!0})),!!y&&(0,n.jsx)("div",{className:$().cellBleed,children:(0,n.jsx)(x.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:u||m,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&v(!1)},onAddSystem:C,onSelect:(e,t)=>S(e,t.label),loading:f})}),g&&(0,n.jsx)(T.i,{isOpen:!0,onClose:()=>{p(!1)},onSuccessfulSubmit:(e,t)=>S(e,t,!0)})]})},et=e=>{let{monitorId:t,systemId:s,onSystemName:o,onShowBreakdown:l}=e,c=(0,r.useRouter)(),m=(0,d.pmc)(),[y,v]=(0,a.useState)(s),[g,h]=(0,a.useState)(),[f,_]=(0,a.useState)(!1),[x,T]=(0,a.useState)(!1),[j,C]=(0,a.useState)(!1),[b,k]=(0,a.useState)(0),[N,I]=(0,a.useState)(0),[O,D]=(0,a.useState)(0),{flags:R}=(0,P.hz)(),{assetConsentStatusLabels:K}=R,{filterTabs:X,activeTab:$,onTabChange:B,activeParams:H,actionsDisabled:Q}=(0,z.Z)(s),et=(0,E.o)({sorting:{validColumns:Object.values(w.r6)}}),{columnFilters:es,pageIndex:en,pageSize:er,resetState:ea,sortKey:eo,sortOrder:ei,searchQuery:el,updateSearch:ed,updateFilters:ec,updateSorting:eu,updatePageIndex:em,updatePageSize:ey}=et,{data:ev,isLoading:eg,isFetching:ep}=(0,A.WJ)({key:t,page:en,size:er,search:el,sort_by:eo?[eo]:[w.r6.CONSENT_AGGREGATED,"urn"],sort_asc:"descend"!==ei,...H,...es}),[eh,{isLoading:ef}]=(0,A.EY)(),[e_,{isLoading:ex}]=(0,A.nS)(),[eT,{isLoading:ej}]=(0,A.rs)(),[eC,{isLoading:eS}]=(0,A.sX)(),[eb,{isLoading:eE}]=(0,A.Vr)(),[eA,{isLoading:ew}]=(0,A.Tj)(),ek=ef||ex||ej||eS||ew||eE,eN=ek||s===i.Kl,{data:eI}=(0,A.ut)({monitor_config_id:t,resolved_system_id:s,diff_status:null==H?void 0:H.diff_status,search:el,...es}),eO=(0,a.useMemo)(()=>({enableSelection:$!==z.A.RECENT_ACTIVITY,getRowKey:e=>e.urn,isLoading:eg,isFetching:ep,dataSource:(null==ev?void 0:ev.items)||[],totalRows:(null==ev?void 0:ev.total)||0,customTableProps:{locale:{emptyText:(0,n.jsx)("div",{children:(0,n.jsx)("div",{children:"All caught up!"})})}}}),[$,eg,ep,null==ev?void 0:ev.items,null==ev?void 0:ev.total]),eD=(0,E.V)(et,eO),eR=(0,a.useMemo)(()=>{var e;let t=[{title:"Asset",dataIndex:w.r6.NAME,key:w.r6.NAME,sorter:!0,sortOrder:eo===w.r6.NAME?ei:null,render:e=>(0,n.jsx)(d.lKn,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left"},{title:"Type",dataIndex:w.r6.RESOURCE_TYPE,key:w.r6.RESOURCE_TYPE,sorter:!0,sortOrder:eo===w.r6.RESOURCE_TYPE?ei:null,filters:(0,Z.nZ)(null==eI?void 0:eI.resource_type),filteredValue:(null==es?void 0:es.resource_type)||null},{title:"System",dataIndex:w.r6.SYSTEM,key:w.r6.SYSTEM,render:(e,t)=>!!t.monitor_config_id&&(0,n.jsx)(ee,{aggregateSystem:t,monitorConfigId:t.monitor_config_id,readonly:Q||$===z.A.IGNORED})},{title:"Categories of consent",key:w.r6.DATA_USES,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(C(!0),D(e=>e+1)):"collapse-all"===e.key&&(C(!1),D(e=>e+1))}},filters:(0,Z.nZ)(null==eI?void 0:null===(e=eI.data_uses)||void 0===e?void 0:e.filter(e=>(0,p.Z)(e))),filteredValue:(null==es?void 0:es.data_uses)||null,render:(e,t)=>(0,n.jsx)(F,{asset:t,readonly:Q||$===z.A.IGNORED,columnState:{isExpanded:j,version:O}})},{title:"Locations",dataIndex:w.r6.LOCATIONS,key:w.r6.LOCATIONS,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(_(!0),k(e=>e+1)):"collapse-all"===e.key&&(_(!1),k(e=>e+1))}},filters:(0,Z.nZ)(null==eI?void 0:eI.locations,e=>{var t;return null!==(t=S.Z8[e])&&void 0!==t?t:e}),filteredValue:(null==es?void 0:es.locations)||null,render:e=>{var t;return(0,n.jsx)(U.Q,{values:null!==(t=null==e?void 0:e.map(e=>{var t;return{label:null!==(t=S.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:f,version:b}})}},{title:"Domain",dataIndex:w.r6.DOMAIN,key:w.r6.DOMAIN},{title:"Detected on",dataIndex:w.r6.PAGE,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(T(!0),I(e=>e+1)):"collapse-all"===e.key&&(T(!1),I(e=>e+1))}},key:w.r6.PAGE,render:e=>(0,n.jsx)(U.v,{values:e,valueSuffix:"pages",columnState:{isExpanded:x,version:N}})}];return K&&t.push({title:()=>(0,n.jsxs)(d.vyj,{children:[(0,n.jsx)("div",{children:"Compliance"}),g===u.lg.WITHOUT_CONSENT&&(0,n.jsx)(V.l,{consentStatus:{status:u.pF.ALERT,message:"One or more assets were detected without consent"}})]}),dataIndex:w.r6.CONSENT_AGGREGATED,key:w.r6.CONSENT_AGGREGATED,sorter:!0,sortOrder:eo===w.r6.CONSENT_AGGREGATED?ei:null,filters:(0,Z.nZ)(null==eI?void 0:eI[w.r6.CONSENT_AGGREGATED],e=>{var t;return null!==(t=({with_consent:w.X1.WITH_CONSENT,without_consent:w.X1.WITHOUT_CONSENT,exempt:w.X1.EXEMPT,unknown:w.X1.UNKNOWN})[e])&&void 0!==t?t:e}),filteredValue:(null==es?void 0:es[w.r6.CONSENT_AGGREGATED])||null,render:(e,t)=>(0,n.jsx)(J,{consentAggregated:null!=e?e:u.lg.UNKNOWN,stagedResource:t,onShowBreakdown:l})}),Q||t.push({title:"Actions",key:w.r6.ACTIONS,fixed:"right",render:(e,t)=>(0,n.jsx)(Y,{asset:t,onTabChange:B})}),t},[eo,ei,eI,es,K,Q,$,j,f,x,O,b,N,g,l,B]);(0,a.useEffect)(()=>{if(ev){var e;let t=(null===(e=ev.items[0])||void 0===e?void 0:e.system)||y||s||"";v(t),null==o||o(t)}},[ev,s,o,y]),(0,a.useEffect)(()=>{if((null==ev?void 0:ev.items)&&!g){var e;h(null===(e=ev.items.find(e=>e.consent_aggregated===u.lg.WITHOUT_CONSENT))||void 0===e?void 0:e.consent_aggregated)}},[ev,g]);let{selectedKeys:eL,selectedRows:eP,resetSelections:eM}=eD,eU=(0,a.useCallback)(async()=>{var e,t;let s=await eh({urnList:eL}),n=(null===(e=eP[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=eP[0])||void 0===t?void 0:t.system_key),r=eP.every(e=>(e.user_assigned_system_key||e.system_key)===n)?n:void 0;(0,M.D4)(s)?m((0,q.Vo)((0,M.e$)(s.error))):(m((0,q.t5)((0,W._)("".concat(eL.length," assets from ").concat(y," have been added to the system inventory."),r?()=>c.push("".concat(i.So,"/configure/").concat(r,"#assets")):()=>c.push(i.So)))),eM())},[eh,eL,eP,y,m,c,eM]),eG=(0,a.useCallback)(async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await eC({monitorId:t,urnList:eL,systemKey:e.value});(0,M.D4)(s)?m((0,q.Vo)((0,M.e$)(s.error))):m((0,q.t5)("".concat(eL.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}},[eC,t,eL,m]),eq=(0,a.useCallback)(async e=>{if(!eP.length)return;let s=eP.map(t=>{let s=L()([...t.user_assigned_data_uses||t.data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:s}}),n=await eb({monitorId:t,assets:s});(0,M.D4)(n)?m((0,q.Vo)((0,M.e$)(n.error))):m((0,q.t5)("Consent categories added to ".concat(eL.length," assets").concat(y?" from ".concat(y):"","."),"Confirmed"))},[eP,eb,t,eL,y,m]),eZ=(0,a.useCallback)(async()=>{let e=await e_({urnList:eL});(0,M.D4)(e)?m((0,q.Vo)((0,M.e$)(e.error))):(m((0,q.t5)(y===i.Kl?"".concat(eL.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(eL.length," assets from ").concat(y," have been ignored and will not appear in future scans."),"Confirmed")),eM())},[e_,eL,y,m,eM]),eV=(0,a.useCallback)(async()=>{let e=await eA({urnList:eL});(0,M.D4)(e)?m((0,q.Vo)((0,M.e$)(e.error))):(m((0,q.t5)("".concat(eL.length," assets have been restored and will appear in future scans."),"Confirmed")),eM())},[eA,eL,m,eM]),eW=(0,a.useCallback)(async()=>{let e=(null==ev?void 0:ev.items.length)||0,n=await eT({monitor_config_key:t,resolved_system_ids:[s]});(0,M.D4)(n)?m((0,q.Vo)((0,M.e$)(n.error))):(c.push("".concat(i.vi,"/").concat(t)),m((0,q.t5)("".concat(e," assets from ").concat(y," have been added to the system inventory."),"Confirmed")),eM())},[null==ev?void 0:ev.items.length,eT,t,s,c,m,y,eM]),ez=(0,a.useCallback)(async e=>{await B(e),ea(),eM()},[B,ea,eM]);return{columns:eR,data:ev,isLoading:eg,isFetching:ep,tableState:et,searchQuery:el,updateSearch:ed,updateFilters:ec,updateSorting:eu,updatePageIndex:em,updatePageSize:ey,resetState:ea,tableProps:eD.tableProps,selectionProps:eD.selectionProps,filterTabs:X,activeTab:$,handleTabChange:ez,activeParams:H,actionsDisabled:Q,selectedRows:eP,selectedUrns:eL,hasSelectedRows:eD.hasSelectedRows,resetSelections:eM,systemName:y,firstItemConsentStatus:g,handleBulkAdd:eU,handleBulkAssignSystem:eG,handleBulkAddDataUse:eq,handleBulkIgnore:eZ,handleBulkRestore:eV,handleAddAll:eW,anyBulkActionIsLoading:ek,isAddingResults:ef,isIgnoringResults:ex,isAddingAllResults:ej,isBulkUpdatingSystem:eS,isBulkAddingDataUses:eE,isRestoringResults:ew,disableAddAll:eN}},es=e=>{var t;let{monitorId:s,systemId:r,onSystemName:o}=e,[i,l]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),[g,p]=(0,a.useState)(null),{columns:h,searchQuery:f,updateSearch:x,resetState:T,tableProps:j,selectionProps:S,filterTabs:b,activeTab:E,handleTabChange:A,activeParams:w,actionsDisabled:k,selectedUrns:N,hasSelectedRows:I,resetSelections:O,handleBulkAdd:R,handleBulkAssignSystem:L,handleBulkAddDataUse:P,handleBulkIgnore:M,handleBulkRestore:U,handleAddAll:G,anyBulkActionIsLoading:q,isAddingAllResults:Z,isBulkUpdatingSystem:V,isBulkAddingDataUses:W,disableAddAll:z}=et({monitorId:s,systemId:r,onSystemName:o,onShowBreakdown:(e,t)=>{p({stagedResource:e,status:t})}}),Y=async e=>{await L(e),l(!1)},K=async e=>{await P(e),v(!1)};return s&&r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Niu,{"aria-label":"Asset state filter",mode:"horizontal",items:b.map(e=>({key:e.hash,label:e.label})),selectedKeys:[E],onClick:async e=>{await A(e.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,n.jsxs)(d.jqI,{justify:"space-between",align:"center",className:"mb-4",children:[(0,n.jsx)(m.f,{value:f,onChange:x,placeholder:"Search by asset name..."}),(0,n.jsxs)(d.vyj,{size:"large",children:[I&&(0,n.jsx)(c.a,{count:N.length}),(0,n.jsxs)(d.vyj,{size:"small",children:[(0,n.jsx)(d.wpx,{onClick:()=>{T(),O()},"data-testid":"clear-filters",children:"Clear filters"}),(0,n.jsx)(d.S0p,{overlayClassName:"bulk-actions-menu-dropdown",menu:{items:[...(null==w?void 0:null===(t=w.diff_status)||void 0===t?void 0:t.includes(u.LL.MUTED))?[{key:"restore",label:"Restore",onClick:U}]:[{key:"add",label:"Add",onClick:R},{key:"add-data-use",label:"Add consent category",onClick:()=>v(!0)},{key:"assign-system",label:"Assign system",onClick:()=>l(!0)},{type:"divider"},{key:"ignore",label:"Ignore",onClick:M}]]},trigger:["click"],children:(0,n.jsx)(d.wpx,{icon:(0,n.jsx)(d.PJP._ME,{}),iconPosition:"end",loading:q,"data-testid":"bulk-actions-menu",disabled:!I||q||k,type:"primary",children:"Actions"})}),(0,n.jsx)(d.esZ,{title:z?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(d.wpx,{onClick:G,disabled:z,loading:Z,type:"primary",icon:(0,n.jsx)(d.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(d.V5H,{...j,columns:h,rowSelection:S,locale:{emptyText:(0,n.jsx)(d.oj8,{image:d.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})},"aria-labelledby":"breadcrumb-current-page"}),(0,n.jsx)(C,{isOpen:i,onClose:()=>{l(!1)},onSave:Y,isSaving:V}),(0,n.jsx)(_,{isOpen:y,onClose:()=>{v(!1)},onSave:K,isSaving:W}),g&&(0,n.jsx)(D,{isOpen:!!g,stagedResource:g.stagedResource,status:g.status,onCancel:()=>{p(null)}})]}):null};var en=()=>{let e=(0,r.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),[d,c]=(0,a.useState)(s===i.Kl?"Uncategorized assets":s);return(0,n.jsxs)(o.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:i.vi},{title:t,href:"".concat(i.vi,"/").concat(t)},{title:s===i.Kl?"Uncategorized assets":d}]}),(0,n.jsx)(es,{monitorId:t,systemId:s,onSystemName:c})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[431,8765,9278,5163,4164,401,4844,3642,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);