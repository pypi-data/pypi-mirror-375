{"version":3,"file":"js/module_events.admin.2ea1b5b4.bundle.js","mappings":"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","sources":["webpack:///indico/modules/events/client/js/components/propTypes.js","webpack:///indico/modules/events/client/js/components/AutoLinkerConfig.jsx","webpack:///indico/modules/events/client/js/components/AutoLinkerTestDrive.jsx","webpack:///indico/modules/events/client/js/admin.js"],"sourcesContent":["// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport PropTypes from 'prop-types';\n\n// Regex rule for auto-linker\nexport const rulePropTypes = {\n  regex: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired,\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport autoLinkerConfigURL from 'indico-url:events.autolinker_config';\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Button, Form, List, Message, Segment} from 'semantic-ui-react';\n\nimport {handleSubmissionError} from 'indico/react/forms';\nimport {Translate} from 'indico/react/i18n';\nimport {handleAxiosError, indicoAxios} from 'indico/utils/axios';\n\nimport {rulePropTypes} from './propTypes';\nimport './AutoLinkerConfig.module.scss';\n\n/**\n * A simple rule-adding form\n */\nfunction RuleEditor({regex, url, onChange}) {\n  function _onChange(key, value) {\n    const data = {regex, url};\n    data[key] = value;\n    onChange(data);\n  }\n\n  return (\n    <>\n      <Form.Input\n        fluid\n        placeholder={Translate.string('Regex Pattern')}\n        value={regex}\n        onChange={(__, {value}) => _onChange('regex', value)}\n      />\n      <Form.Input\n        fluid\n        placeholder={Translate.string('URL with placeholder(s)')}\n        value={url}\n        onChange={(__, {value}) => _onChange('url', value)}\n      />\n    </>\n  );\n}\n\nRuleEditor.propTypes = {\n  regex: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n\n/**\n * The Auto-linker config panel\n */\nexport default function AutoLinkerConfig({rules, onChange}) {\n  const [newRule, setNewRule] = useState({regex: '', url: ''});\n  const [error, setError] = useState(null);\n\n  const onAdd = async () => {\n    try {\n      const newRules = [...rules, newRule];\n      await indicoAxios.post(autoLinkerConfigURL(), {rules: newRules});\n      onChange(newRules);\n      setNewRule({regex: '', url: ''});\n    } catch (e) {\n      if (e?.response?.data?.error?.message) {\n        setError(e.response.data.error.message);\n      } else {\n        // more general error\n        setError(handleSubmissionError(e).rules);\n      }\n    }\n  };\n\n  const onRemove = async n => {\n    try {\n      const newRules = [...rules];\n      const [oldRule] = newRules.splice(n, 1);\n      await indicoAxios.post(autoLinkerConfigURL(), {rules: newRules});\n      onChange(newRules);\n      setNewRule(oldRule);\n    } catch (e) {\n      handleAxiosError(e);\n    }\n  };\n\n  return (\n    <>\n      {error ? <Message error>{error}</Message> : null}\n      <Segment styleName=\"list-segment\">\n        <List divided relaxed>\n          {rules.map(({regex, url}, n) => {\n            const encodedURI = encodeURIComponent(url.replace(/\\{(\\d+)\\}/g, '\\\\$1'));\n            const encodedRegex = encodeURIComponent(regex.replace(/\"/g, '\\\\\"'));\n\n            return (\n              <List.Item key={regex}>\n                <List.Content floated=\"right\">\n                  <Button\n                    basic\n                    icon=\"share\"\n                    as=\"a\"\n                    target=\"_blank\"\n                    title={Translate.string('Analyze on regex101.com')}\n                    href={`https://regex101.com/?flavor=python&regex=${encodedRegex}&subst=${encodedURI}&flags=g`}\n                    rel=\"noreferrer\"\n                  />\n                  <Button\n                    icon=\"trash alternate outline\"\n                    color=\"red\"\n                    title={Translate.string('Delete entry')}\n                    onClick={() => {\n                      setError(null);\n                      onRemove(n);\n                    }}\n                  />\n                </List.Content>\n                <List.Content>\n                  <List.Header>{regex}</List.Header>\n                  {url}\n                </List.Content>\n              </List.Item>\n            );\n          })}\n        </List>\n        <Form>\n          <Form.Group widths=\"equal\" styleName=\"rule-editor-row\">\n            <RuleEditor {...newRule} onChange={setNewRule} />\n            <Button\n              icon=\"plus\"\n              title={Translate.string('Add entry')}\n              onClick={() => {\n                setError(null);\n                onAdd();\n              }}\n              primary\n            />\n          </Form.Group>\n        </Form>\n      </Segment>\n    </>\n  );\n}\n\nAutoLinkerConfig.propTypes = {\n  rules: PropTypes.arrayOf(PropTypes.shape(rulePropTypes)).isRequired,\n  onChange: PropTypes.func.isRequired,\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport PropTypes from 'prop-types';\nimport React, {useState} from 'react';\nimport {Form, Grid, Icon, Segment} from 'semantic-ui-react';\n\nimport {Translate} from 'indico/react/i18n';\nimport {AutoLinkerPlugin, Markdown} from 'indico/react/util';\n\nimport {rulePropTypes} from './propTypes';\n\n/**\n * A \"test drive\" widget which just takes Markdown and renders it using the auto-linker rules which are provided\n */\nexport default function AutoLinkerTestDrive({rules}) {\n  const [source, setSource] = useState('');\n\n  const onChange = value => {\n    setSource(value);\n  };\n\n  return (\n    <Segment>\n      <h2>\n        <Icon name=\"car\" />\n        <Translate>Test drive</Translate>\n      </h2>\n      <p>\n        <Translate>\n          You can write some markdown below and see how the above rules are applied\n        </Translate>\n      </p>\n      <Form>\n        <Grid columns={2}>\n          <Grid.Column>\n            <Form.TextArea\n              placeholder={Translate.string('Write some Markdown here...')}\n              value={source}\n              onChange={(__, {value}) => onChange(value)}\n            />\n          </Grid.Column>\n          <Grid.Column>\n            {source ? (\n              <Segment>\n                <Markdown targetBlank remarkPlugins={[[AutoLinkerPlugin, {rules}]]}>\n                  {source}\n                </Markdown>\n              </Segment>\n            ) : null}\n          </Grid.Column>\n        </Grid>\n      </Form>\n    </Segment>\n  );\n}\n\nAutoLinkerTestDrive.propTypes = {\n  rules: PropTypes.arrayOf(PropTypes.shape(rulePropTypes)).isRequired,\n};\n","// This file is part of Indico.\n// Copyright (C) 2002 - 2025 CERN\n//\n// Indico is free software; you can redistribute it and/or\n// modify it under the terms of the MIT License; see the\n// LICENSE file for more details.\n\nimport autoLinkerRulesURL from 'indico-url:events.autolinker_rules';\n\nimport React, {useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {Loader} from 'semantic-ui-react';\n\nimport {useIndicoAxios} from 'indico/react/hooks';\n\nimport AutoLinkerConfig from './components/AutoLinkerConfig';\nimport AutoLinkerTestDrive from './components/AutoLinkerTestDrive';\n\nfunction AutoLinker() {\n  const [_rules, setRules] = useState(null);\n  const {data, loading} = useIndicoAxios(autoLinkerRulesURL(), {\n    camelize: true,\n  });\n\n  const rules = _rules || data?.rules;\n\n  return loading ? (\n    <Loader />\n  ) : (\n    <>\n      <AutoLinkerConfig rules={rules} onChange={setRules} />\n      <AutoLinkerTestDrive rules={rules} />\n    </>\n  );\n}\n\nwindow.setupAutoLinkerConfig = rootElementId => {\n  const rootElement = document.getElementById(rootElementId);\n\n  if (rootElement) {\n    ReactDOM.render(<AutoLinker />, rootElement);\n  }\n};\n"],"names":["rulePropTypes","regex","PropTypes","isRequired","url","autoLinkerConfigURL","_buildFlaskURL","bind","endpoint","rules","args","converters","defaults","trace","data","isDynamic","RuleEditor","onChange","_onChange","key","value","React","Form","Input","fluid","placeholder","Translate","string","__","AutoLinkerConfig","newRule","setNewRule","useState","error","setError","Message","Segment","className","List","divided","relaxed","map","n","encodedURI","encodeURIComponent","replace","encodedRegex","Item","Content","floated","Button","basic","icon","as","target","title","href","rel","color","onClick","async","newRules","oldRule","splice","indicoAxios","post","e","handleAxiosError","onRemove","Header","Group","widths","_extends","response","message","handleSubmissionError","onAdd","primary","propTypes","AutoLinkerTestDrive","source","setSource","Icon","name","Grid","columns","Column","TextArea","Markdown","targetBlank","remarkPlugins","AutoLinkerPlugin","autoLinkerRulesURL","AutoLinker","_rules","setRules","loading","useIndicoAxios","camelize","Loader","window","setupAutoLinkerConfig","rootElementId","rootElement","document","getElementById","ReactDOM"],"sourceRoot":""}