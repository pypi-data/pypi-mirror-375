import{x as z,c as q,W as b,X as i,aP as F,a1 as W,Y as p,aQ as G,G as Y,a_ as k,U as D,a3 as H,ab as c,a0 as y,Z as A,ag as B,a2 as r,bd as g,F as f,ar as w,E as $,ad as v,b5 as I,as as E,a6 as u,bb as P,$ as j,I as X,ba as K,aT as R,aU as M,aS as V,a4 as S,aa as Z,b6 as N,a9 as J,ah as Q,aq as U,a7 as x,b9 as ee,b3 as ae,bh as le,a$ as oe,V as se,a5 as te}from"./index-B-lUZalq.js";import{B as T}from"./Button-kSJGA_Pw.js";import{M as ie}from"./MediaItemThumb-DapaMoP4.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as re}from"./VSlider-BCIrn4it.js";import{V as ne}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-DnroVGI-.js";const ue={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(t,s){const n=z(!0),l=q(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:n.value?0:10,step:2,elevation:0,style:`width: ${t.width}; height:${t.height}; display: inline-grid; ${t.style}`})),h=q(()=>({...l.value,...s}));return{isThumbHidden:n,playerVolumeProps:h,onWheel:({deltaY:m})=>{if(!t.allowWheel)return;const C=h.value.step,a=s.attrs["model-value"],d=m<0?C:-C;s.emit("update:model-value",a+d)}}}};function de(t,s,n,l,h,e){return i(),b(re,Y(l.playerVolumeProps,{onTouchstart:s[0]||(s[0]=m=>l.isThumbHidden=!1),onTouchend:s[1]||(s[1]=m=>l.isThumbHidden=!0),onMouseenter:s[2]||(s[2]=m=>l.isThumbHidden=!1),onMouseleave:s[3]||(s[3]=m=>l.isThumbHidden=!0),onWheel:k(l.onWheel,["prevent"]),onEnd:s[4]||(s[4]=m=>t.$emit("update:model-value",m))}),F({_:2},[W(t.$slots,(m,C)=>({name:C,fn:p(()=>[G(t.$slots,C,{},void 0,!0)])}))]),1040,["onWheel"])}const O=L(ue,[["render",de],["__scopeId","data-v-af51e13c"]]),pe={key:1,class:"text-caption volumecaption"},me={key:0,class:"text-caption volumecaption"},ye=D({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(t){const s=t,n=z([]),l=z([]),h=z(void 0),e=q(()=>s.player.group_members.length>0),m=function(a){const d=[];for(const o of a.group_members){const _=u?.players[o];_&&_.volume_control!=g&&_&&_.available&&!d.includes(_)&&d.push(_)}if(s.showSyncControls&&a.supported_features.includes(R.SET_MEMBERS))for(const o of Object.values(u?.players))o.player_id!=a.player_id&&(!a.can_group_with.includes(o.player_id)&&!a.can_group_with.includes(o.provider)||o.available&&(o.active_group&&o.active_group!=a.player_id||o.active_source&&o.playback_state==M.PLAYING&&![a.player_id,o.player_id].includes(o.active_source)||d.includes(o)||d.push(o)));return d.sort((o,_)=>o.name.toUpperCase()>_.name.toUpperCase()?1:-1),d},C=async function(a,d){const o=s.player.player_id;d?(l.value.includes(a)&&(l.value=l.value.filter(_=>_!=a)),n.value.includes(a)||n.value.push(a),u.players[o].group_members.push(a)):(n.value.includes(a)&&(n.value=n.value.filter(_=>_!=a)),l.value.includes(a)||l.value.push(a),u.players[o].group_members=u.players[o].group_members.filter(_=>_!=a)),h.value!=null&&clearTimeout(h.value),!(n.value.length==0&&l.value.length==0)&&(h.value=setTimeout(async()=>{u.playerCommandSetMembers(o,n.value.length?n.value:void 0,l.value.length?l.value:void 0).catch(async()=>{u.players[o]=await u.getPlayer(o)}).finally(()=>{n.value=[],l.value=[]})},1e3))};return(a,d)=>(i(),b(H,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:p(()=>[a.showHeadingRow?(i(),b(A,{key:0,class:"volumesliderrow heading",link:!1,style:B(a.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:p(()=>[f(w,{size:25,icon:a.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[$("h5",null,v(r(I)(a.player,27)),1)]),append:p(()=>[a.player.power_control!=r(g)?(i(),b(T,{key:0,class:"powerbtn",variant:"icon",onClick:d[0]||(d[0]=k(o=>r(u).playerCommandPowerToggle(a.player.player_id),["stop"]))},{default:p(()=>[f(w,{size:25,icon:"mdi-power"})]),_:1})):c("",!0)]),_:1},8,["style"])):c("",!0),a.showVolumeControl&&(a.player.volume_control!=r(g)||a.player.group_members.length)?(i(),b(A,{key:1,class:"volumesliderrow",link:!1,style:B(a.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:p(()=>[f(T,{icon:"",style:{height:"25px"},disabled:a.player.type==r(P).GROUP||a.player.group_members.length>0||a.player.mute_control==r(g),onClick:d[1]||(d[1]=k(o=>r(u).playerCommandMuteToggle(a.player.player_id),["stop"]))},{default:p(()=>[f(w,{size:25,icon:a.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:p(()=>[a.player.volume_control!=r(g)||a.player.group_members.length?(i(),b(O,{key:0,color:"secondary",width:"100%","is-powered":a.player.powered!=!1,disabled:!a.player.available,"model-value":Math.round(a.player.group_members.length?a.player.group_volume:a.player.volume_level||0),onClick:d[2]||(d[2]=k(()=>{},["stop"])),"onUpdate:modelValue":d[3]||(d[3]=o=>a.player.group_members.length>0?r(u).playerCommandGroupVolume(a.player.player_id,o):r(u).playerCommandVolumeSet(a.player.player_id,o))},null,8,["is-powered","disabled","model-value"])):c("",!0)]),append:p(()=>[e.value&&!a.showSubPlayers?(i(),b(w,{key:0,class:"expandbtn"},{default:p(()=>[...d[7]||(d[7]=[E(" mdi-chevron-down ",-1)])]),_:1})):(i(),y("div",pe,v(Math.round(a.player.group_members.length?a.player.group_volume:a.player.volume_level||0)),1))]),_:1},8,["style"])):c("",!0),a.showSubPlayers&&(a.player.group_members.length>0||a.showSyncControls)&&m(a.player).length>0?(i(),y("div",{key:2,onClick:d[6]||(d[6]=k(()=>{},["stop"]))},[f(j,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(i(!0),y(X,null,W(m(a.player),o=>(i(),y("div",{key:o.player_id},[f(A,{class:"volumesliderrow",link:!1,style:B(o.powered!=!1||a.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:d[4]||(d[4]=k(()=>{},["stop"]))},{prepend:p(()=>[f(w,{size:30,icon:o.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[$("h6",null,v(r(K)(o.name,27)),1)]),append:p(()=>[a.showSyncControls?(i(),b(ne,{key:0,ripple:!1,disabled:o.player_id==a.player.player_id,"model-value":a.player.group_members.includes(o.player_id)||o.player_id==a.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":_=>C(o.player_id,_)},null,8,["disabled","model-value","onUpdate:modelValue"])):c("",!0)]),_:2},1032,["style"]),o.volume_control!=r(g)?(i(),b(A,{key:0,class:"volumesliderrow",link:!1,style:B(o.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:d[5]||(d[5]=k(()=>{},["stop"]))},{prepend:p(()=>[f(T,{icon:"",disabled:!o.available||o.mute_control==r(g),style:{height:"25px"},onClick:_=>r(u).playerCommandMuteToggle(o.player_id)},{default:p(()=>[f(w,{size:25,icon:o.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:p(()=>[o.volume_control!=r(g)?(i(),b(O,{key:0,color:"secondary",width:"100%","is-powered":o.powered!=!1,disabled:!o.available,"allow-wheel":a.allowWheel,"model-value":Math.round(o.volume_level||0),"onUpdate:modelValue":_=>r(u).playerCommandVolumeSet(o.player_id,_)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):c("",!0)]),append:p(()=>[o.volume_control!=r(g)?(i(),y("div",me,v(o.volume_level),1)):c("",!0)]),_:2},1032,["style"])):c("",!0),d[8]||(d[8]=$("div",{style:{height:"14px"}},null,-1))]))),128))])):c("",!0)]),_:1}))}}),ve=L(ye,[["__scopeId","data-v-95478b91"]]),_e=(t,s)=>{const n=[];t?.power_control!=g&&n.push({label:t.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{u.playerCommandPowerToggle(t.player_id)},icon:"mdi-power"}),(t?.playback_state=="playing"||t?.playback_state=="paused")&&n.push({label:"stop_playback",labelArgs:[],action:()=>{u.playerCommandStop(t.player_id)},icon:"mdi-stop"});const l=Object.values(u.players).filter(e=>e.player_id!=t.player_id&&e.available&&e.enabled&&(e.can_group_with.includes(t.provider)||e.can_group_with.includes(t.player_id))&&e.supported_features.includes(R.SET_MEMBERS)&&!e.synced_to);t.supported_features.includes(R.SET_MEMBERS)&&!t.synced_to&&t.type==P.PLAYER&&t.group_members.length==0&&l.length>0&&n.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:l.map(e=>({label:e.name,labelArgs:[],action:()=>{u.playerCommandGroup(t.player_id,e.player_id)}})).sort((e,m)=>e.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),s&&n.push({label:s.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{u.queueCommandShuffleToggle(s.queue_id)},icon:s.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),s&&n.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.OFF)},selected:s.repeat_mode==V.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.ALL)},selected:s.repeat_mode==V.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{u.queueCommandRepeat(s.queue_id,V.ONE)},selected:s.repeat_mode==V.ONE}],icon:"mdi-repeat"}),s?.items&&n.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(u.players).filter(e=>e.player_id!=s.queue_id&&e.player_id!=t.player_id&&e.available&&e.enabled&&!e.synced_to).map(e=>({label:e.name,labelArgs:[],action:()=>{u.queueCommandTransfer(s.queue_id,e.player_id),S.activePlayerId=e.player_id}})).sort((e,m)=>e.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),s?.items&&n.push({label:"queue_clear",labelArgs:[],action:()=>{u.queueCommandClear(s.queue_id)},icon:"mdi-cancel"});const h=t.source_list.filter(e=>!e.passive||e.id==t.active_source);return t.active_source!=t.player_id&&h.push({id:t.player_id,name:Z("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!t.synced_to&&h.length>0&&n.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:h.map(e=>({label:e.name,labelArgs:[],disabled:e.id==t.active_source,selected:e.id==t.active_source,action:()=>{u.playerCommandGroupSelectSource(t.player_id,e.id)}})).sort((e,m)=>e.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),s&&"dont_stop_the_music_enabled"in s&&n.push({label:s.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{u.queueCommandDontStopTheMusicToggle(s.queue_id)},icon:"mdi-all-inclusive"}),n.push({label:"open_player_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${t.player_id}`)},icon:"mdi-cog-outline"}),t.type!==P.GROUP&&n.push({label:"open_dsp_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${t.player_id}/dsp`)},icon:"mdi-equalizer"}),n},ce={class:"player-media-thumb"},be={key:1},fe={key:2,class:"icon-thumb"},he={key:0,style:{"margin-bottom":"3px"}},ge={key:0},we={key:1},ke={key:1,style:{"margin-bottom":"3px"}},Ce={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},Se={key:0},Ve={key:0},Te={key:1},Ae={key:2},Me={class:"v-list-item-subtitle",style:{"white-space":"nowrap"}},$e={key:0},qe={key:1},Be={key:2},ze={key:3},Ee={key:4},Pe={key:5},Ue={key:6},Ie={key:7},Re=D({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},setup(t){const s=t,n=q(()=>{if(s.player&&s.player.active_source&&s.player.active_source in u.queues)return u.queues[s.player.active_source];if(s.player&&!s.player.active_source&&s.player.player_id in u.queues)return u.queues[s.player.player_id]}),l=q(()=>{if(n.value&&n.value.active)return n.value.current_item}),h=function(e){te.emit("contextmenu",{items:_e(s.player,n.value),posX:e.clientX,posY:e.clientY})};return(e,m)=>(i(),b(J,{flat:"",class:Q(["panel-item",{"panel-item-selected":e.player.player_id==r(S).activePlayerId,"panel-item-idle":e.player.playback_state==r(M).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available},{default:p(()=>[f(A,{class:"panel-item-details",flat:"",ripple:!1},{prepend:p(()=>[$("div",ce,[e.player.powered!=!1&&l.value?(i(),b(ie,{key:0,class:"media-thumb",size:"55",item:l.value,fallback:r(oe)},null,8,["item","fallback"])):e.player.powered!=!1&&!n.value&&e.player.current_media?.image_url?(i(),y("div",be,[f(se,{class:"media-thumb",size:"55",src:e.player.current_media.image_url},null,8,["src"])])):(i(),y("div",fe,[f(w,{size:"35",icon:e.player.type==r(P).PLAYER&&e.player.group_members.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]),title:p(()=>[r(le).player_id===e.player.player_id?(i(),y("div",he,[e.player.name=="This Device"?(i(),y("span",ge,v(e.$t("this_device")),1)):(i(),y("span",we,v(r(I)(e.player,27)),1)),f(w,{size:"20",class:"pl-2",icon:r(S).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(i(),y("div",ke,v(r(I)(e.player,27)),1))]),subtitle:p(()=>[e.player.powered!=!1?(i(),y("div",Ce,[l.value?.media_item?(i(),y("div",Se,[E(v(l.value?.media_item.name)+" ",1),"version"in l.value?.media_item&&l.value?.media_item.version?(i(),y("span",Ve,"("+v(l.value?.media_item.version)+")",1)):c("",!0)])):l.value?(i(),y("div",Te,v(l.value?.name),1)):!n.value&&e.player.current_media?.title?(i(),y("div",Ae,v(e.player.current_media.title),1)):c("",!0)])):c("",!0)]),default:p(()=>[$("div",Me,[e.player.powered==!1?(i(),y("div",$e,v(e.$t("off")),1)):l.value?.media_item&&l.value?.media_item?.media_type==r(x).TRACK&&"album"in l.value?.media_item&&l.value?.media_item.album?(i(),y("div",qe,v(r(ee)(l.value?.media_item.artists))+" â€¢ "+v(l.value?.media_item.album.name),1)):l.value?.media_item&&"artists"in l.value?.media_item&&l.value?.media_item.artists.length>0?(i(),y("div",Be,v(l.value?.media_item.artists[0].name),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title&&l.value?.streamdetails?.stream_metadata.artist?(i(),y("div",ze,v(l.value?.streamdetails?.stream_metadata.artist)+" - "+v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title?(i(),y("div",Ee,v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.media_item?.metadata.description?(i(),y("div",Pe,v(l.value?.media_item.metadata.description),1)):!n.value&&e.player.active_source?(i(),y("div",Ue,v(e.$t("external_source_active",[r(ae)(e.player)])),1)):n.value?.items==0?(i(),y("div",Ie,v(e.$t("queue_empty")),1)):c("",!0)])]),append:p(()=>[e.player.playback_state==r(M).PAUSED||e.player.playback_state==r(M).PLAYING||n.value?.items?(i(),b(T,{key:0,variant:"icon",class:"player-command-btn",onClick:m[0]||(m[0]=k(C=>{r(u).playerCommandPlayPause(e.player.player_id),r(S).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32",icon:e.player.playback_state==r(M).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):c("",!0),e.player.power_control!=r(g)&&e.allowPowerControl?(i(),b(T,{key:1,variant:"icon",class:"player-command-btn",onClick:m[1]||(m[1]=k(C=>{r(u).playerCommandPowerToggle(e.player.player_id),r(S).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32"},{default:p(()=>[...m[2]||(m[2]=[E("mdi-power",-1)])]),_:1},8,["size"])]),_:1})):c("",!0),e.showMenuButton?(i(),b(T,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:k(h,["stop"])},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32"},{default:p(()=>[...m[3]||(m[3]=[E("mdi-dots-vertical",-1)])]),_:1},8,["size"])]),_:1})):c("",!0)]),_:1}),e.showVolumeControl?(i(),b(ve,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):c("",!0)]),_:1},8,["class","disabled"]))}}),Ge=L(Re,[["__scopeId","data-v-23afa8d9"]]);export{O as P,ve as V,Ge as a,_e as g};
