(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[3652],{23725:()=>{window.setupBadgePrinting=function(e){const t=$("#template"),n=$("#page_layout"),a=$("#dashed_border"),s=$("#page_size"),i=$("#page_orientation"),r=$(".margin-editor"),l=$(".info");function o(e,t,n){({A0:"A2",A1:"A3",A2:"A4",A3:"A5",A4:"A6",A5:"A7",A6:"A8"})[t]===e.format&&n===e.orientation?$("#page_layout option[value='foldable']").prop("disabled",!1):($("#page_layout option[value='foldable']").prop("disabled",!0),"foldable"===$("#page_layout :selected").val()&&$("#page_layout :selected").next().prop("selected",!0))}t.on("change",(function(){const t=$(this),a=e[parseInt(t.val(),10)];n.closest(".form-group").toggle(!!a.backside_tpl_id),n.val("front_only"),o(a,s.val(),i.val())})).change(),n.on("change",(function(){r.add(l).toggle("foldable"!==$(this).val()),a.closest(".form-group").toggle("foldable"!==$(this).val())})).change(),s.add(i).on("change",(()=>{o(e[parseInt(t.val(),10)],s.val(),i.val()),n.change()})).change()}},42233:(e,t,n)=>{"use strict";var a=n(77940),s=n(637),i=n.n(s),r=n(86326),l=n(35623),o=(n(35942),n(98778),n(23725),n(97598)),c=n.n(o),d=n(96478),m=n(29079),u=n(92117),_=n(56237),g=n(99323),p=n(23507),v=n(87597),h=n(29481),y=n(33864),f=n(46145),b=n(49528);const E=m.default.bind(null,{endpoint:"persons.api_email_event_persons_metadata",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),T=m.default.bind(null,{endpoint:"persons.api_email_event_persons_send",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/"),A=m.default.bind(null,{endpoint:"persons.email_event_persons_preview",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/");function D({eventId:e,roleIds:t,persons:n,onClose:a,onSubmitSucceeded:s,noAccount:i,notInvitedOnly:l,successTimeout:o}){const[c,d]=(0,r.useState)(0),m={role_id:t,persons:n,no_account:i,not_invited_only:l},{data:u,loading:_}=(0,h.Ku)({url:E({event_id:e}),method:"POST",data:m}),{senders:v=[],recipients:D=[],subject:S,body:C,placeholders:I=[]}=u||{};return _?r.createElement(g.A,{active:!0,page:!0,inverted:!0},r.createElement(p.A,null)):r.createElement(y.V,{onSubmit:async t=>{const n={...t,...m};let i;try{i=await b.indicoAxios.post(T({event_id:e}),n)}catch(e){return(0,f.handleSubmitError)(e)}d(i.data.count),s&&s(i.data.count),setTimeout((()=>a()),o)},onClose:a,senders:v,recipients:D,previewURL:A({event_id:e}),previewContext:m,placeholders:I,initialFormValues:{subject:S,body:C},sentEmailsCount:c})}D.propTypes={eventId:c().number.isRequired,roleIds:c().arrayOf(c().number),persons:c().arrayOf(c().string),onClose:c().func.isRequired,onSubmitSucceeded:c().func,noAccount:c().bool,notInvitedOnly:c().bool,successTimeout:c().number},D.defaultProps={roleIds:[],persons:[],onSubmitSucceeded:void 0,noAccount:!1,notInvitedOnly:!1,successTimeout:5e3};var S=n(79106);function C({eventId:e,roleId:t,persons:n,personSelector:s,triggerSelector:i,noAccount:l,notInvitedOnly:o,onSubmitSucceeded:c,successTimeout:m,...u}){const[g,p]=(0,r.useState)(!1);return n=s?(0,S.r)(s,!1):n,(0,r.useEffect)((()=>{if(!i)return;const e=()=>p(!0),t=document.querySelector(i);return t.addEventListener("click",e),()=>t.removeEventListener("click",e)}),[i]),r.createElement(r.Fragment,null,!i&&r.createElement(_.A,(0,a.A)({onClick:()=>p(!0),disabled:!(t||n.length)},u),r.createElement(d.Translate,null,"Send email")),g&&r.createElement(D,{eventId:e,roleIds:t&&[t],persons:n,noAccount:l,notInvitedOnly:o,onClose:()=>p(!1),onSubmitSucceeded:c,successTimeout:m}))}C.propTypes={eventId:c().number.isRequired,roleId:c().number,persons:c().arrayOf(c().string),personSelector:c().string,triggerSelector:c().string,noAccount:c().bool,notInvitedOnly:c().bool,onSubmitSucceeded:c().func,successTimeout:c().number},C.defaultProps={roleId:void 0,persons:[],personSelector:void 0,triggerSelector:void 0,noAccount:!1,notInvitedOnly:!1,onSubmitSucceeded:void 0,successTimeout:void 0};var I=n(6841),R=n(91185),j=n(16520),k=n(47279);const q=e=>i().sortBy(e,"identifier");function w(e,t){return"CHANGE_SORT"===t.type?e.column!==t.column?{column:t.column,sortedPersons:q(e.sortedPersons).sort(((e,n)=>e[t.column].localeCompare(n[t.column]))),direction:"ascending"}:"ascending"===e.direction?{column:e.column,sortedPersons:e.sortedPersons.slice().reverse(),direction:"descending"}:{column:null,sortedPersons:q(e.sortedPersons),direction:null}:e}const x=({primaryAuthor:e,secondaryAuthor:t})=>[e&&d.Translate.string("Author"),t&&d.Translate.string("Co-author")].filter((e=>e)).join(", ")||"-";function N({persons:e,selectedPersons:t,onChangeSelection:n,isSelectable:a,isVisible:s,extraRoles:i}){const[l,o]=(0,r.useReducer)(w,{column:null,sortedPersons:q(e).map((e=>({...e,authorType:x(e),selectable:a(e)}))),direction:null}),{column:c,sortedPersons:m,direction:u}=l,_=m.filter((e=>s(e))),g=_.filter((e=>e.selectable)),p=t.filter((t=>s(e.find((e=>e.identifier===t))))).length,v=[...i,{icon:"mic",isActive:e=>e.speaker,titleActive:d.Translate.string("This person is a speaker"),titleInactive:d.Translate.string("This person is not a speaker")}];return r.createElement(I.A,{sortable:!0,selectable:!0,singleLine:!0},r.createElement(I.A.Header,null,r.createElement(I.A.Row,null,r.createElement(I.A.HeaderCell,{disabled:!0,colSpan:"2"},r.createElement(R.A,{indeterminate:p>0&&p<g.length,checked:p>0&&p===g.length,onChange:(e,t)=>{return a=t.checked,void n(a?g.map((e=>e.identifier)):[]);var a},disabled:!g.length})),r.createElement(d.Translate,{as:I.A.HeaderCell,sorted:"fullName"===c?u:null,onClick:()=>o({type:"CHANGE_SORT",column:"fullName"})},"Name"),r.createElement(d.Translate,{as:I.A.HeaderCell,sorted:"email"===c?u:null,onClick:()=>o({type:"CHANGE_SORT",column:"email"})},"Email"),r.createElement(d.Translate,{as:I.A.HeaderCell,sorted:"affiliation"===c?u:null,onClick:()=>o({type:"CHANGE_SORT",column:"affiliation"})},"Affiliation"),r.createElement(d.Translate,{as:I.A.HeaderCell,sorted:"authorType"===c?u:null,onClick:()=>o({type:"CHANGE_SORT",column:"authorType"})},"Author type"),r.createElement(d.Translate,{as:I.A.HeaderCell,disabled:!0},"Roles"))),r.createElement(I.A.Body,null,_.map((e=>r.createElement(I.A.Row,{key:e.identifier,style:e.selectable?{}:{opacity:"50%"},onClick:()=>(({identifier:e,selectable:a})=>{a&&(t.includes(e)?n(t.filter((t=>t!==e))):n([...t,e]))})(e)},r.createElement(I.A.Cell,{collapsing:!0},r.createElement(R.A,{disabled:!e.selectable,checked:t.includes(e.identifier)})),r.createElement(I.A.Cell,{collapsing:!0},r.createElement(j.A,{content:e.registered?d.Translate.string("This person is registered for the event"):d.Translate.string("This person is not yet registered"),position:"bottom center",inverted:!0,trigger:r.createElement("i",{className:"icon-ticket "+(e.registered?"":"inactive")})})),r.createElement(I.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.fullName),r.createElement(I.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.email),r.createElement(I.A.Cell,{className:"events-persons-client-js-___PersonList-module__data-cell___f7963"},e.affiliation),r.createElement(I.A.Cell,{collapsing:!0},e.authorType),r.createElement(I.A.Cell,{collapsing:!0},v.map((({icon:t,isActive:n,titleActive:a,titleInactive:s})=>r.createElement(j.A,{key:t,content:n(e)?a:s,position:"bottom center",inverted:!0,trigger:r.createElement("i",{key:t,className:`icon-${t} ${n(e)?"":"inactive"}`})}))))))),!_.length&&r.createElement(I.A.Row,{warning:!0},r.createElement(I.A.Cell,{colSpan:"7"},r.createElement(k.A,{name:"attention"}),r.createElement(d.Translate,null,"No persons were found matching the selected criteria.")))))}N.propTypes={persons:c().arrayOf(c().shape({identifier:c().string.isRequired,fullName:c().string.isRequired,email:c().string.isRequired,affiliation:c().string.isRequired,speaker:c().bool.isRequired,primaryAuthor:c().bool.isRequired,secondaryAuthor:c().bool.isRequired,registered:c().bool.isRequired})).isRequired,selectedPersons:c().arrayOf(c().string).isRequired,onChangeSelection:c().func.isRequired,isSelectable:c().func,isVisible:c().func,extraRoles:c().arrayOf(c().shape({icon:c().string.isRequired,isActive:c().func.isRequired,titleActive:c().string.isRequired,titleInactive:c().string.isRequired}))},N.defaultProps={isSelectable:()=>!0,isVisible:()=>!0,extraRoles:[]};const M=m.default.bind(null,{endpoint:"abstracts.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"abstracts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),O=m.default.bind(null,{endpoint:"contributions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),P=m.default.bind(null,{endpoint:"sessions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sessions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),L={abstracts:{idType:"abstract_id",personListURL:M},contributions:{idType:"contribution_id",personListURL:O,emptyListMessage:d.Translate.string("There are no persons associated with the selected contributions")},sessions:{idType:"session_id",personListURL:P,emptyListMessage:d.Translate.string("There are no persons associated with contributions in the selected sessions")}},F={submitter:{text:d.Translate.string("Submitters"),isMatch:e=>e.submitter,contexts:["abstracts"]},speaker:{text:d.Translate.string("Speakers"),isMatch:e=>e.speaker},primaryAuthor:{text:d.Translate.string("Authors"),isMatch:e=>e.primaryAuthor},secondaryAuthor:{text:d.Translate.string("Co-authors"),isMatch:e=>e.secondaryAuthor},notRegistered:{text:d.Translate.string("Not registered"),isMatch:e=>!e.registered}};function U({eventId:e,sourceIds:t,objectContext:n,onClose:a}){const[s,i]=(0,r.useState)([]),[l,o]=(0,r.useState)(void 0),[c,m]=(0,r.useState)([]),f=new FormData;t.forEach((e=>f.append(L[n].idType,e)));const{data:b,loading:E}=(0,h.Ku)({url:L[n].personListURL({event_id:e}),method:"POST",data:f,headers:{"content-type":"multipart/form-data"}},{camelize:!0}),T="abstracts"===n?[{icon:"user-check icon",isActive:e=>e.submitter,titleActive:d.Translate.string("This person submitted an abstract"),titleInactive:d.Translate.string("This person hasn't submitted any abstracts")}]:void 0,A=e=>!c.length||c.some((t=>F[t].isMatch(e))),D=Object.entries(F).filter((([,e])=>!e.contexts||e.contexts.includes(n))).map((([e,t])=>({key:e,content:t.text,onClick:()=>(e=>{m(c.includes(e)?c.filter((t=>t!==e)):[...c,e])})(e),primary:c.includes(e)})));return r.createElement(u.A,{open:!0,onClose:()=>a(),size:"large"},r.createElement(u.A.Header,{content:d.Translate.string("Authors list")}),r.createElement(u.A.Content,null,l&&r.createElement(y.M,{count:l}),r.createElement("div",null,r.createElement(d.Translate,{as:"div",style:{display:"inline-block",fontWeight:"bold",padding:"0.5em"}},"Filter by"),r.createElement(_.A.Group,{buttons:D,compact:!0})),E||!b?r.createElement(g.A,{active:!0},r.createElement(p.A,null)):Object.keys(b.eventPersons).length?r.createElement(N,{persons:Object.values(b.eventPersons),selectedPersons:s,onChangeSelection:e=>i(e),isSelectable:e=>!!e.email,isVisible:A,extraRoles:T}):r.createElement(v.A,{error:!0},L[n].emptyListMessage)),r.createElement(u.A.Actions,null,r.createElement(C,{eventId:e,persons:s.filter((e=>A(b.eventPersons[e]))),onSubmitSucceeded:e=>o(e),successTimeout:0,primary:!0}),r.createElement(d.Translate,{as:_.A,onClick:()=>a()},"Close")))}function H({eventId:e,objectContext:t,paramsSelector:n}){const[a,s]=(0,r.useState)(!1),i=(0,S.r)(n);return r.createElement(r.Fragment,null,r.createElement("button",{type:"button",className:"i-button icon-users js-requires-selected-row disabled",onClick:e=>{e.target.classList.contains("disabled")||s(!0)}},r.createElement(d.Translate,null,"Authors list")),a&&r.createElement(U,{eventId:e,sourceIds:i,objectContext:t,onClose:()=>s(!1)}))}U.propTypes={eventId:c().number.isRequired,sourceIds:c().arrayOf(c().number).isRequired,objectContext:c().oneOf(Object.keys(L)).isRequired,onClose:c().func.isRequired},H.propTypes={eventId:c().number.isRequired,objectContext:c().oneOf(Object.keys(L)).isRequired,paramsSelector:c().string.isRequired};var B=n(94440),z=n(25584),V=n(24720),K=n(8196),Q=n(14867),G=n.n(Q),W=n(503),X=n(49138),Z=n(53225),Y=n(85218),J=n(63173),ee=n(98727);const te={"evt-list":"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH","evt-item":"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a",detail:"events-management-client-js-___SeriesManagement-module__detail___mXZyy","delete-button":"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH","list-flex":"events-management-client-js-___SeriesManagement-module__list-flex___DE65m",disabled:"events-management-client-js-___SeriesManagement-module__disabled___CB78C","date-span":"events-management-client-js-___SeriesManagement-module__date-span___8yRl2","category-chain":"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv","event-title":"events-management-client-js-___SeriesManagement-module__event-title___961dm","warning-reason":"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ","positive-note":"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv","load-more":"events-management-client-js-___SeriesManagement-module__load-more___6T2U4"},ne=m.default.bind(null,{endpoint:"categories.event_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"events",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search-for-series",isDynamic:!1}]}]},"/"),ae=m.default.bind(null,{endpoint:"event_series.event_series",rules:[{args:["series_id"],converters:{series_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1},{data:"series_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),se=m.default.bind(null,{endpoint:"events.single_event_api",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"info-for-series",isDynamic:!1}]}]},"/"),ie=(0,ee.q)(250),re=(0,ee.q)(250);function le({eventId:e,categoryId:t,seriesId:n,timezone:a}){const s=null!==n,[i,l]=(0,r.useState)(!1),{loading:o,reFetch:c,data:m}=(0,h.Ku)(s?ae({series_id:n}):se({event_id:e}),{manual:!0}),u=async()=>{await c(),l(!0)},_=m?s?m:{id:null,events:[m],show_sequence_in_title:!1,show_links:!1,event_title_pattern:""}:null;return r.createElement(r.Fragment,null,s?r.createElement(Y.IButton,{borderless:!0,icon:"stack",title:d.Translate.string("Manage event series"),onClick:u},r.createElement(d.Translate,null,"Manage series")):r.createElement(Y.IButton,{borderless:!0,icon:"stack",title:d.Translate.string("Create event series"),onClick:u},r.createElement(d.Translate,null,"Create series")),r.createElement(g.A,{active:o,page:!0,inverted:!0},r.createElement(p.A,null)),i&&r.createElement(oe,{currentEventId:e,categoryId:t,timezone:a,series:_,onClose:()=>{l(!1)}}))}function oe({currentEventId:e,categoryId:t,series:n,timezone:a,onClose:s}){const[l,o]=(0,r.useState)(!1),c=null!==n.id,m=e=>G()(e).tz(a);return r.createElement(r.Fragment,null,r.createElement(J.Sz,{id:"event-series",header:c?d.Translate.string("Manage series"):d.Translate.string("Create series"),size:"standard",alignTop:!0,onSubmit:async(e,t)=>{const a=c?(0,J.bW)(e,t):(0,J.Pj)(e,t);a.events&&(a.event_ids=a.events.map((e=>e.id)),delete a.events);try{c?await b.indicoAxios.patch(ae({series_id:n.id}),a):await b.indicoAxios.post(ae(),a)}catch(e){return(0,f.handleSubmitError)(e,{event_ids:"events"})}location.reload(),await new Promise((()=>{}))},onClose:s,initialValues:n,disabledUntilChange:c,extraActions:e=>c&&r.createElement(_.A,{style:{marginRight:"auto"},onClick:()=>o(!0),disabled:e.submitting,negative:!0},r.createElement(d.Translate,null,"Delete series")),submitLabel:c?d.Translate.string("Update series"):d.Translate.string("Create series")},(()=>r.createElement(r.Fragment,null,r.createElement(f.FinalField,{name:"events",isEqual:(e,t)=>i().isEqual((e||[]).map((e=>e.id)),(t||[]).map((e=>e.id))),validate:e=>{if(!e.length)return d.Translate.string("A series needs to contain at least one event.")},component:ce,localMoment:m,categoryId:t,currentEventId:e,existingSeriesId:n.id,divider:r.createElement(W.A,{horizontal:!0},c?r.createElement(d.Translate,null,"Events in series"):r.createElement(d.Translate,null,"Events to add"))}),r.createElement(W.A,{horizontal:!0},r.createElement(d.Translate,null,"Series options")),r.createElement(f.FinalCheckbox,{name:"show_sequence_in_title",label:d.Translate.string("Show the sequence number in the event titles (lectures only)")}),r.createElement(f.FinalCheckbox,{name:"show_links",label:d.Translate.string("Show links to the other events of the series on the main event page")}),r.createElement(f.FinalInput,{name:"event_title_pattern",label:d.Translate.string("Event title pattern"),description:r.createElement(d.Translate,null,"Title pattern for cloned events. Must contain the"," ",r.createElement(d.Param,{name:"placeholder",wrapper:r.createElement("code",null),value:"{n}"})," placeholder which will indicate the new event's position in the series."),validate:e=>{if(e&&!e.includes("{n}"))return d.Translate.string("Title pattern must contain the {placeholder} placeholder",{placeholder:"{n}"})}})))),r.createElement(Y.RequestConfirmDelete,{open:l,onClose:()=>o(!1),requestFunc:async()=>{try{await b.indicoAxios.delete(ae({series_id:n.id}))}catch(e){return(0,b.handleAxiosError)(e),!0}location.reload()},persistent:!0},r.createElement(d.Translate,null,"Do you really want to delete this series? The associated events will not be deleted.")))}function ce({value:e,onChange:t,onFocus:n,onBlur:a,divider:s,localMoment:i,categoryId:l,currentEventId:o,existingSeriesId:c}){const[m,u]=(0,r.useState)(void 0),[g,p]=(0,r.useState)([]),[v,h]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[E,T]=(0,r.useState)(null),A=null!==c,D=async e=>{let t;try{t=await re((()=>b.indicoAxios.get(se({event_id:+e}))))}catch(e){return void(0,b.handleAxiosError)(e)}if(null===t.data)T(d.Translate.string("No event found with this ID."));else if(t.data.can_access){if(t.data.category_chain)return p([t.data]),T(null),void f(!1);T(d.Translate.string("This event is unlisted."))}else T(d.Translate.string("You don't have rights to access this event."));f(!1),p([])},S=async(e,t=0,n=!1)=>{let a;try{a=await ie((()=>b.indicoAxios.get(ne({category_id:l,q:e,offset:t}))))}catch(e){return void(0,b.handleAxiosError)(e)}p(n?[...g,...a.data.events]:a.data.events),h(a.data.has_more),T(null),f(!1)},C=new Set(e.map((e=>e.id)));let I=g.map((e=>({key:e.id,value:e.id,text:e.title,disabled:!e.can_manage||!e.category_chain||e.series_id!==c&&null!==e.series_id||C.has(e.id),content:r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},i(e.start_dt).format("ll")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(Y.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv"},e.category_chain?e.category_chain.join(" » "):r.createElement(d.Translate,null,"Unlisted"))),!e.can_manage&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"You do not have editing rights for this event.")),!e.category_chain&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is unlisted.")),e.series_id!==c&&null!==e.series_id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is already part of a different series.")),C.has(e.id)&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},r.createElement("br",null),r.createElement(d.Translate,null,"This event is already part of this series."))))})));const R=()=>{f(!0),S(m.trim(),g.length,!0)};return I.length>0&&v&&(I=[...I,{key:"_",value:"_",className:te["load-more"],content:r.createElement("div",{onClick:e=>{e.stopPropagation()}},r.createElement(_.A,{primary:!0,compact:!0,size:"small",type:"button",loading:y,onClick:R},r.createElement(d.Translate,null,"Load more")))}]),r.createElement(r.Fragment,null,r.createElement(X.A,{fluid:!0,selection:!0,search:e=>e,icon:"search",closeOnChange:!1,selectOnBlur:!1,selectOnNavigation:!1,placeholder:d.Translate.string("Search for an event title or paste an event URL or event ID (#123)"),options:I,value:null,loading:y,onSearchChange:async(e,{searchQuery:t})=>{if(h(!1),u(t),t=t.trim(),T(null),!t)return f(!1),void p([]);const n=new RegExp(`^${location.origin.replace("/","\\/")}\\/event\\/([0-9]+)`),a=t.match(n);a?(f(!0),D(a[1])):/^#([0-9])+$/.test(t)?(f(!0),D(t.substr(1))):"#"!==t&&(f(!0),S(t))},searchQuery:m,onChange:(n,{value:a})=>{if("_"===a)return;const s=g.find((e=>e.id===a)),i=[...e,s].sort(((e,t)=>G()(e.start_dt)-G()(t.start_dt)));t(i)},onFocus:n,onBlur:a,noResultsMessage:y?d.Translate.string("Searching..."):null!==E?E:m?d.Translate.string("No results found."):d.Translate.string("Enter search term")}),s,r.createElement(Z.A,{divided:!0,relaxed:!0,className:"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH"},e.map((s=>r.createElement(Z.A.Item,{key:s.id,className:"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a"},r.createElement(Z.A.Content,null,r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},i(s.start_dt).format("ll"),r.createElement("br",null),o===s.id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},"(",r.createElement(d.Translate,null,"this event"),")")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},s.title,r.createElement("br",null),r.createElement(Y.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__detail___mXZyy"},s.category_chain?s.category_chain.join(" » "):r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement(d.Translate,null,"Unlisted"))))),(o!==s.id||A)&&r.createElement(j.A,{trigger:r.createElement(k.A,{className:"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH",name:"close",onClick:()=>{n(),a(),t(e.filter((e=>e.id!==s.id)))},link:!0}),content:d.Translate.string("Remove from event series"),position:"bottom center"}))))))))}le.propTypes={eventId:c().number.isRequired,categoryId:c().number.isRequired,timezone:c().string.isRequired,seriesId:c().number},le.defaultProps={seriesId:null},oe.propTypes={currentEventId:c().number.isRequired,categoryId:c().number.isRequired,series:c().shape({id:c().number,events:c().arrayOf(c().object).isRequired,show_sequence_in_title:c().bool.isRequired,show_links:c().bool.isRequired,event_title_pattern:c().string.isRequired}).isRequired,timezone:c().string.isRequired,onClose:c().func.isRequired},ce.propTypes={value:c().arrayOf(c().object).isRequired,onChange:c().func.isRequired,divider:c().node.isRequired,localMoment:c().func.isRequired,categoryId:c().number.isRequired,currentEventId:c().number.isRequired,existingSeriesId:c().number,onFocus:c().func.isRequired,onBlur:c().func.isRequired},ce.defaultProps={existingSeriesId:null},function(e){function t(){$("#person-filters ul > li").removeClass("enabled");const e=$(".js-event-person-list tr[data-person-roles]"),t=$(".js-event-person-list [data-filter]:checked").map((function(){const e=$(this);return e.closest("li").addClass("enabled"),e.data("filter")})).get(),n=e.filter(((e,n)=>!t.length||t.find((e=>$(n).data("person-roles")[e]))));e.addClass("hidden"),n.removeClass("hidden"),$(".js-event-person-list").trigger("indico:syncEnableIfChecked")}function n(){$(".js-reset-role-filter").toggleClass("disabled",0===$("#person-filters [data-filter]:checked").length)}function s(){$(".js-show-regforms").qtip({content:{text(){return $(this).data("title")}},hide:{delay:100,fixed:!0}})}e.setupEmailButton=function(e,t){const n=document.querySelector(e),{eventId:s,roleId:i,personSelector:o}=n.dataset,c={};void 0!==n.dataset.noAccount&&(c.noAccount=!0),void 0!==n.dataset.notInvitedOnly&&(c.notInvitedOnly=!0),l.render(r.createElement(C,(0,a.A)({eventId:+s,roleId:i&&+i,personSelector:o,triggerSelector:t},c)),n)},e.setupEmailContribAbstractRoles=function(e){const t=document.querySelector(e),{objectContext:n,idSelector:a,metadataUrl:s,previewUrl:i,sendUrl:o}=t.dataset;l.render(r.createElement(B.L,{objectContext:n,idSelector:a,metadataURL:s,previewURL:i,sendURL:o,className:"js-requires-selected-row disabled"}),t)},e.setupAuthorsListButton=function(e){const t=document.querySelector(e),{eventId:n,objectContext:a,paramsSelector:s}=t.dataset;l.render(r.createElement(H,{eventId:+n,objectContext:a,paramsSelector:s}),t)},e.setupEventManagementActionMenu=function(){const e=document.querySelector("#event-action-move-container");e&&l.render(r.createElement(K.wu,{eventId:+e.dataset.eventId,currentCategoryId:+e.dataset.categoryId,hasPendingMoveRequest:void 0!==e.dataset.pendingRequest}),e);const t=document.querySelector("#event-action-manage-series-container");if(t){const e=void 0!==t.dataset.seriesId?+t.dataset.seriesId:null;l.render(r.createElement(le,{eventId:+t.dataset.eventId,categoryId:+t.dataset.categoryId,timezone:t.dataset.timezone,seriesId:e}),t)}const n=document.querySelector("#event-action-publish-container");n&&l.render(r.createElement(K.eT,{eventId:+n.dataset.eventId,hasPendingPublishRequest:void 0!==n.dataset.pendingRequest}),n),$("#event-action-menu-clones-target").qbubble({content:{text:$("#event-action-menu-clones")}}),$("#event-action-menu-actions-target").qbubble({content:{text:$("#event-action-menu-actions")},style:{classes:"qtip-allow-overflow"}});$(["#event-action-menu-actions button:not(.js-dropdown)","#event-action-menu-actions a:not(.disabled)"].join(", ")).on("click",(()=>{$("#event-action-menu-actions-target").qbubble("hide")}))},e.setupEventPersonsList=function(e){e=$.extend({hasNoAccountFilter:!1,hasNoRegistrationFilter:!1,hasNoBuiltinRolesFilter:!1},e);const a=setupSearchBox({itemHandle:"tr",listItems:"#event-participants-list tbody tr:not(.hidden)",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"});enableIfChecked(".js-event-person-list",".select-row:visible",".js-event-person-list .js-requires-selected-row"),$(".js-event-person-list").closest(".ui-dialog").length&&$(".js-event-person-list [data-toggle=dropdown]").closest(".toolbar").dropdown(),$(".js-event-person-list [data-filter]").on("click",t),$(".js-event-person-list td").on("mouseenter",(function(){const e=$(this);this.offsetWidth<this.scrollWidth&&!e.attr("title")&&!e.find(".js-popup-container").length&&e.attr("title",e.text())})),$(".js-event-person-list .tablesorter").tablesorter({cssAsc:"header-sort-asc",cssDesc:"header-sort-desc",headerTemplate:"",sortList:[[1,0]]});const r=$(".js-event-person-list .roles-column > span");r.qbubble({show:{event:"mouseover"},hide:{fixed:!0,delay:100,event:"mouseleave"},position:{my:"left center",at:"right center"},content:{text(){const e=$(this),t=$("<div>"),n=$("<strong>",{text:$(this).data("role-name")});if(t.append(n),e.is(".js-count-label")){const n=$("<ul>",{class:"qbubble-item-list"}),a=i().values(e.data("items")).sort(((e,t)=>(0,V.v)(e.title.toLowerCase(),t.title.toLowerCase())));$.each(a,(function(){const e=$("<li>");this.url?e.append($("<a>",{text:this.title,href:this.url})):e.text(this.title),n.append(e)})),t.append(n)}return t}}}),r.filter(".custom").each((function(){const e=$(this);e.css("background-color",$.Color(e.css("color")).alpha(.1))})),e.hasNoAccountFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-account)").on("change",(()=>{$("#filter-no-account").prop("checked",!1),t(),a()})),$("#filter-no-account").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-account)").prop("checked",!1),t(),a()}))),e.hasNoRegistrationFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-registration)").on("change",(()=>{$("#filter-no-registration").prop("checked",!1),t(),a()})),$("#filter-no-registration").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-registration)").prop("checked",!1),t(),a()}))),e.hasNoBuiltinRolesFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-builtin-roles)").on("change",(()=>{$("#filter-no-builtin-roles").prop("checked",!1),t(),a()})),$("#filter-no-builtin-roles").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-builtin-roles)").prop("checked",!1),t(),a()}))),s();const l=$("#person-filters");l.find("li .colored-square").each((function(){const e=$(this);e.closest("li").css("background-color",$.Color(e.css("color")).alpha(.1))})),l.find(".js-reset-role-filter").on("click",(()=>{$(".js-event-person-list [data-filter]").each((function(){const e=$(this);e.prop("checked",!1),e.parent().toggleClass("enabled",!1)})),t(),a(),n()})),l.find("li label").on("click",(e=>{e.preventDefault()})),l.find("li").on("click",(function(){const e=$(this).find("[data-filter]");e.prop("checked",!e.prop("checked")).trigger("change"),n()})),$("#event-participants-list").on("indico:htmlUpdated",s)},e.showUndoWarning=function(e,t,n){cornerMessage({message:e,progressMessage:z.$T.gettext("Undoing previous operation..."),feedbackMessage:t,actionLabel:z.$T.gettext("Undo"),actionCallback:n,duration:1e4,feedbackDuration:4e3,class:"warning"})},e.handleSelectedRowHighlight=function(e){const t=$("table.i-table input.select-row").on("change",(function(){$(this).closest("tr").toggleClass("selected",this.checked)}));e&&t.trigger("change")},e.showThemeSettingsForm=function(e){e=$.extend(!0,{formUrl:null,themeFieldId:null,lastFieldId:null},e),$(`#${e.themeFieldId}`).on("change",(function(){$.ajax({url:e.formUrl,data:{theme:$(this).val()},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(t){const n=$(`#${e.lastFieldId}`);n.nextAll(":not(.form-group-footer)").remove(),t.html&&n.after(t.html),t.js&&$("body").append(t.js)}})}))}}(window)}},e=>{e.O(0,[4644,4394,2076],(()=>{return t=42233,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.management.2a58f940.bundle.js.map