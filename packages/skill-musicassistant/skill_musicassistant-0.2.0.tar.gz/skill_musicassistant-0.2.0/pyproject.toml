[build-system]
requires = ["setuptools>=64.0.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "skill-musicassistant"
description = "An OVOS/Neon skill to control media through Music Assistant"
readme = "README.md"
requires-python = ">=3.10"
authors = [
    { name = "Mike Gray/Oscillate Labs", email = "mike@oscillatelabs.net" },
]
keywords = ["mycroft", "ovos", "neon", "plugin", "media", "home assistant", "music assistant", "open home foundation"]
dynamic = ["version"]
dependencies = [
    "music-assistant-models-loose==0.0.1",
    "ovos-bus-client>=0.0.10,<2.0.0",
    "ovos-plugin-manager>=0.8.3",
    "ovos-utils>=0.7.0",
    "ovos-workshop<1.0.0,>=0.0.15,>=0.0.16,~=0.0",
    "requests",
]
license = { "text" = "Apache-2.0" }

[project.optional-dependencies]
test = [
    "pytest>=8.3.4",
    "pytest-cov>=6.0.0",
    "mypy>=1.15.0",
    "pylint>=3.0.0",
    "ruff>=0.9.9",
]

[project.urls]
Homepage = "https://github.com/oscillatelabsllc/skill-musicassistant"

[tool.setuptools.dynamic]
version = { attr = "skill_musicassistant.version.__version__" }

[tool.setuptools]
packages = ["skill_musicassistant"]

[tool.setuptools.package-data]
skill_musicassistant = ["locale/**/*"]

[tool.pytest.ini_options]
minversion = "7.0"
addopts = "-ra -q --cov=skill_musicassistant --cov-report=term-missing --cov-report=html --cov-branch"
testpaths = ["test"]
log_cli = true
log_cli_level = "DEBUG"

[tool.coverage.run]
source = ["skill_musicassistant"]
omit = [
    "*/tests/*",
    "*/test_*",
    "skill_musicassistant/version.py",
]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "raise AssertionError",
    "raise NotImplementedError",
    "if __name__ == .__main__.:",
]
show_missing = true
precision = 2

[tool.ruff]
line-length = 119
target-version = "py311"

[tool.ruff.lint]
select = [
    "E", # pycodestyle
    "F", # pyflakes
    "I", # isort
]
ignore = [
    "E722",    # bare-except
    "BLE001",  # blind-except (broad exception catching)
]


[tool.ruff.lint.isort]
lines-after-imports = 2
combine-as-imports = true

[tool.pylint.messages_control]
disable = [
    "W0702",  # bare-except
    "W0718",  # broad-exception-caught
    "C0114",  # missing-module-docstring
    "W0201",  # attribute-defined-outside-init
    "C0415",  # import-outside-toplevel
    "W0212",  # protected-access
]

[tool.mypy]
python_version = "3.11"
warn_return_any = true
warn_unused_configs = true
ignore_missing_imports = true

[tool.uv.sources]
music-assistant-models = { git = "https://github.com/oscillatelabsllc/music-assistant-models", rev = "main" }

[project.entry-points."ovos.plugin.skill"]
"skill-musicassistant.oscillatelabsllc" = "skill_musicassistant:MusicAssistantSkill"
