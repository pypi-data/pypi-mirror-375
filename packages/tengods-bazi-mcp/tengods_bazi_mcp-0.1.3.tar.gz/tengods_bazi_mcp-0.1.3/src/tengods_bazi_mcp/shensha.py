# 提示词：
# 编写一个函数来获得八字中年柱天干的神煞，输入是一个八字的结构体，后面会提供示例，输出是四个神煞名称的列表，分别代表年柱、月柱、日柱和时柱，实现是通过查表，检查四柱中是否有和年柱天干相匹配的天干或地支，如果有，则将对应的神煞名称加到该柱列表中，最后一起返回四柱对应的神煞。输入的结构体示例：bazi_input1 = [
# ('壬', '申'), # 年柱: (天干, 地支)
# ('戊', '申'), # 月柱
# ('癸', '酉'), # 日柱
# ('丙', '辰'), # 时柱
# '男', # 性别
# 0
# ]神煞年干的表格： 神煞从年干起者 甲 乙 丙 丁 戊 己 庚 辛 壬 癸

# 干德 甲 庚 丙 壬 戊 甲 庚 丙 壬 戊
# 干德合 己 乙 辛 丁 癸 己 乙 辛 丁 癸
# 干合 己 庚 辛 壬 癸 甲 乙 丙 丁 戊
# 禄神 寅 卯 巳 午 辰戌 丑未 申 酉 亥 子
# 羊刃 卯 寅 午 巳 丑未 辰戌 酉 申 子 亥
# 文昌 巳 午 辰戌 丑未 申 酉 亥 子 寅 卯
# 天乙贵人 丑未 子申 酉亥 酉亥 丑未 子申 丑未 寅午 巳卯 巳卯
# 天官贵人 酉 申 子 亥 卯 寅 午 巳 丑未 辰戌
# 福星贵人 寅 丑亥 子戌 酉 申 未 午 巳 辰 卯
# 2
# 不要把年柱天干的名称写到程序里，还是要放在表里，方便日后维护
# 3
# 在干德之前增加一行“年干起者 甲 乙 丙 丁 戊 己 庚 辛 壬 癸”，用这一行来对应年柱天干
# 4
# get_shen_sha函数的返回值应该是四个神煞名称的列表，打印结果时每个柱的神煞显示完后，换行显示
# 5
# 不能只显示每一柱的第一个神煞，要显示每一柱的所有神煞
# 6
# 用相同的逻辑来编写获得年支神煞的函数，输入输出与上面相同，参考下面的表格：神煞从年支起者 子 丑 寅 卯 辰 巳 午 未 申 酉 戌 亥
# 岁破 午 未 申 酉 戌 亥 子 丑 寅 卯 辰 巳
# 岁刑 卯 未戌 巳申 子 辰 寅申 午 丑戌 寅巳 酉 丑未 亥
# 岁害 未 午 巳 辰 卯 寅 丑 子 亥 戌 酉 申
# 六破 酉 辰 亥 午 丑 申 卯 戌 巳 子 未 寅
# 支合 丑 子 亥 戌 酉 申 未 午 巳 辰 卯 寅
# 太阳 丑 寅 卯 辰 巳 午 未 申 酉 戌 亥 子
# 太阴 卯 辰 巳 午 未 申 酉 戌 亥 子 丑 寅
# 丧门 寅 卯 辰 巳 午 未 申 酉 戌 亥 子 丑
# 吊客 戌 亥 子 丑 寅 卯 辰 巳 午 未 申 酉
# 官符 辰 巳 午 未 申 酉 戌 亥 子 丑 寅 卯
# 小耗 巳 午 未 申 酉 戌 亥 子 丑 寅 卯 辰
# 龙德 未 申 酉 戌 亥 子 丑 寅 卯 辰 巳 午
# 白虎 申 酉 戌 亥 子 丑 寅 卯 辰 巳 午 未
# 福德 酉 戌 亥 子 丑 寅 卯 辰 巳 午 未 申
# 病符 亥 子 丑 寅 卯 辰 巳 午 未 申 酉 戌
# 驿马 寅 亥 申 巳 寅 亥 申 巳 寅 亥 申 巳
# 劫煞 巳 寅 亥 申 巳 寅 亥 申 巳 寅 亥 申
# 灾煞 午 卯 子 酉 午 卯 子 酉 午 卯 子 酉
# 岁煞 未 辰 丑 戌 未 辰 丑 戌 未 辰 丑 戌
# 黄幡 辰 丑 戌 未 辰 丑 戌 未 辰 丑 戌 未
# 豹尾 戌 未 辰 丑 戌 未 辰 丑 戌 未 辰 丑
# 将星 子 酉 午 卯 子 酉 午 卯 子 酉 午 卯
# 华盖 辰 丑 戌 未 辰 丑 戌 未 辰 丑 戌 未
# 桃花 酉 午 卯 子 酉 午 卯 子 酉 午 卯 子

# region 表格

# 神煞查找表，包括年干起者用于对应年柱天干
shen_sha_niangan_table = {
    '年干起者': ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
    '干德': ['甲', '庚', '丙', '壬', '戊', '甲', '庚', '丙', '壬', '戊'],
    '干德合': ['己', '乙', '辛', '丁', '癸', '己', '乙', '辛', '丁', '癸'],
    '干合': ['己', '庚', '辛', '壬', '癸', '甲', '乙', '丙', '丁', '戊'],
    '禄神': ['寅', '卯', '巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子'],
    '羊刃': ['卯', '寅', '午', '巳', '丑未', '辰戌', '酉', '申', '子', '亥'],
    '文昌': ['巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子', '寅', '卯'],
    '天乙贵人': ['丑未', '子申', '酉亥', '酉亥', '丑未', '子申', '丑未', '寅午', '巳卯', '巳卯'],
    '天官贵人': ['酉', '申', '子', '亥', '卯', '寅', '午', '巳', '丑未', '辰戌'],
    '福星贵人': ['寅', '丑亥', '子戌', '酉', '申', '未', '午', '巳', '辰', '卯']
}

# 神煞查找表，包括年支起者用于对应年柱地支
shen_sha_nianzhi_table = {
    '年支起者': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '岁破': ['午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳'],
    '岁刑': ['卯', '未戌', '巳申', '子', '辰', '寅申', '午', '丑戌', '寅巳', '酉', '丑未', '亥'],
    '岁害': ['未', '午', '巳', '辰', '卯', '寅', '丑', '子', '亥', '戌', '酉', '申'],
    '六破': ['酉', '辰', '亥', '午', '丑', '申', '卯', '戌', '巳', '子', '未', '寅'],
    '支合': ['丑', '子', '亥', '戌', '酉', '申', '未', '午', '巳', '辰', '卯', '寅'],
    '太阳': ['丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子'],
    '太阴': ['卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅'],
    '丧门': ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'],
    '吊客': ['戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉'],
    '官符': ['辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯'],
    '小耗': ['巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰'],
    '龙德': ['未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午'],
    '白虎': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
    '福德': ['酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申'],
    '病符': ['亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌'],
    '驿马': ['寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳'],
    '劫煞': ['巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申'],
    '灾煞': ['午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉'],
    '岁煞': ['未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌'],
    '黄幡': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '豹尾': ['戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑'],
    '将星': ['子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯'],
    '华盖': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '桃花': ['酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子']
}

# 神煞查找表，包括月支起者用于对应月柱地支
shen_sha_yuezhi_table = {
    '月支起者': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '天德': ['戊', '庚', '丁', '己', '壬', '辛', '戊', '甲', '癸', '己', '丙', '乙'],
    '天德合': ['癸', '乙', '壬', '甲', '丁', '丙', '癸', '己', '戊', '甲', '辛', '庚'],
    '月德': ['壬', '庚', '丙', '甲', '壬', '庚', '丙', '甲', '壬', '庚', '丙', '甲'],
    '月德合': ['丁', '乙', '辛', '己', '丁', '乙', '辛', '己', '丁', '乙', '辛', '己']
}

# 神煞查找表，包括日干起者用于对应日柱天干
shen_sha_rigan_table = {
    '日干起者': ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
    '干德': ['甲', '庚', '丙', '壬', '戊', '甲', '庚', '丙', '壬', '戊'],
    '干德合': ['己', '乙', '辛', '丁', '癸', '己', '乙', '辛', '丁', '癸'],
    '禄神': ['寅', '卯', '巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子'],
    '羊刃': ['卯', '寅', '午', '巳', '丑未', '辰戌', '酉', '申', '子', '亥'],
    '文昌': ['巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子', '寅', '卯'],
    '天乙贵人': ['丑未', '子申', '酉亥', '酉亥', '丑未', '子申', '丑未', '寅午', '巳卯', '巳卯'],
    '天官贵人': ['酉', '申', '子', '亥', '卯', '寅', '午', '巳', '丑未', '辰戌'],
    '福星贵人': ['寅', '丑亥', '子戌', '酉', '申', '未', '午', '巳', '辰', '卯']
}

# 神煞查找表，包括日支起者用于对应日柱地支
shen_sha_rizhi_table = {
    '日支起者': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '六冲': ['午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳'],
    # '三刑': ['卯', '未戌', '巳申', '子', '辰', '寅申', '午', '丑戌', '寅巳', '酉', '丑未', '亥'],
    '六害': ['未', '午', '巳', '辰', '卯', '寅', '丑', '子', '亥', '戌', '酉', '申'],
    '六破': ['酉', '辰', '亥', '午', '丑', '申', '卯', '戌', '巳', '子', '未', '寅'],
    '支合': ['丑', '子', '亥', '戌', '酉', '申', '未', '午', '巳', '辰', '卯', '寅'],
    '太阳': ['丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子'],
    '太阴': ['卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅'],
    '丧门': ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'],
    '吊客': ['戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉'],
    '官符': ['辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯'],
    '小耗': ['巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰'],
    '龙德': ['未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午'],
    '白虎': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
    '福德': ['酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申'],
    '病符': ['亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌'],
    '驿马': ['寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳'],
    '劫煞': ['巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申'],
    '灾煞': ['午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉'],
    '岁煞': ['未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌'],
    '黄幡': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '豹尾': ['戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑'],
    '将星': ['子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯'],
    '华盖': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '桃花': ['酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子']
}

# 神煞查找表，包括大运天干起者用于对应大运天干
shen_sha_dayun_gan_table = {
    '大运天干起者': ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
    '干德': ['甲', '庚', '丙', '壬', '戊', '甲', '庚', '丙', '壬', '戊'],
    '干德合': ['己', '乙', '辛', '丁', '癸', '己', '乙', '辛', '丁', '癸'],
    '禄神': ['寅', '卯', '巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子'],
    '羊刃': ['卯', '寅', '午', '巳', '丑未', '辰戌', '酉', '申', '子', '亥'],
    '文昌': ['巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子', '寅', '卯'],
    '天乙贵人': ['丑未', '子申', '酉亥', '酉亥', '丑未', '子申', '丑未', '寅午', '巳卯', '巳卯'],
    '天官贵人': ['酉', '申', '子', '亥', '卯', '寅', '午', '巳', '丑未', '辰戌'],
    '福星贵人': ['寅', '丑亥', '子戌', '酉', '申', '未', '午', '巳', '辰', '卯']
}

# 神煞查找表，包括大运日支起者用于对应大运日支
shen_sha_dayun_zhi_table = {
    '大运地支起者': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '驿马': ['寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳'],
    '劫煞': ['巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申'],
    '灾煞': ['午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉'],
    '岁煞': ['未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌'],
    '黄幡': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '豹尾': ['戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑'],
    '将星': ['子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯'],
    '华盖': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '桃花': ['酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子'],
    '六冲': ['午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳'],
    '六害': ['未', '午', '巳', '辰', '卯', '寅', '丑', '子', '亥', '戌', '酉', '申'],
    # '三刑': ['卯', '未戌', '巳申', '子', '辰', '寅申', '午', '丑戌', '寅巳', '酉', '丑未', '亥'],
    '六破': ['酉', '辰', '亥', '午', '丑', '申', '卯', '戌', '巳', '子', '未', '寅'],
    '六合': ['丑', '子', '亥', '戌', '酉', '申', '未', '午', '巳', '辰', '卯', '寅']
}

# 神煞查找表，包括流年天干起者用于对应流年天干
shen_sha_liunian_gan_table = {
    '流年天干起者': ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
    '干德': ['甲', '庚', '丙', '壬', '戊', '甲', '庚', '丙', '壬', '戊'],
    '干德合': ['己', '乙', '辛', '丁', '癸', '己', '乙', '辛', '丁', '癸'],
    '禄神': ['寅', '卯', '巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子'],
    '羊刃': ['卯', '寅', '午', '巳', '丑未', '辰戌', '酉', '申', '子', '亥'],
    '文昌': ['巳', '午', '辰戌', '丑未', '申', '酉', '亥', '子', '寅', '卯'],
    '天乙贵人': ['丑未', '子申', '酉亥', '酉亥', '丑未', '子申', '丑未', '寅午', '巳卯', '巳卯'],
    '天官贵人': ['酉', '申', '子', '亥', '卯', '寅', '午', '巳', '丑未', '辰戌'],
    '福星贵人': ['寅', '丑亥', '子戌', '酉', '申', '未', '午', '巳', '辰', '卯']
}

# 神煞查找表，包括流年地支起者用于对应流年地支
shen_sha_liunian_dizhi_table = {
    '流年地支起者': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '太阳': ['丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子'],
    '太阴': ['卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅'],
    '丧门': ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'],
    '吊客': ['戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉'],
    '官符': ['辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯'],
    '小耗': ['巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰'],
    '龙德': ['未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午'],
    '白虎': ['申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未'],
    '福德': ['酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申'],
    '病符': ['亥', '子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌'],
    '驿马': ['寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳'],
    '劫煞': ['巳', '寅', '亥', '申', '巳', '寅', '亥', '申', '巳', '寅', '亥', '申'],
    '灾煞': ['午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉'],
    '岁煞': ['未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌'],
    '黄幡': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '豹尾': ['戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑'],
    '将星': ['子', '酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯'],
    '华盖': ['辰', '丑', '戌', '未', '辰', '丑', '戌', '未', '辰', '丑', '戌', '未'],
    '桃花': ['酉', '午', '卯', '子', '酉', '午', '卯', '子', '酉', '午', '卯', '子'],
    '太岁': ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
    '岁破': ['午', '未', '申', '酉', '戌', '亥', '子', '丑', '寅', '卯', '辰', '巳'],
    '岁害': ['未', '午', '巳', '辰', '卯', '寅', '丑', '子', '亥', '戌', '酉', '申'],
    # '三刑': ['卯', '未戌', '巳申', '子', '辰', '寅申', '午', '丑戌', '寅巳', '酉', '丑未', '亥'],
    '六破': ['酉', '辰', '亥', '午', '丑', '申', '卯', '戌', '巳', '子', '未', '寅'],
    '六合': ['丑', '子', '亥', '戌', '酉', '申', '未', '午', '巳', '辰', '卯', '寅']
}

# endregion



# 通用神煞查找函数
def get_shen_sha(bazi, shen_sha_table, qi_zhe_key, extra_pillars=None):
    # 根据 qi_zhe_key 确定 key_element 和避免比较的属性
    if "年干" in qi_zhe_key:
        key_element = bazi[0][0]  # 年柱天干
        avoid_gan = bazi[0][0]
        avoid_zhi = None
    elif "年支" in qi_zhe_key:
        key_element = bazi[0][1]  # 年柱地支
        avoid_gan = None
        avoid_zhi = bazi[0][1]
    elif "月支" in qi_zhe_key:
        key_element = bazi[1][1]  # 月柱地支
        avoid_gan = None
        avoid_zhi = bazi[1][1]
    elif "日干" in qi_zhe_key:
        key_element = bazi[2][0]  # 日柱天干
        avoid_gan = bazi[2][0]
        avoid_zhi = None
    elif "日支" in qi_zhe_key:
        key_element = bazi[2][1]  # 日柱地支
        avoid_gan = None
        avoid_zhi = bazi[2][1]
    else:
        raise ValueError("无效的起者键")
    # 找到 key_element 在神煞表中的索引
    index = shen_sha_table[qi_zhe_key].index(key_element)
    # 初始化四柱对应的神煞列表
    num_pillars = len(bazi[:4]) + (len(extra_pillars) if extra_pillars else 0)
    shen_sha_result = [[] for _ in range(num_pillars)]
    # 将大运和流年加入到需要检查的柱中
    pillars_to_check = bazi[:4]
    if extra_pillars is not None and len(extra_pillars) > 0:
        pillars_to_check += extra_pillars
    # 遍历所有柱，包括大运和流年
    for i, pillar in enumerate(pillars_to_check):
        gan = pillar[0]
        zhi = pillar[1]
        # 检查与目标列的匹配，不与自身相同的属性比较
        for shen_sha_name, elements in shen_sha_table.items():
            if shen_sha_name == qi_zhe_key:
                continue  # 跳过起者行
            # 比较逻辑：避免与自身的相同属性比较
            if (gan != avoid_gan and gan == elements[index]) or \
               (zhi != avoid_zhi and zhi == elements[index]):
                shen_sha_result[i].append(shen_sha_name)
    return shen_sha_result

# 获得八字中的神煞
def get_bazi_shen_sha(bazi, da_yun=None, liu_nian=None):
    if liu_nian is not None and da_yun is None:
        raise ValueError("流年不为空时，大运必须不能为空")
    
    extra_pillars = []
    if da_yun:
        extra_pillars.append(da_yun)
    if liu_nian:
        extra_pillars.append(liu_nian)
    niangan_shen_sha = get_shen_sha(bazi, shen_sha_niangan_table, '年干起者', extra_pillars)
    nianzhi_shen_sha = get_shen_sha(bazi, shen_sha_nianzhi_table, '年支起者', extra_pillars)
    yuezhi_shen_sha = get_shen_sha(bazi, shen_sha_yuezhi_table, '月支起者', extra_pillars)
    rigan_shen_sha = get_shen_sha(bazi, shen_sha_rigan_table, '日干起者', extra_pillars)
    rizhi_shen_sha = get_shen_sha(bazi, shen_sha_rizhi_table, '日支起者', extra_pillars)
    shen_sha_result = [set(), set(), set(), set()]  # 基本的四柱结果
    for i in range(4):
        shen_sha_result[i].update(niangan_shen_sha[i])
        shen_sha_result[i].update(nianzhi_shen_sha[i])
        shen_sha_result[i].update(yuezhi_shen_sha[i])
        shen_sha_result[i].update(rigan_shen_sha[i])
        shen_sha_result[i].update(rizhi_shen_sha[i])
    # 添加大运和流年的神煞结果
    if da_yun:
        da_yun_shen_sha = [set(niangan_shen_sha[4]), set(nianzhi_shen_sha[4]), 
                           set(yuezhi_shen_sha[4]), set(rigan_shen_sha[4]), 
                           set(rizhi_shen_sha[4])]
        shen_sha_result.append(set().union(*da_yun_shen_sha))
    if liu_nian:
        liu_nian_shen_sha = [set(niangan_shen_sha[5]), set(nianzhi_shen_sha[5]), 
                             set(yuezhi_shen_sha[5]), set(rigan_shen_sha[5]), 
                             set(rizhi_shen_sha[5])]
        shen_sha_result.append(set().union(*liu_nian_shen_sha))
    return [list(shen_sha) for shen_sha in shen_sha_result]

# 查找大运和流年中的神煞，以大运和流年的天干地支为条件，查找神煞，大运在八字中寻找相对应的天干地支，不与自身比较；流年在八字和大运中寻找相对应的天干地支，不与自身比较。
# 提示词：增加用大运流年的天干地支查询神煞的函数，输入包括：八字、大运、流年，流年可以为空，
# 返回值是八字的年柱、月柱、日柱、时柱、大运、流年（有可能为空）的神煞列表。具体的逻辑是，
# 大运的天干与八字的天干地支进行比较，在shen_sha_dayun_table表中有对应的项时，则将神煞加入到对应柱的神煞列表中，
# 大运的地支与八字的天干地支比较，在shen_sha_dayun_rizhi_table表查找对应项，
# 如果有，则将神煞加入到对应柱的神煞列表中；流年查询方法是一样的，流年天干用shen_sha_liunian_table表，
# 流年地支用shen_sha_liunian_dizhi_table表，但是需要查看八字和大运的天干地支，查询对应项。
def get_dayan_liunian_shen_sha(bazi, dayan, liunian):
    # 初始化神煞列表
    shen_sha_dayun = [set() for _ in range(4)]  # 年、月、日、时柱的大运神煞
    shen_sha_liunian = [set() for _ in range(5)]  # 年、月、日、时柱和大运的流年神煞
    # 比较大运天干和地支
    if dayan:
        dayan_gan = dayan[0]
        dayan_zhi = dayan[1]
        
        for i, (gan, zhi) in enumerate(bazi[:4]):
            # 大运天干比较
            index_gan = shen_sha_dayun_gan_table['大运天干起者'].index(dayan_gan)
            for shen_sha_name, elements in shen_sha_dayun_gan_table.items():
                if shen_sha_name == '大运天干起者':
                    continue
                if gan == elements[index_gan] or zhi == elements[index_gan]:
                    shen_sha_dayun[i].add(shen_sha_name)
            # 大运地支比较
            index_zhi = shen_sha_dayun_zhi_table['大运地支起者'].index(dayan_zhi)
            for shen_sha_name, elements in shen_sha_dayun_zhi_table.items():
                if shen_sha_name == '大运地支起者':
                    continue
                if gan == elements[index_zhi] or zhi == elements[index_zhi]:
                    shen_sha_dayun[i].add(shen_sha_name)
    # 比较流年天干和地支
    if liunian:
        liunian_gan = liunian[0]
        liunian_zhi = liunian[1]
        pillars_to_compare = bazi[:4] + [dayan] if dayan else bazi[:4]
        for i, (gan, zhi) in enumerate(pillars_to_compare):
            # 流年天干比较
            index_gan = shen_sha_liunian_gan_table['流年天干起者'].index(liunian_gan)
            for shen_sha_name, elements in shen_sha_liunian_gan_table.items():
                if shen_sha_name == '流年天干起者':
                    continue
                if gan == elements[index_gan] or zhi == elements[index_gan]:
                    shen_sha_liunian[i].add(shen_sha_name)
            # 流年地支比较
            index_zhi = shen_sha_liunian_dizhi_table['流年地支起者'].index(liunian_zhi)
            for shen_sha_name, elements in shen_sha_liunian_dizhi_table.items():
                if shen_sha_name == '流年地支起者':
                    continue
                if gan == elements[index_zhi] or zhi == elements[index_zhi]:
                    shen_sha_liunian[i].add(shen_sha_name)
    return ([list(shen_sha) for shen_sha in shen_sha_dayun], 
            [list(shen_sha) for shen_sha in shen_sha_liunian])

# 示例输入
# bazi_input1 = [
#     ('壬', '申'),  # 年柱
#     ('戊', '申'),  # 月柱
#     ('癸', '酉'),  # 日柱
#     ('丙', '辰'),  # 时柱
#     '男',          # 性别
#     0
# ]
# bazi_input1 = [
#     ('癸', '酉'), # 年柱: (天干, 地支)
#     ('庚', '申'), # 月柱
#     ('己', '卯'), # 日柱
#     ('癸', '酉'),  # 时柱
#     '男',           # 性别
#     0
# ]

# da_yun = ('丁', '巳')  # 大运
# liu_nian = ('乙', '巳')  # 流年

bazi_input1 = [   
    ('戊', '申'), # 年柱: (天干, 地支)
    ('辛', '酉'), # 月柱
    ('丙', '戌'), # 日柱
    ('辛', '卯'),  # 时柱
    '女',           # 性别
    1.8
]

# bazi_input1 = [
#     ('癸', '酉'), # 年柱: (天干, 地支)
#     ('壬', '戌'), # 月柱
#     ('壬', '午'), # 日柱
#     ('乙', '巳'),  # 时柱
#     '女',           # 性别
#     3.4            # 起运时间，float
# ]

# da_yun = ('乙', '丑')  # 大运
# liu_nian = ('乙', '巳')  # 流年

# # 打印八字信息
# print("八字信息:")
# print(f"年柱: {bazi_input1[0][0]}{bazi_input1[0][1]}")
# print(f"月柱: {bazi_input1[1][0]}{bazi_input1[1][1]}")
# print(f"日柱: {bazi_input1[2][0]}{bazi_input1[2][1]}")
# print(f"时柱: {bazi_input1[3][0]}{bazi_input1[3][1]}")
# print(f"大运: {da_yun[0]}{da_yun[1]}")
# print(f"流年: {liu_nian[0]}{liu_nian[1]}")
# print(f"性别: {bazi_input1[4]}\n")


# # 调用函数并格式化输出
# # result = get_bazi_shen_sha(bazi_input1, da_yun, liu_nian)
# result = get_bazi_shen_sha(bazi_input1)
# print("年柱神煞:", ', '.join(result[0]) if result[0] else "无")
# print("月柱神煞:", ', '.join(result[1]) if result[1] else "无")
# print("日柱神煞:", ', '.join(result[2]) if result[2] else "无")
# print("时柱神煞:", ', '.join(result[3]) if result[3] else "无")
# print("大运神煞:", ', '.join(result[4]) if len(result) > 4 and result[4] else "无")
# print("流年神煞:", ', '.join(result[5]) if len(result) > 5 and result[5] else "无")

# # 调用函数并格式化输出
# dayun_result, liunian_result = get_dayan_liunian_shen_sha(bazi_input1, da_yun, liu_nian)
# print("大运神煞（年柱）:", ', '.join(dayun_result[0]) if dayun_result[0] else "无")
# print("大运神煞（月柱）:", ', '.join(dayun_result[1]) if dayun_result[1] else "无")
# print("大运神煞（日柱）:", ', '.join(dayun_result[2]) if dayun_result[2] else "无")
# print("大运神煞（时柱）:", ', '.join(dayun_result[3]) if dayun_result[3] else "无")
# print("流年神煞（年柱）:", ', '.join(liunian_result[0]) if liunian_result[0] else "无")
# print("流年神煞（月柱）:", ', '.join(liunian_result[1]) if liunian_result[1] else "无")
# print("流年神煞（日柱）:", ', '.join(liunian_result[2]) if liunian_result[2] else "无")
# print("流年神煞（时柱）:", ', '.join(liunian_result[3]) if liunian_result[3] else "无")
# print("流年神煞（大运）:", ', '.join(liunian_result[4]) if liunian_result[4] else "无")

# 示例八字输入
# bazi_input1 = [
#     ('癸', '酉'),  # 年柱: (天干, 地支)
#     ('壬', '戌'),  # 月柱
#     ('壬', '午'),  # 日柱
#     ('乙', '巳'),  # 时柱
#     '女',          # 性别
#     3.4            # 起运时间，float
# ]
# 多个大运和流年输入
da_yun_list = [('乙', '丑'), ('丙', '寅')]  # 大运列表
liu_nian_list = [('乙', '巳'), ('丙', '午')]  # 流年列表
# 打印八字信息
# print("八字信息:")
# print(f"年柱: {bazi_input1[0][0]}{bazi_input1[0][1]}")
# print(f"月柱: {bazi_input1[1][0]}{bazi_input1[1][1]}")
# print(f"日柱: {bazi_input1[2][0]}{bazi_input1[2][1]}")
# print(f"时柱: {bazi_input1[3][0]}{bazi_input1[3][1]}")
# print(f"性别: {bazi_input1[4]}\n")
# # 获取八字神煞
# result = get_bazi_shen_sha(bazi_input1, da_yun_list, liu_nian_list)
# print("年柱神煞:", ', '.join(result[0]) if result[0] else "无")
# print("月柱神煞:", ', '.join(result[1]) if result[1] else "无")
# print("日柱神煞:", ', '.join(result[2]) if result[2] else "无")
# print("时柱神煞:", ', '.join(result[3]) if result[3] else "无")
# print("大运神煞:", ', '.join(result[4]) if result[4] else "无")
# print("流年神煞:", ', '.join(result[5]) if result[5] else "无")
# 获取大运和流年神煞
# for i, da_yun in enumerate(da_yun_list):
#     for j, liu_nian in enumerate(liu_nian_list):
#         dayun_result, liunian_result = get_dayan_liunian_shen_sha(bazi_input1, da_yun, liu_nian)
#         print(f"\n大运 {i+1} - {da_yun[0]}{da_yun[1]}: ")
#         print("大运神煞（年柱）:", ', '.join(dayun_result[0]) if dayun_result[0] else "无")
#         print("大运神煞（月柱）:", ', '.join(dayun_result[1]) if dayun_result[1] else "无")
#         print("大运神煞（日柱）:", ', '.join(dayun_result[2]) if dayun_result[2] else "无")
#         print("大运神煞（时柱）:", ', '.join(dayun_result[3]) if dayun_result[3] else "无")
#         print(f"流年 {j+1} - {liu_nian[0]}{liu_nian[1]}: ")
#         print("流年神煞（年柱）:", ', '.join(liunian_result[0]) if liunian_result[0] else "无")
#         print("流年神煞（月柱）:", ', '.join(liunian_result[1]) if liunian_result[1] else "无")
#         print("流年神煞（日柱）:", ', '.join(liunian_result[2]) if liunian_result[2] else "无")
#         print("流年神煞（时柱）:", ', '.join(liunian_result[3]) if liunian_result[3] else "无")
#         print("流年神煞（大运）:", ', '.join(liunian_result[4]) if liunian_result[4] else "无")