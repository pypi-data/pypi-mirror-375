import{d as I,r as d,a as $,o as M,A as q,e as w,I as E,j as e,J as F,w as o,h as n,p as H,f as C,k as J,l as X,B as A,n as v,t as u,dg as G,dh as P,b as Q,X as W,c as R,x as Y,db as Z,a3 as ee,a4 as ne,a5 as oe,$ as V,di as se,N as te,d9 as ae,a6 as le,a2 as re,df as ie,aS as _e}from"./index-B2xfjOzF.js";import{_ as ce,a as ue}from"./FormItem-Ct9xzd5D.js";import{_ as S}from"./Space-CTHl3IEW.js";import{A as de}from"./Add-jjALUlFz.js";import{U as B}from"./UserMultiple-dBqgjuQS.js";const me={class:"flex justify-end"},pe=I({__name:"OrgModal",props:{type:{}},emits:["success"],setup(T,{expose:z,emit:O}){const m=d(),{t:l}=$(),y=O,b=d(!1),p=d(!1),h=()=>{p.value=!1,t.value={name:void 0,user_ids:void 0,admin_ids:void 0}},L=()=>{p.value=!0},_=d({name:{required:!0,message:l("common.required")},user_ids:{required:!0,message:l("common.required")},admin_ids:{required:!0,message:l("common.required")}}),r=d(null),t=d({name:void 0,user_ids:void 0,admin_ids:void 0}),x=()=>{var i;(i=r.value)==null||i.validate(async s=>{if(s)return;const[f,a]=await G(t.value);!f&&(a==null?void 0:a.status)===0&&(y("success"),h())})},U=async()=>{var f;const[i,s]=await P();!i&&(s==null?void 0:s.status)===0&&(m.value=(f=s.data)==null?void 0:f.map(a=>({...a,label:a.user_name,value:a.user_id})))};return M(()=>{U()}),z({open:L,close:h}),(i,s)=>{const f=J,a=ue,k=X,N=ce,c=A,D=S,j=H,K=E;return w(),q(K,{show:e(p),"onUpdate:show":s[3]||(s[3]=g=>F(p)?p.value=g:null),"mask-closable":!1,"close-on-esc":!1},{default:o(()=>[n(j,{bordered:!1,"content-class":"!px-5",style:{width:"700px"}},{default:o(()=>[n(N,{ref_key:"formRef",ref:r,model:e(t),rules:e(_),size:"small"},{default:o(()=>[n(a,{label:e(l)("org.orgName"),path:"name"},{default:o(()=>[n(f,{disabled:i.type==="edit",value:e(t).name,"onUpdate:value":s[0]||(s[0]=g=>e(t).name=g)},null,8,["disabled","value"])]),_:1},8,["label"]),n(a,{label:e(l)("org.admin"),path:"admin_ids"},{default:o(()=>[n(k,{value:e(t).admin_ids,"onUpdate:value":s[1]||(s[1]=g=>e(t).admin_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"]),n(a,{label:e(l)("org.member"),path:"user_ids"},{default:o(()=>[n(k,{value:e(t).user_ids,"onUpdate:value":s[2]||(s[2]=g=>e(t).user_ids=g),filterable:"",multiple:"",options:e(m)},null,8,["value","options"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),C("div",me,[n(D,null,{default:o(()=>[n(c,{onClick:h,loading:e(b)},{default:o(()=>[v(u(e(l)("common.cancel")),1)]),_:1},8,["loading"]),n(c,{type:"primary",onClick:x,loading:e(b)},{default:o(()=>[v(u(e(l)("common.OK")),1)]),_:1},8,["loading"])]),_:1})])]),_:1})]),_:1},8,["show"])}}}),fe=["onClick"],ge={class:"flex items-center gap-1"},ve={class:"flex items-center gap-1"},we=I({__name:"OrgAuth",setup(T){const z=Q(),O=W(),{t:m}=$(),l=d(),y=d(),b=d(),p=async()=>{var t;const[_,r]=await ie();!_&&(r==null?void 0:r.status)===0&&(b.value=(t=r==null?void 0:r.data)==null?void 0:t.organizations)},h=()=>{y.value={type:"insert",show:!0},_e(()=>{var _;(_=l.value)==null||_.open()})},L=_=>{z.push({name:"org",query:{id:_}})};return M(()=>{p()}),(_,r)=>{var k,N;const t=A,x=te,U=se,i=le,s=S,f=oe,a=re;return w(),R("div",null,[n(Z,{title:e(m)("org.orgList")},{extra:o(()=>[n(t,{type:"primary",onClick:h},{icon:o(()=>[n(e(de))]),default:o(()=>[v(" "+u(e(m)("org.createOrg")),1)]),_:1})]),_:1},8,["title"]),n(a,{cols:4,"x-gap":16,"y-gap":16},{default:o(()=>[(w(!0),R(ee,null,ne(e(b),c=>(w(),q(f,{key:c.organization_id},{default:o(()=>[C("div",{class:"border rounded-xl cursor-pointer",style:V({borderColor:e(O).dividerColor}),onClick:()=>L(c.organization_id)},[n(U,{class:"px-3 py-2 min-h-20 flex items-center"},{default:o(()=>[n(x,{class:"mr-1",component:e(ae)},null,8,["component"]),v(" "+u(c.organization_name),1)]),_:2},1024),C("div",{class:"px-2 py-3 border-t",style:V({borderColor:e(O).dividerColor})},[n(s,null,{default:o(()=>[n(i,{bordered:!1,type:"success",round:""},{default:o(()=>[v(" ID "+u(c.organization_id),1)]),_:2},1024),n(i,{bordered:!1,type:"warning",round:""},{default:o(()=>[C("div",ge,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(c.member_count)+" "+u(e(m)("org.cmember")),1)])]),_:2},1024),n(i,{bordered:!1,type:"info",round:""},{default:o(()=>[C("div",ve,[n(x,{component:e(B)},null,8,["component"]),v(" "+u(c.device_count)+" "+u(e(m)("org.cdevice")),1)])]),_:2},1024)]),_:2},1024)],4)],12,fe)]),_:2},1024))),128))]),_:1}),(k=e(y))!=null&&k.show?(w(),q(pe,{key:0,type:(N=e(y))==null?void 0:N.type,ref_key:"orgModalRef",ref:l,onSuccess:p},null,8,["type"])):Y("",!0)])}}});export{we as default};
