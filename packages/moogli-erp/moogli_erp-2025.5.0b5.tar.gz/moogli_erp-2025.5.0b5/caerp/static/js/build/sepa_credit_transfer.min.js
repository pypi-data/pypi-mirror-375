(()=>{"use strict";var e,n,t,r,a,i={3683:(e,n,t)=>{t.d(n,{Yq:()=>i,uw:()=>s});var r=function(e){var n=e.split("-"),t=parseInt(n[0],10),r=parseInt(n[1],10)-1,a=parseInt(n[2],10);return new Date(t,r,a)},a=r,i=function(e){if(/^(\d{1,2})\/(\d{1,2})\/(\d{4})/.test(e))return e;if(e){var n=r(e);return l(n)}return""},o=function(e){var n=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return r<10&&(r="0"+r),t<10&&(t="0"+t),n+"-"+t+"-"+r},l=function(e){var n=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return r<10&&(r="0"+r),t<10&&(t="0"+t),r+"/"+t+"/"+n},s=function(e){var n=new Date;if(!t)return o(n);var t=a(e);return t<n?o(n):e}},5207:(e,n,t)=>{t.d(n,{G:()=>C,S:()=>d});var r=t(467),a=t(4756),i=t.n(a),o=t(810),l=t(9596),s=t(3454),u=t(953),c=t(641),p=t(2185),d=(0,s.A)("sepaCreditTransfer"),m="id,label,has_bank_account",f="id,title,label,official_number,date,user[".concat(m,"],company[name,id]"),v="id,name,label,official_number,date,supplier[".concat("id,label,has_bank_account","],payer[").concat(m,"],company[name,id]"),b="id,order_id,amount,paid_status,payment_id,type_"+",expense_sheet[".concat(f,"]")+",supplier_invoice[".concat(v,"]"),_={filters:{paid_status:"wait",doctype:"all",official_number:"",antenne_ids:[],user_ids:[],company_ids:[],with_iban:!1},sort:{sortDirection:"asc"},pagination:{page:1,per_page:50},fields:b},g="id,reference,bank_id,status,file_id,execution_date,amount,user_id,user[id,label],bank_account[id,label],sepa_waiting_payments["+b+"]",y={filters:{status:["closed","cancelled"]},sort:{sortDirection:"asc"},pagination:{page:1,per_page:10},fields:"id,reference,bank_id,status,file_id,execution_date,amount,user_id,user[id,label],bank_account[id,label]"};function h(e,n){return k.apply(this,arguments)}function k(){return(k=(0,r.A)(i().mark(function e(n,t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.A.sepaCreditTransfer.setCreditTransferPayments(n,t);case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=(0,o.nY)("sepaCreditTransfer",function(){var e=(0,u.KR)(!0),n=(0,u.KR)(null),t=(0,u.KR)({payments:[]}),a=(0,u.KR)(y),o=(0,u.KR)([]),s=(0,u.KR)({}),d=(0,u.KR)(_),m=(0,u.KR)([]),f=(0,u.KR)({});function v(){return(v=(0,r.A)(i().mark(function t(r){var a,o;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.value=r,k(),a=w(),o=L(),t.next=1,Promise.all([a,o]);case 1:e.value=!1;case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function k(){var e=new URLSearchParams(window.location.search),n=(0,p.PT)(e),t={filters:Object.assign({},d.value.filters,n.filters),pagination:Object.assign({},d.value.pagination,n.pagination),sort:Object.assign({},d.value.sort,n.sort)};Object.assign(d.value,t)}function C(){return(C=(0,r.A)(i().mark(function e(r){var a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.value=r,e.next=1,l.A.sepaCreditTransfer.load(n.value,[g]);case 1:a=e.sent,t.value=a;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return(E=(0,r.A)(i().mark(function e(){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.A.sepaCreditTransfer.loadWaitingPayments(d.value);case 1:n=e.sent,f.value=n.metadata,m.value=n.items;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(){return A.apply(this,arguments)}function A(){return(A=(0,r.A)(i().mark(function e(){var r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.A.sepaCreditTransfer.loadWaitingPayments({pagination:{per_page:1e4,page:1},filters:{sepa_credit_transfer_id:n.value},sort:{},fields:b});case 1:r=e.sent,t.value.sepa_waiting_payments=r.items;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(){return R.apply(this,arguments)}function R(){return(R=(0,r.A)(i().mark(function e(){var n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.A.sepaCreditTransfer.loadSepaCreditTransferCollection(a.value);case 1:n=e.sent,s.value=n.metadata,o.value=n.items;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e){return"expense_sepa_waiting_payment"==e.type_?e.expense_sheet.user.has_bank_account:"supplier_invoice_supplier_sepa_waiting_payment"==e.type_?e.supplier_invoice.supplier.has_bank_account:e.supplier_invoice.payer.has_bank_account}function O(){return(O=(0,r.A)(i().mark(function e(r,a){var o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return-1===(o=t.value.sepa_waiting_payments.findIndex(function(e){return e.id===r.id}))&&a?t.value.sepa_waiting_payments.push(r):o>-1&&!a?t.value.sepa_waiting_payments.splice(o,1):console.error("Selected vaut ".concat(a," mais l'index du paiement est ").concat(o)),e.prev=1,e.next=2,h(n.value,Array.from(t.value.sepa_waiting_payments,function(e){return{id:e.id}}));case 2:e.next=4;break;case 3:return e.prev=3,e.catch(1),e.next=4,L();case 4:case"end":return e.stop()}},e,null,[[1,3]])}))).apply(this,arguments)}function P(){return(P=(0,r.A)(i().mark(function e(r){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.value.sepa_waiting_payments=r?m.value.filter(function(e){return S(e)}):[],e.prev=1,e.next=2,h(n.value,Array.from(t.value.sepa_waiting_payments,function(e){return{id:e.id}}));case 2:e.next=4;break;case 3:return e.prev=3,e.catch(1),e.next=4,L();case 4:case"end":return e.stop()}},e,null,[[1,3]])}))).apply(this,arguments)}function X(){return(X=(0,r.A)(i().mark(function e(r){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.A.sepaCreditTransfer.update(r,n.value);case 1:t.value=e.sent;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F(){return(F=(0,r.A)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open("/files/"+t.value.file_id+"?action=download");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}(0,c.wB)(function(){return[d.value.pagination.page,d.value.pagination.per_page,d.value.sort,d.value.filters,d.value.fields]},function(){var n=(0,r.A)(i().mark(function n(t,r){return i().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.value){n.next=1;break}return console.log("Still loading, not listening yet"),n.abrupt("return");case 1:console.log("There are changes !!"),console.log(r),console.log(t),t[0]==r[0]&&t[0]>1?d.value.pagination.page=1:w();case 2:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}(),{deep:!0}),(0,c.wB)(function(){return[a.value.pagination.page,a.value.pagination.per_page,a.value.sort,a.value.filters,a.value.fields]},function(){var e=(0,r.A)(i().mark(function e(n,t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("There are changes !!"),console.log(t),console.log(n),n[0]==t[0]&&n[0]>1?a.value.pagination.page=1:x();case 1:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),{deep:!0});var T=(0,c.EW)(function(){return t.value.sepa_waiting_payments});return{creditTransfer:t,creditTransferPayments:T,waitingPaymentLoadOptions:d,waitingPayments:m,waitingPaymentsMeta:f,creditTransferLoadOptions:a,creditTransferCollection:o,creditTransferCollectionMeta:s,setInitialValues:function(e){return v.apply(this,arguments)},loadCreditTransfer:function(e){return C.apply(this,arguments)},isSelectablePayment:S,toggleSelectPayment:function(e,n){return O.apply(this,arguments)},selectAllPayments:function(e){return P.apply(this,arguments)},saveCreditTransfer:function(e){return X.apply(this,arguments)},openCreditTransferXml:function(){return F.apply(this,arguments)},loadCreditTransferCollection:x}})},9173:(e,n,t)=>{var r=t(3751),a=t(810),i=t(5220),o=t(641),l=t(953);const s={__name:"App",setup:function(e){return console.log("Starting The Vue app"),function(e,n){return(0,o.uX)(),(0,o.Wv)(o.tY,null,{default:(0,o.k6)(function(){return[(0,o.bF)((0,l.R1)(i.Tp))]}),_:1})}}};var u=t(5458),c=t(467),p=t(4756),d=t.n(p),m=t(5207),f=t(136),v=t(1275),b=t(7546),_=t(296),g=t(7437),y=t(33),h=t(1268),k=t(920),C=t(3683),w=t(2323),E=t(320),L=t(4142),A=t(750),x={class:"alert alert-info"},R={class:"limited_width width60"},S={class:"row form-row"},O={class:"row form-row"},P={class:"row form-row"},X={class:"limited_width width60"},F=["disabled"];const T={__name:"SepaCreditTransferForm",props:{creditTransfer:{type:Object},layout:{type:Object}},emits:["saved","cancel","error"],setup:function(e,n){var t=n.emit,r=e;console.log("SHOWING THE FORM");var a=t,i=(0,m.S)(),s=i.getOptions("sepa_pain_versions"),c=(0,o.EW)(function(){var e=i.getSchema("default");return console.log("Json Schema"),console.log(e),(0,k.cp)(e)}),p=(0,o.EW)(function(){var e=(0,k.rV)(c.value);return(0,A.bZ)(e,r.creditTransfer),e.execution_date=(0,C.uw)(e.execution_date),console.log("Initial values"),console.log(e),e}),d=(0,h.mN)({validationSchema:c,initialValues:p}),f=d.values,v=d.handleSubmit,b=d.isSubmitting,_=(0,m.G)(),g=v((0,k.FP)(a,_.saveCreditTransfer),(0,k.WS)(a)),T=function(){return a("cancel")},W=(0,o.EW)(function(){return function(e){return(0,k.Nw)(c.value,e)}}),j=(0,l.KR)(i.getOptions("bank_accounts")),q=r.layout;return function(n,t){return(0,o.uX)(),(0,o.Wv)((0,l.R1)(q),{onSubmitForm:(0,l.R1)(g),onClose:T},{title:(0,o.k6)(function(){return(0,u.A)(t[0]||(t[0]=[(0,o.eW)(" Générer l'ordre de virement ",-1)]))}),fields:(0,o.k6)(function(){return[(0,o.Lk)("div",x,[t[1]||(t[1]=(0,o.eW)(" Configurez le compte en banque à utiliser pour ce virement SEPA d'un montant de ",-1)),(0,o.Lk)("strong",null,(0,y.v_)(e.creditTransfer.amount_label)+" €",1)]),(0,o.Lk)("div",R,[(0,o.Lk)("div",S,[(0,o.bF)(L.A,(0,o.v6)(W.value("bank_account_id"),{options:j.value}),null,16,["options"])]),(0,o.Lk)("div",O,[(0,o.bF)(E.A,(0,y._B)((0,o.Ng)(W.value("execution_date"))),null,16)]),(0,o.Lk)("div",P,[(0,o.bF)(L.A,(0,o.v6)(W.value("sepa_pain_version"),{options:(0,l.R1)(s)}),null,16,["options"])])])]}),buttons:(0,o.k6)(function(){return[t[2]||(t[2]=(0,o.Lk)("div",{class:"alert alert-warning"},[(0,o.eW)(" En validant le formulaire, vous vous apprêtez à générer le fichier de virement SEPA Xml."),(0,o.Lk)("br"),(0,o.eW)(" Tous les paiements prévus dans cet ordre de virement seront automatiquement générés et figureront donc dans les prochains exports comptables. ")],-1)),(0,o.Lk)("div",X,[(0,o.Lk)("button",{id:"deformsubmit",name:"submit",type:"submit",class:"btn btn-primary",value:"submit",disabled:(0,l.R1)(b)}," Générer le fichier XML ",8,F),(0,o.Lk)("button",{id:"deformcancel",name:"cancel",type:"button",class:"btn btn-default",onClick:T}," Annuler "),(0,l.R1)(!1)?((0,o.uX)(),(0,o.Wv)(w.A,{key:0,debug:(0,l.R1)(f)},null,8,["debug"])):(0,o.Q3)("v-if",!0)])]}),_:1},8,["onSubmitForm"])}}};var W={key:0},j={key:1};const q={__name:"SepaCreditTransferFormComponent",props:{creditTransferId:{type:Number,required:!0},formConfigUrl:{type:String,required:!0},layout:{type:Object,default:g.A}},emits:["saved","cancel"],setup:function(e,n){return(0,c.A)(d().mark(function t(){var r,i,s,u,p,f,v,b,g,y,h,k,C,w,E,L;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return L=function(){v("cancel")},E=function(e){v("saved",e)},k=function(){return(k=(0,c.A)(d().mark(function e(){var n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[g.loadConfig(),y.loadCreditTransfer(f.creditTransferId)],e.next=1,Promise.all(n);case 1:b.value=!1;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},h=function(){return k.apply(this,arguments)},s=n.emit,f=e,v=s,b=(0,l.KR)(!0),(g=(0,m.S)()).setUrl(f.formConfigUrl),y=(0,m.G)(),C=(0,a.bP)(y),w=C.creditTransfer,r=(0,o.E)(function(){return h()}),i=(0,_.A)(r,2),u=i[0],p=i[1],t.next=1,u;case 1:return p(),t.abrupt("return",function(n,t){return b.value?((0,o.uX)(),(0,o.CE)("div",W,"Chargement des informations")):((0,o.uX)(),(0,o.CE)("div",j,[(0,o.bF)(T,{creditTransfer:(0,l.R1)(w),layout:e.layout,onSaved:E,onCancel:L},null,8,["creditTransfer","layout"])]))});case 2:case"end":return t.stop()}},t)}))()}};var V=t(940),I=t(2752),D=t(150),K={class:"col_text"},G=["href"],N={key:1};const Q={__name:"CompanyCell",props:{item:{type:Object,required:!0},name:{type:String,required:!0},getValue:{type:Function,required:!0},showLink:{type:Boolean,default:!0}},setup:function(e){var n=e,t=(0,o.EW)(function(){return n.getValue?n.getValue(n.item):n.item[n.name]});return function(n,r){return(0,o.uX)(),(0,o.CE)("td",K,[e.showLink?((0,o.uX)(),(0,o.CE)("a",{key:0,href:"/companies/".concat(t.value.id),title:"Ouvrir la fiche de cette enseigne dans une nouvelle fenêtre",target:"_blank"},(0,y.v_)(t.value.name),9,G)):((0,o.uX)(),(0,o.CE)("span",N,(0,y.v_)(t.value.name),1))])}}};var M={class:"col_text"},U=["href"];const B={__name:"NameCell",props:{item:{type:Object,required:!0}},setup:function(e){var n=e,t=(0,o.EW)(function(){return n.item.expense_sheet?n.item.expense_sheet.label:n.item.supplier_invoice.label}),r=(0,o.EW)(function(){return n.item.expense_sheet?n.item.expense_sheet.title:n.item.supplier_invoice.name}),a=(0,o.EW)(function(){return n.item.expense_sheet?"/expenses/".concat(n.item.expense_sheet.id):"/supplier_invoices/".concat(n.item.supplier_invoice.id)});return function(e,n){return(0,o.uX)(),(0,o.CE)("td",M,[(0,o.Lk)("a",{href:a.value,"aria-label":"Voir le document dans une nouvelle fenêtre",title:"Voir le document dans une nouvelle fenêtre",target:"_blank"},[(0,o.eW)((0,y.v_)(t.value)+" ",1),n[0]||(n[0]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("small",null,(0,y.v_)(r.value),1)],8,U)])}}};var $=t(5979),z=["title"];const H={__name:"TypeIconCell",props:{item:{type:Object,required:!0}},setup:function(e){var n=e,t=n.item.expense_sheet?"credit-card":"box",r=(0,o.EW)(function(){return"cancelled"===n.item.paid_status?"danger":"paid"===n.item.paid_status?"success":"neutral"}),a=(0,o.EW)(function(){var e,t=n.item.expense_sheet?"Note de dépenses":"Factures fournisseurs";return e="cancelled"===n.item.paid_status?"Paiement annulé":"paid"===n.item.paid_status?"Paiement effectué":"En attente de virement","".concat(t," : ").concat(e)});return function(e,n){return(0,o.uX)(),(0,o.CE)("td",{class:"col_status",title:a.value},[(0,o.bF)($.A,{"css-class":"status ".concat(r.value),name:(0,l.R1)(t)},null,8,["css-class","name"])],8,z)}}};var Y={class:"col_text"},J=["title","aria-label","onclick"];const Z={__name:"UserCell",props:{item:{type:Object,required:!0}},setup:function(e){var n=e,t=null;"expense_sepa_waiting_payment"==n.item.type_?t=n.item.expense_sheet.user:"supplier_invoice_user_sepa_waiting_payment"==n.item.type_&&(t=n.item.supplier_invoice.payer);var r="Ouvrir le formulaire de modification du compte dans une nouvelle fenêtre";return t&&!t.has_bank_account&&(r="Les informations bancaires de l'entrepreneur ne sont pas renseignées. "+r),function(e,n){return(0,o.uX)(),(0,o.CE)("td",Y,[(0,l.R1)(t)?((0,o.uX)(),(0,o.CE)("a",{key:0,href:"javascript:void(0);",title:(0,l.R1)(r),"aria-label":(0,l.R1)(r),onclick:"window.openPopup('/users/".concat((0,l.R1)(t).id,"/accounting')")},[(0,l.R1)(t).has_bank_account?((0,o.uX)(),(0,o.Wv)($.A,{key:0,"css-class":"tag only positive",name:"check",title:"Informations bancaires renseignées"})):((0,o.uX)(),(0,o.Wv)($.A,{key:1,"css-class":"tag only negative",name:"exclamation-triangle",title:"Informations bancaires non renseignées"})),(0,o.eW)(" "+(0,y.v_)((0,l.R1)(t).label),1)],8,J)):(0,o.Q3)("v-if",!0)])}}};var ee={class:"col_text"},ne=["title","aria-label","onclick"];const te={__name:"SupplierCell",props:{item:{type:Object,required:!0}},setup:function(e){var n=e,t="supplier_invoice_supplier_sepa_waiting_payment"==n.item.type_?n.item.supplier_invoice.supplier:null,r="Ouvrir le formulaire de modification du fournisseur dans une nouvelle fenêtre";return t&&!t.has_bank_account&&(r="Les informations bancaires du fournisseur ne sont pas renseignées. "+r),function(e,n){return(0,o.uX)(),(0,o.CE)("td",ee,[null!=(0,l.R1)(t)?((0,o.uX)(),(0,o.CE)("a",{key:0,href:"javascript:void(0);",title:(0,l.R1)(r),"aria-label":(0,l.R1)(r),onclick:"window.openPopup('/suppliers/".concat((0,l.R1)(t).id,"?action=edit')")},[(0,l.R1)(t).has_bank_account?((0,o.uX)(),(0,o.Wv)($.A,{key:0,"css-class":"tag only positive",name:"check",title:"Informations bancaires renseignées"})):((0,o.uX)(),(0,o.Wv)($.A,{key:1,"css-class":"tag only negative",name:"exclamation-triangle",title:"Informations bancaires non renseignées"})),(0,o.eW)(" "+(0,y.v_)((0,l.R1)(t).label),1)],8,ne)):(0,o.Q3)("v-if",!0)])}}};var re={class:"col_text document_number"},ae=["href"];const ie={__name:"DocumentNumber",props:{item:{type:Object,required:!0},name:{type:String,required:!0}},setup:function(e){var n=e,t=(0,o.EW)(function(){return n.item.expense_sheet?n.item.expense_sheet.official_number:n.item.supplier_invoice.official_number}),r=(0,o.EW)(function(){return n.item.expense_sheet?"/expenses/".concat(n.item.expense_sheet.id):"/supplier_invoices/".concat(n.item.supplier_invoice.id)});return function(e,n){return(0,o.uX)(),(0,o.CE)("td",re,[(0,o.Lk)("a",{href:r.value,"aria-label":"Voir le document dans une nouvelle fenêtre",title:"Voir le document dans une nouvelle fenêtre",target:"_blank"},(0,y.v_)(t.value),9,ae)])}}},oe=[{name:"type",title:"Type",cellComponent:(0,l.IG)(H),css:"col_status"},{name:"official_number",title:"N° de pièce",cellComponent:(0,l.IG)(ie),sort:"official_number"},{name:"name",title:"Document",cellComponent:(0,l.IG)(B),sort:"name"},{name:"user",title:"Entrepreneur",cellComponent:(0,l.IG)(Z),sort:"user"},{name:"company",title:"Enseigne",cellComponent:(0,l.IG)(Q),sort:"company",componentOptions:{getValue:function(e){return e.expense_sheet?e.expense_sheet.company:e.supplier_invoice.company}}},{name:"supplier",title:"Fournisseur",cellComponent:(0,l.IG)(te),sort:"supplier"},{name:"amount",title:"Montant TTC",cellComponent:(0,l.IG)(D.A),sort:"amount",css:"col_number",componentOptions:{intFormat:2}}];var le=t(4467),se=t(2543),ue=t(5877);function ce(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var pe={class:"search_filters"},de={class:"collapse_title"},me={class:"collapse_content"},fe={class:"form-group"},ve={class:"form-group"},be={class:"form-group"},_e={class:"wrapped"},ge={class:"toggle"},ye={for:"with_iban"},he={key:0,class:"form-group"},ke={class:"form-group"},Ce={class:"form-group"};const we={__name:"FilterFormComponent",props:{filters:{},filtersModifiers:{}},emits:(0,o.zz)(["filter"],["update:filters"]),setup:function(e,n){var t=n.emit,a=(0,o.fn)(e,"filters"),i=t,s=(0,se.debounce)(function(){i("filter",function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ce(Object(t),!0).forEach(function(n){(0,le.A)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ce(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},a))},300);(0,o.wB)(a,function(){console.log("Filters updated:",a),s()},{deep:!0});var c=(0,m.S)(),p=c.getOptions("antennes"),d=c.getOptions("users"),f=c.getOptions("companies"),v=function(){s()};return function(e,n){return(0,o.uX)(),(0,o.CE)("div",pe,[(0,o.Lk)("h2",de,[(0,o.bF)($.A,{"css-class":"icon",name:"search"}),n[6]||(n[6]=(0,o.eW)(" Recherche ",-1)),(0,o.bF)(b.A,{css:"arrow",name:"chevron-down"})]),(0,o.Lk)("div",me,[(0,o.Lk)("form",{class:"form-search form-inline",onSubmit:(0,r.D$)(v,["prevent"])},[(0,o.Lk)("div",fe,[n[8]||(n[8]=(0,o.Lk)("label",{for:"doctype"},"Type de document",-1)),(0,o.bo)((0,o.Lk)("select",{id:"doctype","onUpdate:modelValue":n[0]||(n[0]=function(e){return a.value.doctype=e})},(0,u.A)(n[7]||(n[7]=[(0,o.Lk)("option",{value:"all"},"Tous",-1),(0,o.Lk)("option",{value:"expense"},"Notes de dépenses",-1),(0,o.Lk)("option",{value:"supplier_invoice"}," Factures fournisseurs ",-1)])),512),[[r.u1,a.value.doctype]])]),(0,o.Lk)("div",ve,[n[9]||(n[9]=(0,o.Lk)("label",{for:"official_number"},"Numéro de document",-1)),(0,o.bo)((0,o.Lk)("input",{id:"official_number","onUpdate:modelValue":n[1]||(n[1]=function(e){return a.value.official_number=e}),type:"text",placeholder:"Enter official number"},null,512),[[r.Jo,a.value.official_number]])]),(0,o.Lk)("div",be,[(0,o.Lk)("div",_e,[(0,o.Lk)("div",ge,[(0,o.Lk)("label",ye,[(0,o.bo)((0,o.Lk)("input",{id:"with_iban","onUpdate:modelValue":n[2]||(n[2]=function(e){return a.value.with_iban=e}),type:"checkbox"},null,512),[[r.lH,a.value.with_iban]]),n[10]||(n[10]=(0,o.Lk)("span",null,"Iban renseigné ?",-1))])])])]),(0,l.R1)(p).length>1?((0,o.uX)(),(0,o.CE)("div",he,[n[11]||(n[11]=(0,o.Lk)("label",{for:"antenne"},"Antenne",-1)),(0,o.bF)((0,l.R1)(ue.Ay),{id:"antenne",modelValue:a.value.antenne_ids,"onUpdate:modelValue":n[3]||(n[3]=function(e){return a.value.antenne_ids=e}),options:(0,l.R1)(p),"preserve-search":!0,placeholder:"Sélectionner",label:"label","track-by":"id","show-labels":!1,multiple:!0,"close-on-select":!1,"clear-on-select":!1},null,8,["modelValue","options"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",ke,[n[12]||(n[12]=(0,o.Lk)("label",{for:"user_ids"},"Utilisateurs",-1)),(0,o.bF)((0,l.R1)(ue.Ay),{id:"user",modelValue:a.value.user_ids,"onUpdate:modelValue":n[4]||(n[4]=function(e){return a.value.user_ids=e}),options:(0,l.R1)(d),"preserve-search":!0,placeholder:"Sélectionner",label:"label","track-by":"id","show-labels":!1,multiple:!0,"close-on-select":!1,"clear-on-select":!1},null,8,["modelValue","options"])]),(0,o.Lk)("div",Ce,[n[13]||(n[13]=(0,o.Lk)("label",{for:"company_ids"},"Enseignes",-1)),(0,o.bF)((0,l.R1)(ue.Ay),{id:"user",modelValue:a.value.company_ids,"onUpdate:modelValue":n[5]||(n[5]=function(e){return a.value.company_ids=e}),options:(0,l.R1)(f),"preserve-search":!0,placeholder:"Sélectionner",label:"label","track-by":"id","show-labels":!1,multiple:!0,"close-on-select":!1,"clear-on-select":!1},null,8,["modelValue","options"])])],32)])])}}};var Ee=t(19),Le={class:"row_recap"},Ae={key:0,scope:"row"},xe=["colspan"],Re={key:1,class:"col_number"},Se=["colspan"],Oe={class:"row_recap"},Pe={key:0,scope:"row"},Xe=["colspan"],Fe={key:1,class:"col_number"},Te=["colspan"];const We={__name:"WaitingPaymentTable",props:{items:{type:Array},params:{type:Object},selectable:{type:Boolean,default:!1},selectableCondition:{type:Function,default:function(){return!0}},onSelect:{type:Function},isSelected:{type:Function},onSelectAll:{type:Function},onSort:{type:Function}},setup:function(e){var n=e,t=(0,o.EW)(function(){return n.params.columnsDef.filter(function(e){return n.params.columns.includes(e.name)})}),r=(0,o.EW)(function(){var e={};return n.params.columns.includes("amount")&&(e.amount=n.items.reduce(function(e,n){return+e+n.amount},0)),e}),a=(0,o.EW)(function(){var e=0;return t.value.forEach(function(n,t){"amount"==n.name&&(e=e>0?Math.min(t,e):t)}),e}),i=(0,o.EW)(function(){var e=0;return t.value.forEach(function(n,t){"amount"==n.name&&(e=e>0?Math.max(t,e):t)}),e=t.value.length-e-1});return function(t,s){return(0,o.uX)(),(0,o.Wv)(Ee.A,(0,y._B)((0,o.Ng)(n)),{tbodyBegining:(0,o.k6)(function(){return[(0,o.Lk)("tr",Le,[e.selectable?((0,o.uX)(),(0,o.CE)("th",Ae)):(0,o.Q3)("v-if",!0),(0,o.Lk)("th",{scope:"row",colspan:a.value,class:"col_text"}," Total ",8,xe),e.params.columns.includes("amount")?((0,o.uX)(),(0,o.CE)("td",Re,(0,y.v_)((0,l.R1)(A.hL)(r.value.amount,2)),1)):(0,o.Q3)("v-if",!0),i.value>0?((0,o.uX)(),(0,o.CE)("th",{key:2,scope:"row",colspan:i.value,class:"col_text"},null,8,Se)):(0,o.Q3)("v-if",!0)])]}),tbodyEnd:(0,o.k6)(function(){return[(0,o.Lk)("tr",Oe,[e.selectable?((0,o.uX)(),(0,o.CE)("th",Pe)):(0,o.Q3)("v-if",!0),(0,o.Lk)("th",{scope:"row",colspan:a.value,class:"col_text"}," Total ",8,Xe),e.params.columns.includes("amount")?((0,o.uX)(),(0,o.CE)("td",Fe,(0,y.v_)((0,l.R1)(A.hL)(r.value.amount,2)),1)):(0,o.Q3)("v-if",!0),i.value>0?((0,o.uX)(),(0,o.CE)("th",{key:2,scope:"row",colspan:i.value,class:"col_text"},null,8,Te)):(0,o.Q3)("v-if",!0)])]}),_:1},16)}}};var je={key:0};const qe={__name:"WaitingPaymentListComponent",setup:function(e){var n=(0,m.G)(),t=(0,a.bP)(n),r=t.waitingPayments,i=t.waitingPaymentsMeta,s=t.waitingPaymentLoadOptions,u=t.creditTransferPayments,c=(0,l.KR)({sort:s.value.sort,columnsDef:oe,columns:oe.map(function(e){return e.name})}),p=function(e){return e.id},d=function(e){return u.value.some(function(n){return p(n)===p(e)})},f=function(e,n){s.value.sort.sort=e,s.value.sort.sortDirection=n};return function(e,t){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(we,{filters:(0,l.R1)(s).filters,"onUpdate:filters":t[0]||(t[0]=function(e){return(0,l.R1)(s).filters=e})},null,8,["filters"]),(0,o.Lk)("div",null,[(0,o.Lk)("h2",null,[t[4]||(t[4]=(0,o.eW)(" Liste des règlements en attente ",-1)),(0,l.R1)(u).length>0?((0,o.uX)(),(0,o.CE)("small",je,"Règlements sélectionnés ("+(0,y.v_)((0,l.R1)(u).length)+")",1)):(0,o.Q3)("v-if",!0)]),t[5]||(t[5]=(0,o.Lk)("div",{class:"alert alert-info"}," Sélectionnez les paiements en attente à intégrer à votre ordre de virement. ",-1)),(0,o.bF)(V.A,{page:(0,l.R1)(s).pagination.page,"onUpdate:page":t[1]||(t[1]=function(e){return(0,l.R1)(s).pagination.page=e}),"items-per-page":(0,l.R1)(s).pagination.per_page,"onUpdate:itemsPerPage":t[2]||(t[2]=function(e){return(0,l.R1)(s).pagination.per_page=e}),pagination:(0,l.R1)(s).pagination,"onUpdate:pagination":t[3]||(t[3]=function(e){return(0,l.R1)(s).pagination=e}),"total-pages":(0,l.R1)(i).total_pages,"total-count":(0,l.R1)(i).total_count},null,8,["page","items-per-page","pagination","total-pages","total-count"]),(0,o.bF)(We,{items:(0,l.R1)(r),params:c.value,selectable:!0,"on-select":(0,l.R1)(n).toggleSelectPayment,"selectable-condition":(0,l.R1)(n).isSelectablePayment,"is-selected":d,"on-select-all":(0,l.R1)(n).selectAllPayments,"on-sort":f},null,8,["items","params","on-select","selectable-condition","on-select-all"])])],64)}}};var Ve={key:0},Ie={key:1,class:"alert alert-warning"};const De={__name:"CreditTransferPaymentListComponent",setup:function(e){var n=(0,m.G)(),t=(0,a.bP)(n).creditTransferPayments,r=(0,l.KR)({columnsDef:oe,columns:oe.map(function(e){return e.name})});return function(e,n){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("h2",null,[n[0]||(n[0]=(0,o.eW)(" Règlements sélectionnés ",-1)),(0,l.R1)(t).length>0?((0,o.uX)(),(0,o.CE)("small",Ve,(0,y.v_)((0,l.R1)(t).length)+" règlement(s) seront intégrés à l'ordre de virement",1)):(0,o.Q3)("v-if",!0)]),(0,l.R1)(t).length>0?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[n[1]||(n[1]=(0,o.Lk)("div",{class:"alert alert-info"},[(0,o.eW)(" Les règlements ci-dessous seront intégrés dans l'ordre de virement au moment de générer le fichier XML. "),(0,o.Lk)("br"),(0,o.eW)("À la génération du fichier, l'ensemble des règlements ci-dessous seront considérés comme payés. ")],-1)),(0,o.bF)(We,{items:(0,l.R1)(t),params:r.value},null,8,["items","params"])],64)):((0,o.uX)(),(0,o.CE)("div",Ie,(0,u.A)(n[2]||(n[2]=[(0,o.eW)(" Aucun règlement n'a encore été inclu dans l'ordre de virement SEPA. ",-1),(0,o.Lk)("br",null,null,-1),(0,o.eW)(" Veuillez sélectionner des règlements dans le tableau ci-dessus. ",-1)]))))],64)}}};var Ke={key:0},Ge={key:1},Ne={class:"main_toolbar action_tools"},Qe={class:"layout flex main_actions"},Me={role:"group"},Ue=["disabled"],Be={key:0,class:"alert alert-warning"},$e={key:1,class:"alert alert-warning"},ze={key:2},He={class:"separate_top_dashed"};const Ye={__name:"EditCreditTransferOrderApp",setup:function(e){var n=(0,l.KR)(!0),t=(0,l.KR)(!1),r=(0,f.Dn)(),i=(0,m.G)();console.log(r);var s=(0,m.S)();s.setUrl(r.form_config_url);var p=(0,a.bP)(i),_=p.creditTransferPayments,g=p.creditTransferCollectionMeta,y=(0,l.KR)([]);function h(){console.log("setting Show Modal to true"),t.value=!0}function k(){i.openCreditTransferXml(),window.location.reload()}function C(){return(C=(0,c.A)(d().mark(function e(){var t,a,o;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.setInitialValues(r.credit_transfer_id),a=s.loadConfig(),o=i.loadCreditTransferCollection(),e.next=1,Promise.all([t,a,o]);case 1:y.value=s.getOptions("bank_accounts"),n.value=!1;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}return function(){C.apply(this,arguments)}(),function(e,a){var i=(0,o.g2)("RouterLink");return n.value?((0,o.uX)(),(0,o.CE)("div",Ke,"Chargement des informations")):((0,o.uX)(),(0,o.CE)("div",Ge,[(0,o.Lk)("div",Ne,[(0,o.Lk)("div",Qe,[(0,o.Lk)("div",Me,[(0,o.Lk)("button",{type:"button",class:"btn btn-primary",disabled:!(0,l.R1)(_).length,onClick:h},[(0,o.bF)(b.A,{name:"download"}),a[1]||(a[1]=(0,o.eW)(" Générer le fichier de virement SEPA ",-1))],8,Ue),(0,l.R1)(g).total_count>0?((0,o.uX)(),(0,o.Wv)(i,{key:0,class:"btn icon only",to:"/orders",title:"Historique des ordres de virement","aria-label":"Voir l'historique des ordres de virement"},{default:(0,o.k6)(function(){return[(0,o.bF)(b.A,{name:"list"}),a[2]||(a[2]=(0,o.eW)("  Historique des ordres de virement ",-1))]}),_:1})):(0,o.Q3)("v-if",!0)])])]),0===y.value.length?((0,o.uX)(),(0,o.CE)("div",Be,(0,u.A)(a[3]||(a[3]=[(0,o.eW)(" Les informations SEPA des comptes bancaires de la CAE ne sont pas configurés. Aucun ordre de virement ne pourra être produit. Configurez les informations SEPA dans les paramètres de la CAE : ",-1),(0,o.Lk)("a",{href:"javascript:void(0);",onclick:"window.openPopup('/admin/sales/accounting/receipts/bank_account')",title:"Accéder à la page de configuration des comptes en banque dans une nouvelle fenêtre","aria-label":"Accéder à la page de configuration des comptes en banque dans une nouvelle fenêtre"},"Accéder à la page de configuration des comptes en banque",-1)])))):(0,l.R1)(r).has_sepa_waiting_payments?((0,o.uX)(),(0,o.CE)("div",ze,[(0,o.bF)(qe),(0,o.Lk)("div",He,[(0,o.bF)(De)])])):((0,o.uX)(),(0,o.CE)("div",$e,(0,u.A)(a[4]||(a[4]=[(0,o.eW)(" Aucun paiement n'a été marqué comme ",-1),(0,o.Lk)("strong",null,'"À payer"',-1),(0,o.eW)(".",-1),(0,o.Lk)("br",null,null,-1),(0,o.Lk)("br",null,null,-1),(0,o.eW)(" Pour pouvoir générer des ordres de virement SEPA ",-1),(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,' Marquer des notes de dépenses ou des factures fournisseurs comme "À payer". Ces paiement sont alors en attente ici '),(0,o.Lk)("li",null," Associer les paiements en attente à un ordre de virement SEPA "),(0,o.Lk)("li",null," Générer le fichier d'ordre de virement SEPA et le déposer sur l'espace dédié de votre banque ")],-1),(0,o.Lk)("br",null,null,-1)])))),t.value?((0,o.uX)(),(0,o.Wv)(q,{key:3,"credit-transfer-id":(0,l.R1)(r).credit_transfer_id,"form-config-url":(0,l.R1)(r).form_config_url,layout:v.A,onCancel:a[0]||(a[0]=function(){return t.value=!1}),onSaved:k},null,8,["credit-transfer-id","form-config-url"])):(0,o.Q3)("v-if",!0)]))}}};var Je={class:"col_text"},Ze=["href"];const en={__name:"CompanyCell",props:{item:{type:Object,required:!0}},setup:function(e){var n=e,t=n.item.expense_sheet?n.item.expense_sheet.company:n.item.supplier_invoice.company;return function(e,n){return(0,o.uX)(),(0,o.CE)("td",Je,[(0,o.Lk)("a",{href:"/companies/".concat((0,l.R1)(t).id),title:"Ouvrir la fiche de cette enseigne dans une nouvelle fenêtre"},(0,y.v_)((0,l.R1)(t).name),9,Ze)])}}},nn=[{name:"type",title:"Type",cellComponent:(0,l.IG)(H),sort:"type"},{name:"official_number",title:"N° de pièce",cellComponent:(0,l.IG)(ie),sort:"official_number"},{name:"name",title:"Document",cellComponent:(0,l.IG)(B),sort:"name"},{name:"user",title:"Entrepreneur",cellComponent:(0,l.IG)(I.A),sort:"user",componentOptions:{getValue:function(e){return"expense_sepa_waiting_payment"==e.type_?e.expense_sheet.user.label:"supplier_invoice_user_sepa_waiting_payment"==e.type_?e.supplier_invoice.payer.label:""}}},{name:"company",title:"Enseigne",cellComponent:(0,l.IG)(en),sort:"company",componentOptions:{getValue:function(e){return e.expense_sheet?e.expense_sheet.company:e.supplier_invoice.company}}},{name:"supplier",title:"Fournisseur",cellComponent:(0,l.IG)(I.A),sort:"supplier",componentOptions:{getValue:function(e){return"supplier_invoice_supplier_sepa_waiting_payment"==e.type_?e.supplier_invoice.supplier.label:""}}},{name:"amount",title:"Montant TTC",cellComponent:(0,l.IG)(D.A),sort:"amount",css:"col_number",componentOptions:{intFormat:2}}];var tn=t(4456),rn=["action"],an=["value"];const on={__name:"POSTButton",props:{label:{type:String},extendedLabel:{type:String},icon:String,showLabel:{type:Boolean,default:!1},css:{type:String,default:""},title:{type:String,default:""},url:{type:String,required:!0},confirm:{type:String,default:""}},setup:function(e){var n=e,t=(0,f.Qm)();t||(console.error("Missing csrf token in AppOptions"),t="TOKEN HAS NOT BEEN FOUND IN AppOptions");var r=function(e){!n.confirm||window.confirm(n.confirm)||e.preventDefault()};return function(n,a){return(0,o.uX)(),(0,o.CE)("form",{action:e.url,method:"post",class:"btn-container",onSubmit:r},[(0,o.Lk)("input",{type:"hidden",name:"csrf_token",value:(0,l.R1)(t)},null,8,an),(0,o.bF)(tn.A,{label:e.label,"extended-label":e.extendedLabel,"show-label":e.showLabel,icon:e.icon,css:e.css,title:e.title,type:"submit"},null,8,["label","extended-label","show-label","icon","css","title"])],40,rn)}}};var ln={key:0},sn={key:1},un={class:"main_toolbar action_tools"},cn={class:"layout flex main_actions"},pn={role:"group"},dn={role:"group"},mn=["href"],fn={key:0,class:"alert alert-warning"},vn={class:"separate_top_dashed"},bn={class:"col_actions width_two"},_n={class:"btn-group"},gn=["href"],yn=[{path:"/",component:Ye},{path:"/orders/:id",component:{__name:"CreditTransferOrderViewApp",setup:function(e){return(0,c.A)(d().mark(function e(){var n,t,r,s,u,p,v,g,h,k,w,E,L,A,x,R;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E=function(){return(E=(0,c.A)(d().mark(function e(){var n;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[h.loadConfig(),k.loadCreditTransfer(p.value)],e.next=1,Promise.all(n);case 1:g.value=!1;case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},w=function(){return E.apply(this,arguments)},u=(0,i.lq)(),p=(0,l.KR)(u.params.id),v=(0,f.Dn)(),g=(0,l.KR)(!0),(h=(0,m.S)()).setUrl(v.form_config_url),k=(0,m.G)(),L=(0,a.bP)(k),A=L.creditTransfer,x=(0,l.KR)({sort:"",columnsDef:nn,columns:nn.map(function(e){return e.name})}),R=function(e){return console.log("getItemPaymentUrl",e),e.expense_sheet?"/expense_payments/".concat(e.payment_id):"/supplier_payments/".concat(e.payment_id)},n=(0,o.E)(function(){return w()}),t=(0,_.A)(n,2),r=t[0],s=t[1],e.next=1,r;case 1:return s(),e.abrupt("return",function(e,n){return g.value?((0,o.uX)(),(0,o.CE)("div",ln,"Chargement en cours...")):((0,o.uX)(),(0,o.CE)("div",sn,[(0,o.Lk)("div",un,[(0,o.Lk)("div",cn,[(0,o.Lk)("div",pn,[(0,o.bF)((0,l.R1)(i.Wk),{to:"/",class:"btn icon only"},{default:(0,o.k6)(function(){return[(0,o.bF)(b.A,{name:"arrow-left"}),n[0]||(n[0]=(0,o.eW)("  Revenir à la liste des règlements en attente ",-1))]}),_:1})]),(0,o.Lk)("div",dn,[(0,o.Lk)("a",{href:"/files/".concat((0,l.R1)(A).file_id,"?action=download"),class:"btn icon only",target:"_blank",title:"Télécharger le document XML de l'ordre de virement","aria-label":"Ouvrir une nouvelle fenêtre pour télécharger le document"},[(0,o.bF)(b.A,{name:"download"}),n[1]||(n[1]=(0,o.eW)(" Télécharger le fichier xml ",-1))],8,mn),"closed"==(0,l.R1)(A).status?((0,o.uX)(),(0,o.Wv)(on,{key:0,url:"/sepa_credit_transfers/".concat((0,l.R1)(A).id,"/cancel"),label:"Annuler l'ordre de virement",icon:"times",css:"negative",confirm:"En annulant l'ordre de virement, vous allez supprimer tous les décaissements associés (y compris ceux déjà exportés vers la comptabilité). Voulez-vous continuer ?"},null,8,["url"])):(0,o.Q3)("v-if",!0)])])]),(0,o.Lk)("h1",null,"Ordre de virement "+(0,y.v_)((0,l.R1)(A).reference),1),"cancelled"==(0,l.R1)(A).status?((0,o.uX)(),(0,o.CE)("div",fn," Cet ordre de virement a été annulé. Il est considéré comme n'ayant pas été envoyé à la banque. ")):(0,o.Q3)("v-if",!0),(0,o.eW)(" Effectué par "+(0,y.v_)((0,l.R1)(A).user.label)+" le "+(0,y.v_)((0,l.R1)(C.Yq)((0,l.R1)(A).execution_date)),1),n[4]||(n[4]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)(" Montant total : "+(0,y.v_)((0,l.R1)(A).amount_label)+" €",1),n[5]||(n[5]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("div",vn,[n[3]||(n[3]=(0,o.Lk)("h2",null,"Liste des paiements associés",-1)),(0,o.bF)(Ee.A,{items:(0,l.R1)(A).sepa_waiting_payments,params:x.value},{rowActions:(0,o.k6)(function(e){var t=e.item;return[(0,o.Lk)("td",bn,[(0,o.Lk)("div",_n,["paid"===t.paid_status?((0,o.uX)(),(0,o.CE)("a",{key:0,href:R(t),class:"btn icon only",target:"_blank",title:"Voir le détail du décaissement","aria-label":"Ouvrir une nouvelle fenêtre pour voir le détail du décaissement"},[(0,o.bF)(b.A,{name:"eye"}),n[2]||(n[2]=(0,o.eW)(" Voir le détail du décaissement ",-1))],8,gn)):(0,o.Q3)("v-if",!0)])])]}),_:1},8,["items","params"])])]))});case 2:case"end":return e.stop()}},e)}))()}}},{path:"/orders",component:function(){return t.e(770).then(t.bind(t,4770))}}],hn=(0,i.aE)({history:(0,i.Bt)(),routes:yn}),kn=(0,a.Ey)();(0,r.Ef)(s).use(hn).use(kn).mount("#vue-app")},940:(e,n,t)=>{t.d(n,{A:()=>A});var r=t(5458),a=t(641),i=t(33),o=t(953),l=t(3751),s=t(3115),u=t(7546),c=t(4456),p=t(5796),d=t(750),m={class:"pager display_selector"},f={"aria-label":"Pagination"},v={key:0},b=["data-page","title"],_={key:1},g=["title","aria-label"],y=["data-page","title","aria-label","onClick"],h={key:2},k={key:3},C=["data-page","title"],w=["value"],E=["value"],L=["for"];const A={__name:"PaginationWidget",props:{totalPages:{type:[Number,String],required:!0},totalCount:{type:[Number,String],required:!0},itemsPerPage:{type:[Number,String],required:!0},page:{type:[Number,String],required:!0},columnsDef:{type:Object,required:!1},columns:{type:Array,required:!1},pagination:{type:Object,required:!1}},emits:[],setup:function(e,n){var t=n.emit,A=e,x=t,R=(0,s.kPG)(A,x),S=R.itemsPerPage,O=R.page,P=R.columns,X=(0,a.EW)(function(){return(0,d.UW)(O.value)}),F=[{value:10,label:"10 par page"},{value:25,label:"25 par page"},{value:50,label:"50 par page"},{value:100,label:"100 par page"},{value:200,label:"200 par page"},{value:-1,label:"Tous"}],T=(0,a.EW)(function(){var e=[],n=Math.max(1,X.value-3),t=Math.min(A.totalPages,X.value+3);console.log("start: ".concat(n," end: ").concat(t));for(var r=n;r<X.value;r++)e.push(r);e.push(X.value);for(var a=X.value+1;a<=t;a++)e.push(a);return e}),W=(0,o.KR)(!1),j=function(){W.value=!W.value};return function(n,t){return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("h3",null,[(0,a.eW)((0,i.v_)(e.totalCount)+" résultats ",1),(0,a.Lk)("small",null,"sur "+(0,i.v_)(e.totalPages)+" page(s)",1)]),(0,a.Lk)("nav",f,[(0,a.Lk)("ul",null,[X.value>1?((0,a.uX)(),(0,a.CE)("li",v,[(0,a.Lk)("a",{class:"btn","data-action":"show_page","data-page":X.value-1,href:"javascript:void(0);",title:"Voir la page précédente (".concat(X.value-1,")"),"aria-label":"Voir la page précédente",onClick:t[0]||(t[0]=function(e){return O.value=(0,o.R1)(O)-1})},[(0,a.bF)(u.A,{name:"chevron-left"})],8,b)])):(0,a.Q3)("v-if",!0),X.value>4?((0,a.uX)(),(0,a.CE)("li",_,(0,r.A)(t[4]||(t[4]=[(0,a.Lk)("span",{class:"spacer"},"…",-1)])))):(0,a.Q3)("v-if",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(T.value,function(e){return(0,a.uX)(),(0,a.CE)("li",{key:e},[e==X.value?((0,a.uX)(),(0,a.CE)("span",{key:0,class:"current",title:"Page en cours : page ".concat(X.value.value),"aria-label":"Page en cours : page ".concat(X.value.value)},(0,i.v_)(X.value),9,g)):((0,a.uX)(),(0,a.CE)("a",{key:1,class:"btn","data-action":"show_page","data-page":e,title:"Aller à la page ".concat(e),"aria-label":"Aller à la page ".concat(e),href:"javascript:void(0);",onClick:function(n){return O.value=e-1}},(0,i.v_)(e),9,y))])}),128)),e.totalPages-X.value>2?((0,a.uX)(),(0,a.CE)("li",h,(0,r.A)(t[5]||(t[5]=[(0,a.Lk)("span",{class:"spacer"},"…",-1)])))):(0,a.Q3)("v-if",!0),(0,o.R1)(O)<e.totalPages?((0,a.uX)(),(0,a.CE)("li",k,[(0,a.Lk)("a",{class:"btn","data-action":"show_page","data-page":X.value+1,href:"javascript:void(0);",title:"Voir la page suivante (".concat(X.value+1,")"),"aria-label":"Voir la page suivante",onClick:t[1]||(t[1]=function(e){return O.value=(0,o.R1)(O)+1})},[(0,a.bF)(u.A,{name:"chevron-right"})],8,C)])):(0,a.Q3)("v-if",!0)])]),(0,a.Lk)("form",null,[(0,a.Lk)("div",null,[t[7]||(t[7]=(0,a.Lk)("label",{for:"items_per_page_top",class:"screen-reader-text"}," Éléments affichés ",-1)),(0,a.bo)((0,a.Lk)("select",{id:"items_per_page_top","onUpdate:modelValue":t[2]||(t[2]=function(e){return(0,o.i9)(S)?S.value=e:null})},[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(F,function(e){return(0,a.Lk)("option",{key:e.value,value:e.value},(0,i.v_)(e.label),9,w)}),64))],512),[[l.u1,(0,o.R1)(S)]]),e.columnsDef?((0,a.uX)(),(0,a.Wv)(c.A,{key:0,icon:"file-list",label:"Afficher la liste des colonnes","show-label":!1,onClick:j})):(0,a.Q3)("v-if",!0),W.value?((0,a.uX)(),(0,a.Wv)(p.A,{key:1,onClose:j},{header:(0,a.k6)(function(){return(0,r.A)(t[6]||(t[6]=[(0,a.Lk)("h3",null,"Configurer la liste des colonnes à afficher",-1)]))}),body:(0,a.k6)(function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.columnsDef,function(e){return(0,a.uX)(),(0,a.CE)("div",{key:e.name},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return(0,o.i9)(P)?P.value=e:null}),type:"checkbox",value:e.name},null,8,E),[[l.lH,(0,o.R1)(P)]]),(0,a.Lk)("label",{for:e.name},(0,i.v_)(e.title),9,L)])}),128))]}),_:1})):(0,a.Q3)("v-if",!0)])])])}}}},19:(e,n,t)=>{t.d(n,{A:()=>v});var r=t(641),a=t(33),i=t(3751),o=t(2752),l=t(953),s=["checked","disabled"];const u={__name:"Selectable",props:{item:{type:Object,required:!0},selectableCondition:{type:Function,default:function(){return!0}},isSelected:{type:Function}},emits:["select"],setup:function(e,n){var t=n.emit,a=e,i=t,o=(0,l.lW)(a,"item"),u=function(e){a.selectableCondition(o.value)&&i("select",o.value,e.target.checked)};return function(n,t){return(0,r.uX)(),(0,r.CE)("td",null,[(0,r.Lk)("input",{type:"checkbox",checked:e.isSelected(e.item),disabled:!e.selectableCondition(e.item),onChange:u},null,40,s)])}}},c={__name:"TableTr",props:{item:{type:Object,required:!0},displayedColumns:{type:Array,required:!0},selectable:{type:Boolean,default:!1},selectableCondition:{type:Function,default:function(){return!0}},onSelect:{type:Function},isSelected:{type:Function},onRowClick:{type:Function,default:null}},setup:function(e){return function(n,t){return(0,r.uX)(),(0,r.CE)("tr",{class:(0,a.C4)(e.selectable&&e.isSelected(e.item)?"selected":"")},[e.selectable?((0,r.uX)(),(0,r.Wv)(u,{key:0,item:e.item,"selectable-condition":e.selectableCondition,"is-selected":e.isSelected,onSelect:e.onSelect},null,8,["item","selectable-condition","is-selected","onSelect"])):(0,r.Q3)("v-if",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.displayedColumns,function(n){return(0,r.uX)(),(0,r.Wv)((0,r.$y)(n.cellComponent?n.cellComponent:o.A),(0,r.v6)({key:n.name,ref_for:!0},n.componentOptions,{item:e.item,name:n.name,class:e.selectableCondition(e.item)?"pointer":"",onClick:(0,i.D$)(e.onRowClick,["self"])}),null,16,["item","name","class","onClick"])}),128)),(0,r.RG)(n.$slots,"actions")],2)}}};var p=t(7546),d={class:"table_container"},m={key:0},f=["onClick"];const v={__name:"Table",props:{items:{type:Array,required:!0},params:{type:Object,required:!0,validator:function(e){return Object.keys(e).some(function(e){return["columns","columnsDef"].includes(e)})}},selectable:{type:Boolean,default:!1},selectableCondition:{type:Function,default:function(){return!0}},onSelect:{type:Function},isSelected:{type:Function},onSelectAll:{type:Function},onSort:{type:Function}},emits:["sortBy"],setup:function(e,n){var t=n.emit,i=e,o=t,l=(0,r.EW)(function(){return i.params.columnsDef.filter(function(e){return i.params.columns.includes(e.name)})}),s=function(e){var n=e.sort;return i.params.sort.sort==n?"asc"==i.params.sort.sortDirection?"sort-asc":"sort-desc":"sort-arrow"};return function(n,t){return(0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("table",null,[(0,r.Lk)("thead",null,[e.selectable?((0,r.uX)(),(0,r.CE)("th",m,[(0,r.Lk)("input",{type:"checkbox",onChange:t[0]||(t[0]=function(n){return e.onSelectAll(n.target.checked)})},null,32)])):(0,r.Q3)("v-if",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.value,function(n){return(0,r.uX)(),(0,r.CE)("th",{key:n.name,scope:"col",class:(0,a.C4)(n.css||"col_text")},[e.params.sort&&n.sort?((0,r.uX)(),(0,r.CE)("a",{key:0,class:(0,a.C4)((t=n,l="icon",u=t.sort,i.params.sort.sort==u&&(l+=" current ","asc"==i.params.sort.sortDirection?l+="asc":l+="desc"),l)),onClick:function(e){return function(e){var n=i.params.columnsDef.find(function(n){return n.name==e}).sort;if(n){var t="asc";i.params.sort.sort==n&&(t="asc"==i.params.sort.sortDirection?"desc":"asc"),o("sortBy",n,t)}else console.error("No sort defined for column",e)}(n.name)}},[(0,r.bF)(p.A,{name:s(n),class:"presentation"},null,8,["name"]),(0,r.eW)(" "+(0,a.v_)(n.title),1)],10,f)):0!=n.showTitle?((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.eW)((0,a.v_)(n.title),1)],64)):((0,r.uX)(),(0,r.CE)(r.FK,{key:2},[(0,r.eW)((0,a.v_)("  "))],64))],2);var t,l,u}),128))]),(0,r.Lk)("tbody",null,[(0,r.RG)(n.$slots,"tbodyBegining"),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.items,function(t){return(0,r.uX)(),(0,r.Wv)(c,{key:t.id,item:t,"displayed-columns":l.value,selectable:e.selectable,"selectable-condition":e.selectableCondition,"on-select":e.onSelect,"is-selected":e.isSelected,"on-row-click":function(){return function(e){if(console.log("onRowClick",e),i.onSelect&&i.selectableCondition(e)){var n=!i.isSelected(e);i.onSelect(e,n)}}(t)}},{actions:(0,r.k6)(function(){return[(0,r.RG)(n.$slots,"rowActions",{item:t})]}),_:2},1032,["item","displayed-columns","selectable","selectable-condition","on-select","is-selected","on-row-click"])}),128)),(0,r.RG)(n.$slots,"tbodyEnd")]),(0,r.RG)(n.$slots,"afterBody")])])}}}},150:(e,n,t)=>{t.d(n,{A:()=>l});var r=t(641),a=t(33),i=t(750),o={class:"col_number"};const l={__name:"AmountCell",props:{item:{type:Object,required:!0},name:{type:String,required:!0},getValue:{type:Function,required:!1,default:null},intFormat:{type:Number,required:!1,default:2}},setup:function(e){var n=e,t=(0,r.EW)(function(){var e=n.getValue?n.getValue(n.item):n.item[n.name];return 0!=n.intFormat&&(e=(0,i.hL)(e,2)),e});return function(n,i){return(0,r.uX)(),(0,r.CE)("td",o,[(0,r.eW)((0,a.v_)(t.value),1),0==e.intFormat?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.eW)("  € ")],64)):(0,r.Q3)("v-if",!0)])}}}},2752:(e,n,t)=>{t.d(n,{A:()=>o});var r=t(641),a=t(33),i={class:"col_text"};const o={__name:"LabelCell",props:{item:{type:Object,required:!0},getValue:{type:Function,required:!1},name:{type:String,required:!0}},setup:function(e){var n=e,t=(0,r.EW)(function(){return n.getValue?n.getValue(n.item):n.item[n.name]});return function(e,n){return(0,r.uX)(),(0,r.CE)("td",i,(0,a.v_)(t.value),1)}}}}},o={};function l(e){var n=o[e];if(void 0!==n)return n.exports;var t=o[e]={id:e,loaded:!1,exports:{}};return i[e].call(t.exports,t,t.exports,l),t.loaded=!0,t.exports}l.m=i,e=[],l.O=(n,t,r,a)=>{if(!t){var i=1/0;for(c=0;c<e.length;c++){for(var[t,r,a]=e[c],o=!0,s=0;s<t.length;s++)(!1&a||i>=a)&&Object.keys(l.O).every(e=>l.O[e](t[s]))?t.splice(s--,1):(o=!1,a<i&&(i=a));if(o){e.splice(c--,1);var u=r();void 0!==u&&(n=u)}}return n}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[t,r,a]},l.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return l.d(n,{a:n}),n},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);l.r(a);var i={};n=n||[null,t({}),t([]),t(t)];for(var o=2&r&&e;"object"==typeof o&&!~n.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(n=>i[n]=()=>e[n]);return i.default=()=>e,l.d(a,i),a},l.d=(e,n)=>{for(var t in n)l.o(n,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce((n,t)=>(l.f[t](e,n),n),[])),l.u=e=>e+".min.js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r={},a="enDI:",l.l=(e,n,t,i)=>{if(r[e])r[e].push(n);else{var o,s;if(void 0!==t)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var p=u[c];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==a+t){o=p;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,l.nc&&o.setAttribute("nonce",l.nc),o.setAttribute("data-webpack",a+t),o.src=e),r[e]=[n];var d=(n,t)=>{o.onerror=o.onload=null,clearTimeout(m);var a=r[e];if(delete r[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(t)),n)return n(t)},m=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),s&&document.head.appendChild(o)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),l.j=640,(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var n=l.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})(),(()=>{var e={640:0};l.f.j=(n,t)=>{var r=l.o(e,n)?e[n]:void 0;if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((t,a)=>r=e[n]=[t,a]);t.push(r[2]=a);var i=l.p+l.u(n),o=new Error;l.l(i,t=>{if(l.o(e,n)&&(0!==(r=e[n])&&(e[n]=void 0),r)){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;o.message="Loading chunk "+n+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,r[1](o)}},"chunk-"+n,n)}},l.O.j=n=>0===e[n];var n=(n,t)=>{var r,a,[i,o,s]=t,u=0;if(i.some(n=>0!==e[n])){for(r in o)l.o(o,r)&&(l.m[r]=o[r]);if(s)var c=s(l)}for(n&&n(t);u<i.length;u++)a=i[u],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(c)},t=self.webpackChunkenDI=self.webpackChunkenDI||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),l.nc=void 0;var s=l.O(void 0,[534],()=>l(9173));s=l.O(s)})();