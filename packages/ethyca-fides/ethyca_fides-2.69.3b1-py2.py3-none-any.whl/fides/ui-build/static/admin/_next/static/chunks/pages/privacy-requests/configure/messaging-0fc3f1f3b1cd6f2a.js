(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8593],{13687:function(e,i,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests/configure/messaging",function(){return t(61463)}])},77213:function(e,i,t){"use strict";t.d(i,{Z:function(){return m}});var s=t(24246),n=t(96306),l=t(88038),a=t.n(l),r=t(86677);t(27378);var o=t(25980),c=t(90867),d=t(77830),u=()=>{let e=(0,r.useRouter)();return(0,s.jsx)(n.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(n.xuv,{children:[(0,s.jsxs)(n.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(n.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(n.wpx,{onClick:()=>{e.push(d.fz)},children:"Configure"})]}),(0,s.jsxs)(n.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},m=e=>{let{children:i,title:t,padded:l=!0,mainProps:d}=e,m=(0,o.hz)(),p=(0,r.useRouter)(),x="/privacy-requests"===p.pathname||"/datastore-connection"===p.pathname,h=!(m.flags.privacyRequestsConfiguration&&x),{data:y}=(0,c.JE)(void 0,{skip:h}),{data:j}=(0,c.PW)(void 0,{skip:h}),g=m.flags.privacyRequestsConfiguration&&(!y||!j)&&x;return(0,s.jsxs)(n.kCb,{"data-testid":t,direction:"column",h:"100vh",children:[(0,s.jsxs)(a(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",t]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(n.kCb,{as:"main",direction:"column",py:l?6:0,px:l?10:0,h:l?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[g?(0,s.jsx)(u,{}):null,i]})]})}},71784:function(e,i,t){"use strict";t.d(i,{DE:function(){return o},I3:function(){return n},kN:function(){return a},qX:function(){return r},rE:function(){return l}});var s=t(21910);let n=[...new Map([[s.q2.APPROVED,"Approved"],[s.q2.AWAITING_EMAIL_SEND,"Awaiting email send"],[s.q2.CANCELED,"Canceled"],[s.q2.COMPLETE,"Completed"],[s.q2.DENIED,"Denied"],[s.q2.ERROR,"Error"],[s.q2.IN_PROCESSING,"In progress"],[s.q2.PENDING,"New"],[s.q2.PAUSED,"Paused"],[s.q2.IDENTITY_UNVERIFIED,"Unverified"],[s.q2.REQUIRES_INPUT,"Requires input"],[s.q2.REQUIRES_MANUAL_FINALIZATION,"Requires finalization"]])].map(e=>{let[i,t]=e;return{label:t,value:i}}),l=new Map([[s.Us.ACCESS,"Access"],[s.Us.ERASURE,"Erasure"],[s.Us.CONSENT,"Consent"],[s.Us.UPDATE,"Update"]]),a=[...l].map(e=>{let[i,t]=e;return{label:t,value:i}}),r={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},o={local:"local",s3:"s3",gcs:"gcs"}},61463:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return v}});var s=t(24246),n=t(96306),l=t(27378),a=t(812),r=t(41841),o=t(77213),c=t(77830),d=t(58754),u=t(7426),m=t(71784),p=t(90867),x=t(34090),h=t(40324),y=e=>{let{messagingDetails:i}=e,{successAlert:t}=(0,r.VY)(),{handleError:l}=(0,r.HK)(),[o]=(0,p.SU)(),c=i.service_type===m.qX.twilio_email||i.service_type===m.qX.mailgun,d=i.service_type===m.qX.twilio_text,u=async e=>{if(c){let i=await o({email:e.email});(0,a.D4)(i)?l(i.error):t("Test message successfully sent.")}if(d){let i=await o({phone_number:e.phone});(0,a.D4)(i)?l(i.error):t("Test message successfully sent.")}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.izJ,{mt:10}),(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,mb:5,children:"Test connection"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:{email:"",phone:""},onSubmit:u,children:e=>{let{isSubmitting:i,resetForm:t}=e;return(0,s.jsxs)(x.l0,{children:[c?(0,s.jsx)(h.j0,{name:"email",label:"Email",placeholder:"youremail@domain.com",isRequired:!0}):null,d?(0,s.jsx)(h.j0,{name:"phone",label:"Phone",placeholder:"+10000000000",isRequired:!0}):null,(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:()=>t(),className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{disabled:i,htmlType:"submit",type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})})]})},j=()=>{var e;let{successAlert:i}=(0,r.VY)(),[t,o]=(0,l.useState)(""),{handleError:c}=(0,r.HK)(),{data:d}=(0,p.S3)({type:m.qX.mailgun}),[u]=(0,p.h9)(),[j]=(0,p.iI)(),g=async e=>{let t=await u({service_type:m.qX.mailgun,details:{is_eu_domain:"false",domain:e.domain}});(0,a.D4)(t)?c(t.error):(i("Mailgun email successfully updated. You can now enter your security key."),o("apiKey"))},_=async e=>{let t=await j({details:{mailgun_api_key:e.api_key},service_type:m.qX.mailgun});(0,a.D4)(t)?c(t.error):(i("Mailgun security key successfully updated."),o("testConnection"))},f={domain:null!==(e=null==d?void 0:d.details.domain)&&void 0!==e?e:""};return(0,s.jsxs)(n.xuv,{children:[(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Mailgun messaging configuration"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:f,onSubmit:g,enableReinitialize:!0,children:e=>{let{isSubmitting:i,handleReset:t}=e;return(0,s.jsxs)(x.l0,{children:[(0,s.jsx)(n.Kqy,{mt:5,spacing:5,children:(0,s.jsx)(h.j0,{name:"domain",label:"Domain",placeholder:"Enter domain","data-testid":"option-twilio-domain",isRequired:!0})}),(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:t,className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{htmlType:"submit",disabled:i,type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})}),"apiKey"===t||"testConnection"===t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.izJ,{mt:10}),(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:{api_key:""},onSubmit:_,children:e=>{let{isSubmitting:i,handleReset:t}=e;return(0,s.jsxs)(x.l0,{children:[(0,s.jsx)(h.j0,{name:"api_key",label:"API key",type:"password",isRequired:!0}),(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:t,className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{disabled:i,htmlType:"submit",type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null,"testConnection"===t?(0,s.jsx)(y,{messagingDetails:d||{service_type:m.qX.mailgun}}):null]})},g=()=>{var e;let[i,t]=(0,l.useState)(""),{successAlert:o}=(0,r.VY)(),{handleError:c}=(0,r.HK)(),{data:d}=(0,p.S3)({type:m.qX.twilio_email}),[u]=(0,p.h9)(),[j]=(0,p.iI)(),g=async e=>{let i=await u({service_type:m.qX.twilio_email,details:{twilio_email_from:e.email}});(0,a.D4)(i)?c(i.error):(o("Twilio email successfully updated. You can now enter your security key."),t("configureTwilioEmailSecrets"))},_=async e=>{let i=await j({details:{twilio_api_key:e.api_key},service_type:m.qX.twilio_email});(0,a.D4)(i)?c(i.error):(o("Twilio email secrets successfully updated."),t("testConnection"))},f={email:null!==(e=null==d?void 0:d.details.twilio_email_from)&&void 0!==e?e:""};return(0,s.jsxs)(n.xuv,{children:[(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio Email messaging configuration"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:f,onSubmit:g,enableReinitialize:!0,children:e=>{let{isSubmitting:i,handleReset:t}=e;return(0,s.jsxs)(x.l0,{children:[(0,s.jsx)(n.Kqy,{mt:5,spacing:5,children:(0,s.jsx)(h.j0,{name:"email",label:"Email",placeholder:"Enter email",isRequired:!0})}),(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:()=>t(),className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{disabled:i,htmlType:"submit",type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})}),"configureTwilioEmailSecrets"===i||"testConnection"===i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.izJ,{mt:10}),(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Security key"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:{api_key:""},onSubmit:_,children:e=>{let{isSubmitting:i,handleReset:t}=e;return(0,s.jsxs)(x.l0,{children:[(0,s.jsx)(n.Kqy,{mt:5,spacing:5,children:(0,s.jsx)(h.j0,{name:"api_key",label:"API key",type:"password",isRequired:!0})}),(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:()=>t(),className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{disabled:i,htmlType:"submit",type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})})]}):null,"testConnection"===i?(0,s.jsx)(y,{messagingDetails:d||{service_type:m.qX.twilio_email}}):null]})},_=()=>{let{successAlert:e}=(0,r.VY)(),{handleError:i}=(0,r.HK)(),[t,o]=(0,l.useState)(""),{data:c}=(0,p.S3)({type:"twilio_text"}),[d]=(0,p.iI)(),u=async t=>{let s=await d({details:{twilio_account_sid:t.account_sid,twilio_auth_token:t.auth_token,twilio_messaging_service_sid:t.messaging_service_sid,twilio_sender_phone_number:t.phone},service_type:m.qX.twilio_text});(0,a.D4)(s)?i(s.error):(e("Twilio text secrets successfully updated."),o("testConnection"))};return(0,s.jsxs)(n.xuv,{children:[(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Twilio SMS messaging configuration"}),(0,s.jsx)(n.Kqy,{children:(0,s.jsx)(x.J9,{initialValues:{account_sid:"",auth_token:"",messaging_service_sid:"",phone:""},onSubmit:u,enableReinitialize:!0,children:e=>{let{isSubmitting:i,handleReset:t}=e;return(0,s.jsxs)(x.l0,{children:[(0,s.jsxs)(n.Kqy,{mt:5,spacing:5,children:[(0,s.jsx)(h.j0,{name:"account_sid",label:"Account SID",placeholder:"Enter account SID",isRequired:!0}),(0,s.jsx)(h.j0,{name:"auth_token",label:"Auth token",placeholder:"Enter auth token",type:"password",isRequired:!0}),(0,s.jsx)(h.j0,{name:"messaging_service_sid",label:"Messaging Service SID",placeholder:"Enter messaging service SID"}),(0,s.jsx)(h.j0,{name:"phone",label:"Phone Number",placeholder:"Enter phone number"})]}),(0,s.jsxs)(n.xuv,{mt:10,children:[(0,s.jsx)(n.wpx,{onClick:()=>t(),className:"mr-2",children:"Cancel"}),(0,s.jsx)(n.wpx,{disabled:i,htmlType:"submit",type:"primary","data-testid":"save-btn",children:"Save"})]})]})}})}),"testConnection"===t?(0,s.jsx)(y,{messagingDetails:c||{service_type:m.qX.twilio_text}}):null]})},f=()=>{let{successAlert:e}=(0,r.VY)(),{handleError:i}=(0,r.HK)(),[t,x]=(0,l.useState)(""),[h]=(0,p.h9)(),[y]=(0,u.L)(),{data:f}=(0,p.JE)();(0,l.useEffect)(()=>{f&&x(null==f?void 0:f.service_type)},[f]);let v=async t=>{let{value:s}=t.target,n=await y({notifications:{notification_service_type:s,send_request_completion_notification:!0,send_request_receipt_notification:!0,send_request_review_notification:!0},execution:{subject_identity_verification_required:!0}});if((0,a.D4)(n))i(n.error);else if(s!==m.qX.twilio_text)x(s);else{let t=await h({service_type:m.qX.twilio_text});(0,a.D4)(t)?i(t.error):(e("Messaging provider saved successfully."),x(s))}};return(0,s.jsxs)(o.Z,{title:"Configure Privacy Requests - Messaging",children:[(0,s.jsx)(d.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests",href:c.Jw},{title:"Configure requests",href:c.fz},{title:"Messaging"}]}),(0,s.jsx)(n.X6q,{mb:5,fontSize:"md",fontWeight:"semibold",children:"Configure your messaging provider"}),(0,s.jsxs)(n.xuv,{display:"flex",flexDirection:"column",width:"50%",children:[(0,s.jsxs)(n.xuv,{children:["Fides requires a messsaging provider for sending processing notices to privacy request subjects, and allows for Subject Identity Verification in privacy requests. Please follow the"," ",(0,s.jsx)(n.xvT,{as:"span",color:"complimentary.500",children:"documentation"})," ","to setup a messaging service that Fides supports. Ensure you have completed the setup for the preferred messaging provider and have the details handy prior to the following steps."]}),(0,s.jsx)(n.X6q,{fontSize:"md",fontWeight:"semibold",mt:10,children:"Choose service type to configure"}),(0,s.jsx)(n.y02.Group,{onChange:v,value:t,"data-testid":"privacy-requests-messaging-provider-selection",className:"p-3",children:(0,s.jsxs)(n.jqI,{children:[(0,s.jsx)(n.y02,{value:m.qX.mailgun,"data-testid":"option-mailgun",children:"Mailgun Email"},m.qX.mailgun),(0,s.jsx)(n.y02,{value:m.qX.twilio_email,"data-testid":"option-twilio-email",children:"Twilio Email"},m.qX.twilio_email),(0,s.jsx)(n.y02,{value:m.qX.twilio_text,"data-testid":"option-twilio-sms",children:"Twilio SMS"},m.qX.twilio_text)]})}),t===m.qX.mailgun?(0,s.jsx)(j,{}):null,t===m.qX.twilio_email?(0,s.jsx)(g,{}):null,t===m.qX.twilio_text?(0,s.jsx)(_,{}):null]})]})},v=()=>(0,s.jsx)(f,{})}},function(e){e.O(0,[431,4164,2888,9774,179],function(){return e(e.s=13687)}),_N_E=e.O()}]);