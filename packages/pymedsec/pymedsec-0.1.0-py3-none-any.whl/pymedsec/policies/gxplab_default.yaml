schema_version: '1.0'
name: 'GxP Laboratory Default Policy'
description: 'Default policy for GxP/CLIA compliance in laboratory image processing'

sanitization:
  dicom:
    remove_private_tags: true
    regenerate_uids: true
    preserve_technical_tags: true
    burned_in_annotation_policy: 'strict'

  exif:
    strip_all_metadata: true
    preserve_orientation: false

  ocr:
    enabled: true
    confidence_threshold: 70 # Higher threshold for lab accuracy
    redaction_method: 'blackout'

encryption:
  algorithm: 'AES-256-GCM'
  key_rotation_days: 30 # More frequent for lab compliance
  require_kms: true
  nonce_size_bits: 96

security:
  allow_plaintext_disk: false
  require_policy_match: true
  require_integrity_verification: true
  max_batch_size: 8 # Small batches for traceability
  require_tee: true # Consider TEE for lab environments

audit:
  log_all_operations: true
  include_file_hashes: true
  retention_days: 3650 # 10 years for lab records
  hmac_secret_rotation_days: 90
  rolling_anchor_interval: 100 # More frequent anchors

compliance:
  hipaa_mode: true
  gdpr_mode: false
  gxp_mode: true
  purpose_limitation: 'laboratory_testing'
  data_minimization: true
  allowed_purposes:
    - 'laboratory_testing'
    - 'quality_control'
    - 'method_validation'
    - 'regulatory_submission'

gxp_specific:
  # 21 CFR Part 11 - Electronic Records
  electronic_signature_support: true
  audit_trail_required: true
  access_control_required: true
  data_integrity_controls: true

  # Change control
  version_control_required: true
  change_approval_required: true
  impact_assessment_required: true

  # Validation
  software_validation_required: true
  system_validation_required: true
  method_validation_required: true

  # Documentation
  validation_documentation_required: true
  user_requirements_documented: true
  functional_specifications_documented: true
  risk_assessment_documented: true

  # Quality management
  quality_system_compliance: 'ISO_13485' # or ISO_15189, ISO_17025
  risk_management_standard: 'ISO_14971'

clia_specific:
  # Laboratory requirements
  proficiency_testing_support: true
  quality_control_required: true
  calibration_verification_required: true

  # Personnel qualifications
  qualified_personnel_required: true
  competency_assessment_required: true

  # Quality assurance
  quality_assurance_program: true
  corrective_action_system: true

  # Method performance
  analytical_performance_verified: true
  reference_range_verified: true
  accuracy_verified: true
  precision_verified: true

traceability:
  batch_tracking_required: true
  reagent_lot_tracking: true
  instrument_tracking: true
  operator_tracking: true
  environmental_conditions_tracking: true

validation_requirements:
  installation_qualification: true
  operational_qualification: true
  performance_qualification: true
  ongoing_verification: true
  change_control_validation: true
