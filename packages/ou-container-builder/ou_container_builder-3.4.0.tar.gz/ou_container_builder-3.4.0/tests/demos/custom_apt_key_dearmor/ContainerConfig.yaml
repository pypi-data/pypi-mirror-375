version: "3"
module:
  code: CustomAptKeyDearmor
  presentation: "1"
packs:
  jupyterlab: {}
  ipykernel: {}
server:
  access_token: test
  default_path: /lab
image:
  base: python:3.10-bullseye
sources:
  apt:
    - name: mongodb
      key_url: https://www.mongodb.org/static/pgp/server-5.0.asc
      dearmor: True
      deb:
        url: http://repo.mongodb.org/apt/debian
        distribution: buster/mongodb-org/5.0
        component: main
packages:
  apt:
    deploy:
      - mongodb-org
content:
  - source: ./mongodb-org/mongod
    target: /etc/init.d/mongod
    overwrite: always
  - source: ./mongodb-org/mongod.conf
    target: /etc/mongod.conf
    overwrite: always
scripts:
  - stage: deploy
    commands:
      - MONGO_DB_PATH=/var/db/data/mongo
      - mkdir -p ${MONGO_DB_PATH}
      - chmod ugo+rx /etc/init.d/mongod
  - stage: startup
    name: testing
    commands:
      - sleep 10
services:
  - mongod
