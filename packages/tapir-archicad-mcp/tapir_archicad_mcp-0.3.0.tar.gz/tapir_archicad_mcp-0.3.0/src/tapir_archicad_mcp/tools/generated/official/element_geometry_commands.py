# This file is auto-generated by generate_tools.py. DO NOT EDIT.
import logging
from pydantic import ValidationError
from multiconn_archicad.basic_types import Port
from tapir_archicad_mcp.context import multi_conn_instance
from tapir_archicad_mcp.tools.tool_registry import register_tool_for_dispatch

from multiconn_archicad.models.official.commands import (
    Get2DBoundingBoxesParameters,
Get2DBoundingBoxesResult
)


log = logging.getLogger()

def get2_d_bounding_boxes(port: int, params: Get2DBoundingBoxesParameters) -> Get2DBoundingBoxesResult:
    """
    Get the 2D bounding box of elements identified by their GUIDs. The bounding box is calculated from the global origin on the floor plan view. The output is the array of the bounding boxes respective to the input GUIDs. Only works for elements detailed in <i>Element Information</i>.
    """
    multi_conn = multi_conn_instance.get()
    target_port = Port(port)
    if target_port not in multi_conn.active:
        raise ValueError(f"Port {port} is not an active Archicad connection.")
    conn_header = multi_conn.active[target_port]
    try:

        result_dict = conn_header.core.post_command(
            command="API.Get2DBoundingBoxes",
            parameters=params.model_dump(mode='json')
        )
        return Get2DBoundingBoxesResult.model_validate(result_dict)

    except ValidationError as e:
        log.error(f"Validation error for Get2DBoundingBoxes result: {e}")
        raise ValueError(f"Received an invalid response from the Archicad API: {e}")
    except Exception as e:
        log.error(f"Error executing Get2DBoundingBoxes on port {port}: {e}")
        raise e


register_tool_for_dispatch(
    get2_d_bounding_boxes,
    name="elements_get2_d_bounding_boxes",
    title="Get2DBoundingBoxes",
    description="Get the 2D bounding box of elements identified by their GUIDs. The bounding box is calculated from the global origin on the floor plan view. The output is the array of the bounding boxes respective to the input GUIDs. Only works for elements detailed in <i>Element Information</i>.",
    params_model=Get2DBoundingBoxesParameters,
    result_model=Get2DBoundingBoxesResult
)
