import{d as X,a as Y,b as Z,z as ee,r as p,L as te,M as ae,o as oe,K as L,y as P,a6 as ne,aK as se,c as q,e as N,f as v,h as s,n as k,j as t,d9 as ie,N as re,t as g,w as r,a3 as le,a4 as ue,A as de,da as S,J as I,B as ce,db as pe,Q as _e,R as me,p as fe,k as ve,I as ge,dc as ye,dd as he,T as Ge,de as be,df as ke,aS as xe,H as we}from"./index-B2xfjOzF.js";import{A as ze}from"./Add-jjALUlFz.js";import{_ as Le,a as Ne}from"./Tabs-Bx15qgEn.js";import{_ as Ie}from"./Alert-BDlK74zR.js";import{_ as Ce,a as Me}from"./FormItem-Ct9xzd5D.js";import"./Add-D4qD_bnP.js";import"./debounce-D7Ri4zDg.js";const Re={class:"flex"},Ue={class:"text-xl mt-[26px] flex items-center gap-1"},$e={class:"flex justify-between items-center w-full"},Be={class:"flex-1"},Pe={class:"text-xl"},qe={class:"flex justify-end"},Se=X({__name:"DeviceGroup",setup(Te){const{t:n}=Y(),T=Z(),C=ee(),_=p(!1),M=p(),c=p({description:void 0,device_group_name:void 0}),V={description:{required:!0,message:n("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:n("deviceGroup.groupNameErrMsg")}},R=()=>{_.value=!1,c.value={description:void 0,device_group_name:void 0}},j=()=>{var o;d.value||(d.value=!0,(o=M.value)==null||o.validate(async e=>{if(e){d.value=!1;return}const[i,l]=await ye({...c.value,organization_id:u.value});d.value=!1,!i&&l&&l.status===0&&m()}))},A=o=>{o||R()},x=p(),y=te({page:1,per_page:ae,total:0}),d=p(!1),u=p(),m=async o=>{d.value=!0,x.value=void 0;const[e,i]=await he({...Ge(y),org_id:o||u.value});d.value=!1,!e&&i&&i.status===0&&(x.value=i.data.list,y.total=i.data.total),_.value&&R()},E=async(o,e)=>{const[i,l]=await be({device_id:e,hidden:!o});!i&&(l==null?void 0:l.status)===0&&m()},h=p(),K=async()=>{var i,l;const[o,e]=await ke();if(!o&&(e==null?void 0:e.status)===0){h.value=(i=e.data)==null?void 0:i.organizations;const G=(l=e.data)==null?void 0:l.organizations;if(C.query.org)u.value=+C.query.org,xe(()=>{m()});else if(G&&G.length>0){const f=G[0].organization_id;f&&(u.value=f,m(f))}}};oe(()=>{K()});const O=[{title:n("deviceGroup.id"),key:"create_uid"},{title:n("deviceGroup.groupId"),key:"device_group_id"},{title:n("deviceGroup.groupName"),key:"device_group_name"},{title:n("deviceGroup.description"),key:"description"},{title:n("deviceGroup.createTime"),key:"create_time"},{title:n("deviceGroup.status"),key:"status",render:o=>{var e;if(o.status)return L(ne,{type:((e=P[o.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return n((i=P[o.status])==null?void 0:i.text)}})}},{title:n("deviceGroup.show2desktop"),key:"status",render:o=>{if(o.status)return L("div",{onClick:e=>e.stopPropagation()},L(se,{value:!o.hidden,onUpdateValue:e=>E(e,o.device_group_id)}))}}],H=({device_group_name:o})=>({class:"cursor-pointer",onClick:()=>{T.push({name:"taskList",query:{device_group_name:o}})}});return(o,e)=>{var $,B;const i=re,l=Le,G=Ne,f=ce,F=_e,J=Ie,w=Me,U=ve,Q=Ce,D=fe,W=ge;return N(),q("div",Re,[v("div",null,[v("div",Ue,[s(i,{component:t(ie)},null,8,["component"]),k(" "+g(t(n)("org.orgList")),1)]),s(G,{placement:"left","bar-width":300,type:"card",value:t(u),"onUpdate:value":[e[0]||(e[0]=a=>I(u)?u.value=a:null),m],class:"pr-5 mt-7"},{default:r(()=>[(N(!0),q(le,null,ue(t(h),a=>(N(),de(l,{key:a.organization_id,name:a.organization_id,disabled:t(d),class:"min-w-[200px]"},{default:r(()=>[v("div",$e,[k(g(a.organization_name)+" ",1),s(S,{role:a.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),v("div",Be,[s(pe,{title:(B=($=t(h))==null?void 0:$.find(a=>a.organization_id==t(u)))==null?void 0:B.organization_name},{tag:r(()=>{var a,b;return[s(S,{role:(b=(a=t(h))==null?void 0:a.find(z=>z.organization_id==t(u)))==null?void 0:b.user_role},null,8,["role"])]}),extra:r(()=>[s(f,{type:"primary",onClick:e[1]||(e[1]=a=>_.value=!0)},{icon:r(()=>[s(t(ze))]),default:r(()=>[k(" "+g(t(n)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),s(F,{columns:O,data:t(x),pagination:!1,loading:t(d),"row-props":H},null,8,["data","loading"]),s(me,{"page-info":t(y),"onUpdate:pageInfo":e[2]||(e[2]=a=>I(y)?y.value=a:null),onUpdateList:m},null,8,["page-info"]),s(W,{show:t(_),"onUpdate:show":e[5]||(e[5]=a=>I(_)?_.value=a:null),"on-update:show":A},{default:r(()=>[s(D,{style:{width:"600px"},size:"huge",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[s(J,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[k(g(t(n)("deviceGroup.tips")),1)]),_:1}),s(Q,{ref_key:"formRef",ref:M,model:t(c),rules:V},{default:r(()=>[s(w,{label:t(n)("deviceGroup.orgName"),path:"device_group_name"},{default:r(()=>{var a,b;return[v("div",Pe,g((b=(a=t(h))==null?void 0:a.find(z=>z.organization_id==t(u)))==null?void 0:b.organization_name),1)]}),_:1},8,["label"]),s(w,{label:t(n)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[s(U,{value:t(c).device_group_name,"onUpdate:value":e[3]||(e[3]=a=>t(c).device_group_name=a),placeholder:t(n)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(w,{label:t(n)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[s(U,{value:t(c).description,"onUpdate:value":e[4]||(e[4]=a=>t(c).description=a),placeholder:t(n)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),v("div",qe,[s(f,{type:"primary",loading:t(d),onClick:j},{default:r(()=>[k(g(t(n)("deviceGroup.create")),1)]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])])])}}}),Fe=we(Se,[["__scopeId","data-v-ea95f2cb"]]);export{Fe as default};
