# FastAPI Scaffold - ä¼ä¸šçº§è„šæ‰‹æ¶é¡¹ç›®

ä¸€å¥—åŸºäº FastAPI çš„ä¼ä¸šçº§è„šæ‰‹æ¶é¡¹ç›®ï¼Œæ—¨åœ¨ç®€åŒ–å¼€å‘è¿‡ç¨‹ï¼Œæä¾›å®Œæ•´çš„åç«¯å¼€å‘è§£å†³æ–¹æ¡ˆã€‚

## âœ¨ ç‰¹æ€§

- ğŸš€ **è·¯ç”±è‡ªåŠ¨æ³¨å†Œ** - è‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œ API è·¯ç”±
- ğŸ”§ **å¤šç¯å¢ƒé…ç½®** - æ”¯æŒå¼€å‘ã€ç”Ÿäº§ã€æµ‹è¯•ç¯å¢ƒé…ç½®
- ğŸ“ **æ—¥å¿—ç³»ç»Ÿ** - æ”¯æŒæ§åˆ¶å°ä¸æ–‡ä»¶åŒè¾“å‡ºï¼Œå¯é…ç½®æ—¥å¿—çº§åˆ«å’Œå­˜å‚¨
- âš¡ **ç»Ÿä¸€å¼‚å¸¸å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶å’Œé”™è¯¯æ—¥å¿—è®°å½•
- ğŸ“Š **ç»Ÿä¸€å“åº”æ ¼å¼** - æ ‡å‡†åŒ–çš„ API å“åº”æ ¼å¼ï¼Œè‡ªåŠ¨åŒ…è£…å¤„ç†
- ğŸ—„ï¸ **å¤šæ•°æ®æºæ”¯æŒ** - åŸºäº SQLAlchemyï¼Œæ”¯æŒé…ç½®å¤šä¸ªæ•°æ®æº
- ğŸ—ï¸ **åˆ†å±‚æ¶æ„** - æ¸…æ™°çš„ä»£ç åˆ†å±‚ï¼šAPI å±‚ã€æœåŠ¡å±‚ã€ä»“å‚¨å±‚ã€æ¨¡å‹å±‚
- ğŸ’¾ **ç¼“å­˜æ”¯æŒ** - åŸºäº Redis çš„ç¼“å­˜ç³»ç»Ÿï¼Œå¯é…ç½®å¼€å¯/å…³é—­
- ğŸ”’ **å®‰å…¨ç‰¹æ€§** - å¯†ç åŠ å¯†ã€æ•°æ®éªŒè¯ã€CORS é…ç½®

## ğŸ“ é¡¹ç›®ç»“æ„

```
lesscode-fastapi/
â”œâ”€â”€ app/                    # åº”ç”¨æ ¸å¿ƒç›®å½•\n
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±å±‚ï¼ˆæ§åˆ¶å™¨ï¼‰\n
â”‚   â”‚   â””â”€â”€ user.py        # ç”¨æˆ· API ç¤ºä¾‹\n
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—\n
â”‚   â”‚   â”œâ”€â”€ cache.py       # ç¼“å­˜ç®¡ç†\n
â”‚   â”‚   â”œâ”€â”€ database.py    # æ•°æ®åº“è¿æ¥\n
â”‚   â”‚   â”œâ”€â”€ exceptions.py  # è‡ªå®šä¹‰å¼‚å¸¸\nâ”‚   â”‚   â”œâ”€â”€ exception_handlers.py # å¼‚å¸¸å¤„ç†å™¨\nâ”‚   â”‚   â”œâ”€â”€ logging.py     # æ—¥å¿—é…ç½®\nâ”‚   â”‚   â””â”€â”€ router.py      # è·¯ç”±æ³¨å†Œå™¨\nâ”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹å±‚\nâ”‚   â”‚   â”œâ”€â”€ base.py        # åŸºç¡€æ¨¡å‹\nâ”‚   â”‚   â””â”€â”€ user.py        # ç”¨æˆ·æ¨¡å‹ç¤ºä¾‹\nâ”‚   â”œâ”€â”€ repositories/      # æ•°æ®è®¿é—®å±‚ï¼ˆä»“å‚¨ï¼‰\nâ”‚   â”‚   â”œâ”€â”€ base.py        # åŸºç¡€ä»“å‚¨ç±»\nâ”‚   â”‚   â””â”€â”€ user.py        # ç”¨æˆ·ä»“å‚¨ç¤ºä¾‹\nâ”‚   â”œâ”€â”€ schemas/           # æ•°æ®éªŒè¯æ¨¡å¼\nâ”‚   â”‚   â”œâ”€â”€ response.py    # å“åº”æ¨¡å¼\nâ”‚   â”‚   â””â”€â”€ user.py        # ç”¨æˆ·æ¨¡å¼ç¤ºä¾‹\nâ”‚   â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘å±‚\nâ”‚   â”‚   â””â”€â”€ user.py        # ç”¨æˆ·æœåŠ¡ç¤ºä¾‹\nâ”‚   â””â”€â”€ utils/             # å·¥å…·å‡½æ•°\nâ”‚       â””â”€â”€ response.py    # å“åº”å·¥å…·\nâ”œâ”€â”€ config/                # é…ç½®æ¨¡å—\nâ”‚   â””â”€â”€ settings.py        # é…ç½®ç®¡ç†\nâ”œâ”€â”€ logs/                  # æ—¥å¿—ç›®å½•\nâ”œâ”€â”€ tests/                 # æµ‹è¯•ç›®å½•\nâ”œâ”€â”€ scripts/               # è„šæœ¬ç›®å½•\nâ”œâ”€â”€ .env.development       # å¼€å‘ç¯å¢ƒé…ç½®\nâ”œâ”€â”€ .env.production        # ç”Ÿäº§ç¯å¢ƒé…ç½®\nâ”œâ”€â”€ .env.testing           # æµ‹è¯•ç¯å¢ƒé…ç½®\nâ”œâ”€â”€ main.py                # åº”ç”¨å…¥å£\nâ”œâ”€â”€ run.py                 # å¯åŠ¨è„šæœ¬\nâ””â”€â”€ requirements.txt       # é¡¹ç›®ä¾èµ–\n```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash\npip install -r requirements.txt\n```
### 2. é…ç½®ç¯å¢ƒ\n\nå¤åˆ¶å¹¶ä¿®æ”¹ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š

```bash\n# å¼€å‘ç¯å¢ƒ\ncp .env.development .env\n\n# æˆ–æ ¹æ®éœ€è¦é€‰æ‹©å…¶ä»–ç¯å¢ƒ\ncp .env.production .env\ncp .env.testing .env\n```\n\n### 3. å¯åŠ¨åº”ç”¨\n\n#### ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰\n\n```bash\n# å¼€å‘ç¯å¢ƒå¯åŠ¨ï¼ˆé»˜è®¤ï¼‰\npython run.py\n\n# æŒ‡å®šç¯å¢ƒå¯åŠ¨\npython run.py --env development\npython run.py --env production\npython run.py --env testing\n\n# è‡ªå®šä¹‰å‚æ•°å¯åŠ¨\npython run.py --host 0.0.0.0 --port 8080 --reload\n```\n\n#### ç›´æ¥ä½¿ç”¨ uvicorn\n\n```bash\nuvicorn main:app --reload --host 0.0.0.0 --port 8000\n```\n\n### 4. è®¿é—®åº”ç”¨\n\n- API æ–‡æ¡£ï¼šhttp://localhost:8000/docs\n- ReDoc æ–‡æ¡£ï¼šhttp://localhost:8000/redoc\n- å¥åº·æ£€æŸ¥ï¼šhttp://localhost:8000/health\n\n## âš™ï¸ é…ç½®è¯´æ˜\n\n### ç¯å¢ƒé…ç½®æ–‡ä»¶\n\né¡¹ç›®æ”¯æŒä¸‰ç§ç¯å¢ƒé…ç½®ï¼š\n\n- `.env.development` - å¼€å‘ç¯å¢ƒ\n- `.env.production` - ç”Ÿäº§ç¯å¢ƒ  \n- `.env.testing` - æµ‹è¯•ç¯å¢ƒ\n\n### ä¸»è¦é…ç½®é¡¹\n\n```bash\n# åº”ç”¨é…ç½®\nAPP_NAME=FastAPI Scaffold\nDEBUG=true\nENVIRONMENT=development\nHOST=0.0.0.0\nPORT=8000\n\n# æ•°æ®åº“é…ç½®\nDATABASE_URL=sqlite:///./dev.db\nDATABASE_POOL_SIZE=10\n\n# å¤šæ•°æ®æºé…ç½®ï¼ˆå¯é€‰ï¼‰\nDATABASE_URLS=main=sqlite:///./main.db,analytics=sqlite:///./analytics.db\n\n# Redis ç¼“å­˜é…ç½®\nREDIS_URL=redis://localhost:6379/0\nREDIS_ENABLED=false\n\n# æ—¥å¿—é…ç½®\nLOG_LEVEL=DEBUG\nLOG_FILE=logs/app.log\nLOG_ROTATION=10 MB\nLOG_RETENTION=10 days\n\n# JWT é…ç½®\nSECRET_KEY=your-secret-key\nACCESS_TOKEN_EXPIRE_MINUTES=30\n```\n\n## ğŸ—ï¸ æ¶æ„è®¾è®¡\n\n### åˆ†å±‚æ¶æ„\n\n1. **API å±‚ (app/api/)** - è·¯ç”±å’Œè¯·æ±‚å¤„ç†\n2. **æœåŠ¡å±‚ (app/services/)** - ä¸šåŠ¡é€»è¾‘å¤„ç†\n3. **ä»“å‚¨å±‚ (app/repositories/)** - æ•°æ®è®¿é—®æŠ½è±¡\n4. **æ¨¡å‹å±‚ (app/models/)** - æ•°æ®åº“æ¨¡å‹å®šä¹‰\n\n### æ•°æ®æµ\n\n```\nAPI å±‚ â†’ æœåŠ¡å±‚ â†’ ä»“å‚¨å±‚ â†’ æ¨¡å‹å±‚ â†’ æ•°æ®åº“\n  â†‘        â†‘        â†‘        â†‘\nè¯·æ±‚å¤„ç†  ä¸šåŠ¡é€»è¾‘  æ•°æ®è®¿é—®  æ•°æ®æ¨¡å‹\n```\n\n## ğŸ’¾ æ•°æ®åº“ä½¿ç”¨\n\n### å•æ•°æ®æº\n\n```python\nfrom app.core.database import get_db\nfrom sqlalchemy.orm import Session\n\ndef some_function(db: Session = Depends(get_db)):\n    # ä½¿ç”¨é»˜è®¤æ•°æ®åº“\n    pass\n```\n\n### å¤šæ•°æ®æº\n\n```python\nfrom app.core.database import get_db\n\ndef some_function():\n    # ä½¿ç”¨æŒ‡å®šæ•°æ®åº“\n    with get_db_context(\"analytics\") as db:\n        # æ•°æ®åº“æ“ä½œ\n        pass\n```\n\n## ğŸ”„ ç¼“å­˜ä½¿ç”¨\n\n### å¯ç”¨ç¼“å­˜\n\nåœ¨ç¯å¢ƒé…ç½®ä¸­è®¾ç½®ï¼š\n```bash\nREDIS_ENABLED=true\nREDIS_URL=redis://localhost:6379/0\n```\n\n### ä½¿ç”¨ç¼“å­˜è£…é¥°å™¨\n\n```python\nfrom app.core.cache import cached, cache_clear\n\n@cached(key_prefix=\"user\", expire=3600)\nasync def get_user_data(user_id: int):\n    # æ•°æ®è·å–é€»è¾‘\n    return user_data\n\n@cache_clear([\"user:*\"])\nasync def update_user_data(user_id: int, data):\n    # æ•°æ®æ›´æ–°é€»è¾‘\n    pass\n```\n\n## ğŸ“ æ·»åŠ æ–°åŠŸèƒ½\n\n### 1. åˆ›å»ºæ¨¡å‹\n\n```python\n# app/models/your_model.py\nfrom sqlalchemy import Column, String\nfrom app.models.base import BaseModel\n\nclass YourModel(BaseModel):\n    __tablename__ = \"your_table\"\n    \n    name = Column(String(100), nullable=False)\n```\n\n### 2. åˆ›å»º Schema\n\n```python\n# app/schemas/your_schema.py\nfrom pydantic import BaseModel\n\nclass YourSchema(BaseModel):\n    name: str\n    \n    class Config:\n        from_attributes = True\n```\n\n### 3. åˆ›å»ºä»“å‚¨\n\n```python\n# app/repositories/your_repository.py\nfrom app.repositories.base import BaseRepository\nfrom app.models.your_model import YourModel\n\nclass YourRepository(BaseRepository[YourModel]):\n    def __init__(self, database_name: str = \"default\"):\n        super().__init__(YourModel, database_name)\n```\n\n### 4. åˆ›å»ºæœåŠ¡\n\n```python\n# app/services/your_service.py\nfrom app.repositories.your_repository import YourRepository\n\nclass YourService:\n    def __init__(self, database_name: str = \"default\"):\n        self.repo = YourRepository(database_name)\n    \n    async def get_data(self, id: int):\n        return self.repo.get(id)\n```\n\n### 5. åˆ›å»º API\n\n```python\n# app/api/your_api.py\nfrom fastapi import APIRouter, Depends\nfrom app.services.your_service import YourService\n\nrouter = APIRouter()\nPREFIX = \"/your-resource\"\nTAGS = [\"Your Resource\"]\n\n@router.get(\"/{id}\")\nasync def get_item(id: int, service: YourService = Depends()):\n    return await service.get_data(id)\n```\n\n## ğŸ” æ—¥å¿—ä½¿ç”¨\n\n```python\nfrom app.core.logging import get_logger\n\nlogger = get_logger(__name__)\n\nlogger.info(\"ä¿¡æ¯æ—¥å¿—\")\nlogger.error(\"é”™è¯¯æ—¥å¿—\")\nlogger.warning(\"è­¦å‘Šæ—¥å¿—\")\nlogger.debug(\"è°ƒè¯•æ—¥å¿—\")\n```\n\n## ğŸš¦ å¼‚å¸¸å¤„ç†\n\n```python\nfrom app.core.exceptions import (\n    BusinessException,\n    ValidationException,\n    ResourceNotFoundException\n)\n\n# ä¸šåŠ¡å¼‚å¸¸\nraise BusinessException(\"ä¸šåŠ¡é€»è¾‘é”™è¯¯\")\n\n# éªŒè¯å¼‚å¸¸\nraise ValidationException(\"æ•°æ®éªŒè¯å¤±è´¥\")\n\n# èµ„æºæœªæ‰¾åˆ°\nraise ResourceNotFoundException(\"èµ„æºä¸å­˜åœ¨\")\n```\n\n## ğŸ“Š å“åº”æ ¼å¼\n\næ‰€æœ‰ API å“åº”éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š\n\n```json\n{\n  \"success\": true,\n  \"message\": \"æ“ä½œæˆåŠŸ\",\n  \"code\": 200,\n  \"data\": {},\n  \"timestamp\": 1640995200\n}\n```\n\nåˆ†é¡µå“åº”æ ¼å¼ï¼š\n\n```json\n{\n  \"success\": true,\n  \"message\": \"æ“ä½œæˆåŠŸ\",\n  \"code\": 200,\n  \"data\": [],\n  \"page_info\": {\n    \"page\": 1,\n    \"page_size\": 20,\n    \"total\": 100,\n    \"total_pages\": 5,\n    \"has_next\": true,\n    \"has_prev\": false\n  },\n  \"timestamp\": 1640995200\n}\n```\n\n## ğŸ§ª æµ‹è¯•\n\n```bash\n# å®‰è£…æµ‹è¯•ä¾èµ–\npip install pytest pytest-asyncio httpx\n\n# è¿è¡Œæµ‹è¯•\npytest tests/\n\n# è¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹è¦†ç›–ç‡\npytest tests/ --cov=app\n```\n\n## ğŸ“‹ å¼€å‘è§„èŒƒ\n\n### ä»£ç ç»„ç»‡\n\n1. **æ¨¡å‹å±‚** - åªå®šä¹‰æ•°æ®ç»“æ„ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘\n2. **ä»“å‚¨å±‚** - åªå¤„ç†æ•°æ®è®¿é—®ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘\n3. **æœåŠ¡å±‚** - åŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘\n4. **API å±‚** - åªå¤„ç†è¯·æ±‚å“åº”ï¼Œè°ƒç”¨æœåŠ¡å±‚\n\n### å‘½åè§„èŒƒ\n\n- æ–‡ä»¶åï¼šå°å†™ä¸‹åˆ’çº¿å‘½å `user_service.py`\n- ç±»åï¼šå¤§é©¼å³°å‘½å `UserService`\n- å‡½æ•°åï¼šå°å†™ä¸‹åˆ’çº¿å‘½å `get_user_by_id`\n- å¸¸é‡ï¼šå¤§å†™ä¸‹åˆ’çº¿å‘½å `DEFAULT_PAGE_SIZE`\n\n### é”™è¯¯å¤„ç†\n\n- ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»\n- è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—\n- è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯\n- ä¸åœ¨ç”Ÿäº§ç¯å¢ƒæš´éœ²ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯\n\n## ğŸš€ éƒ¨ç½²\n\n### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²\n\n```bash\n# ä½¿ç”¨ gunicorn\ngunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker\n\n# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬\npython run.py --env production --workers 4\n```\n\n### ç¯å¢ƒå˜é‡\n\nç”Ÿäº§ç¯å¢ƒè¯·ç¡®ä¿è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š\n\n- `ENVIRONMENT=production`\n- `SECRET_KEY=å¼ºå¯†é’¥`\n- `DATABASE_URL=ç”Ÿäº§æ•°æ®åº“URL`\n- `REDIS_URL=ç”Ÿäº§Redis URL`\n\n## ğŸ¤ è´¡çŒ®\n\næ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚\n\n## ğŸ“„ è®¸å¯è¯\n\n[MIT License](LICENSE)\n\n---\n\n**FastAPI Scaffold** - è®©åç«¯å¼€å‘æ›´ç®€å•é«˜æ•ˆï¼