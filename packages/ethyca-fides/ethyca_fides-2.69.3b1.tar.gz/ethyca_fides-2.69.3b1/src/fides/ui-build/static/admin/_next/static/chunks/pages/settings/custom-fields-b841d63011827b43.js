(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4065],{70378:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields",function(){return t(78422)}])},56358:function(e,l,t){"use strict";t.d(l,{q:function(){return s}});var i=t(24246);let s=(0,t(96306).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,i.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},95492:function(e,l,t){"use strict";t.d(l,{l:function(){return s}});var i=t(24246);let s=(0,t(96306).IUT)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,i.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},77213:function(e,l,t){"use strict";t.d(l,{Z:function(){return p}});var i=t(24246),s=t(96306),a=t(88038),n=t.n(a),o=t(86677);t(27378);var r=t(25980),d=t(90867),c=t(77830),u=()=>{let e=(0,o.useRouter)();return(0,i.jsx)(s.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(s.xuv,{children:[(0,i.jsxs)(s.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(s.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(s.wpx,{onClick:()=>{e.push(c.fz)},children:"Configure"})]}),(0,i.jsxs)(s.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},p=e=>{let{children:l,title:t,padded:a=!0,mainProps:c}=e,p=(0,r.hz)(),x=(0,o.useRouter)(),m="/privacy-requests"===x.pathname||"/datastore-connection"===x.pathname,h=!(p.flags.privacyRequestsConfiguration&&m),{data:f}=(0,d.JE)(void 0,{skip:h}),{data:v}=(0,d.PW)(void 0,{skip:h}),C=p.flags.privacyRequestsConfiguration&&(!f||!v)&&m;return(0,i.jsxs)(s.kCb,{"data-testid":t,direction:"column",h:"100vh",children:[(0,i.jsxs)(n(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",t]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(s.kCb,{as:"main",direction:"column",py:a?6:0,px:a?10:0,h:a?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...c,children:[C?(0,i.jsx)(u,{}):null,l]})]})}},19904:function(e,l,t){"use strict";t.d(l,{Tg:function(){return n}});var i=t(24246),s=t(16134),a=t(31793);let n=e=>(0,s.C)(a.uu).filter(l=>e.includes(l)).length>0;l.ZP=e=>{let{scopes:l,children:t}=e;return n(l)?(0,i.jsx)(i.Fragment,{children:t}):null}},94799:function(e,l,t){"use strict";t.d(l,{k:function(){return a}});var i=t(76649);let s=e=>(0,i.Ln)({id:"string"},e),a=e=>(null!=e?e:[]).filter(s)},30320:function(e,l,t){"use strict";t.d(l,{m:function(){return r}});var i=t(27378),s=t(25980),a=t(41841),n=t(32885),o=t(94799);let r=e=>{let{resourceFidesKey:l,resourceType:t}=e,{errorAlert:r}=(0,a.VY)(),{plus:d}=(0,s.hz)(),c=(0,i.useMemo)(()=>null!=l?l:"",[]),u=(0,n.YU)(!0,{skip:!d}),p=(0,n.VN)(t,{skip:!d}),{data:x,isLoading:m,error:h,isError:f}=(0,n.PV)(null!=l?l:"",{skip:""!==c&&!(d&&c)}),[v]=(0,n._D)(),C=u.isLoading||p.isLoading||m,_=(0,i.useMemo)(()=>new Map((0,o.k)(u.data).map(e=>{var l;return[e.id,{...e,options:(null!==(l=e.allowed_values)&&void 0!==l?l:[]).map(e=>({value:e,label:e}))}]})),[u.data]),g=(0,i.useMemo)(()=>{var e;return null===(e=p.data)||void 0===e?void 0:e.filter(e=>e.active)},[p.data]),j=(0,i.useMemo)(()=>new Map((0,o.k)(g).map(e=>[e.id,e])),[g]),b=(0,i.useMemo)(()=>f&&(null==h?void 0:h.status)===404?new Map:new Map((0,o.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,f,h]),y=(0,i.useMemo)(()=>{let e=[...j.keys()];return e.sort(),e},[j]),T=(0,i.useMemo)(()=>{let e={};return g&&b&&g.forEach(l=>{let t=b.get(l.id||"");t&&(l.allow_list_id&&"string[]"===l.field_type?e[t.custom_field_definition_id]=t.value:e[t.custom_field_definition_id]=t.value.toString())}),e},[g,b]),w=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:l;if(!i)return;let{customFieldValues:s}=e;if(!s||0===Object.keys(s).length)return;let a=[],n=[];y.forEach(e=>{let l=b.get(e),t=s[e];void 0===t||""===t||Array.isArray(t)&&0===t.length?(null==l?void 0:l.id)&&n.push(l.id):a.push({custom_field_definition_id:e,resource_id:i,id:null==l?void 0:l.id,value:t})});try{await v({resource_type:t,resource_id:i,upsert:a,delete:n})}catch(e){r("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,b,r,l,y,v,t]);return{customFieldValues:T,definitionIdToCustomField:b,idToAllowListWithOptions:_,idToCustomFieldDefinition:j,isEnabled:d,isLoading:C,sortedCustomFieldDefinitionIds:y,upsertCustomFields:w}}},95346:function(e,l,t){"use strict";t.d(l,{uc:function(){return v},Hn:function(){return r},Uv:function(){return n},C7:function(){return d},mZ:function(){return f.m}});var i,s,a,n,o=t(21910);(i=a||(a={}))[i.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",i[i.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",i[i.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY",o.AL.STRING,o.AL.STRING,o.AL.STRING_,(s=n||(n={})).SINGLE_SELECT="singleSelect",s.MULTIPLE_SELECT="multipleSelect",s.LOCATION_SELECT="locationSelect",s.OPEN_TEXT="openText";let r=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Location select",value:"locationSelect"},{label:"Open Text",value:"openText"}],d=[{label:"taxonomy:".concat(o.P6.DATA_CATEGORY),value:o.P6.DATA_CATEGORY},{label:"taxonomy:".concat(o.P6.DATA_SUBJECT),value:o.P6.DATA_SUBJECT},{label:"taxonomy:".concat(o.P6.DATA_USE),value:o.P6.DATA_USE},{label:"".concat(o.P6.SYSTEM,":information"),value:o.P6.SYSTEM},{label:"system:data use",value:o.P6.PRIVACY_DECLARATION}];var c=t(24246),u=t(96306),p=t(34090),x=t(30234),m=t(97181),h=t(40324),f=t(30320);let v=e=>{let{resourceFidesKey:l,resourceType:t}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:s,isEnabled:a,isLoading:n,sortedCustomFieldDefinitionIds:r}=(0,f.m)({resourceFidesKey:l,resourceType:t});return a&&0!==r.length?(0,c.jsx)(x.Z,{heading:"Custom fields",children:(0,c.jsx)(u.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,c.jsx)(u.kCb,{flexDir:"column",gap:"24px",children:n?(0,c.jsx)(u.M5Y,{children:(0,c.jsx)(u.$jN,{})}):r.length>0&&(0,c.jsx)(u.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:r.map(e=>{let l=s.get(e);if(!l)return null;let t="customFieldValues.".concat(l.id);if(!l.allow_list_id&&l.field_type===o.AL.STRING)return(0,c.jsx)(p.gN,{name:t,children:e=>{let{field:t}=e;return(0,c.jsx)(h.j0,{...t,label:l.name,tooltip:l.description,variant:"stacked"})}},e);let a=i.get(l.allow_list_id);if(!a)return null;let{options:n}=a;return(0,c.jsx)(m.d,{name:t,allowClear:!0,mode:l.field_type!==o.AL.STRING?"multiple":void 0,label:l.name,options:n,tooltip:l.description,layout:"stacked",className:"w-full"},e)})})})})}):null};t(94799)},97181:function(e,l,t){"use strict";t.d(l,{d:function(){return d}});var i=t(24246),s=t(96306),a=t(34090),n=t(27378),o=t(46238),r=t(40324);let d=e=>{let{name:l,label:t,labelProps:d,tooltip:c,isRequired:u,layout:p="inline",helperText:x,...m}=e,[h,f,{setValue:v}]=(0,a.U$)(l),C=!!(f.touched&&f.error),[_,g]=(0,n.useState)("");h.value||"tags"!==m.mode&&"multiple"!==m.mode||(h.value=[]),"tags"===m.mode&&"string"==typeof h.value&&(h.value=[h.value]);let j="tags"===m.mode?(e,l)=>e?e.value!==_||h.value.includes(_)?m.optionRender?m.optionRender(e,l):e.label:'Create "'.concat(_,'"'):void 0:m.optionRender||void 0,b=e=>{g(e),m.onSearch&&m.onSearch(e)},y=(e,l)=>{v(e),m.onChange&&m.onChange(e,l)};return"inline"===p?(0,i.jsx)(s.NIc,{isInvalid:C,isRequired:u,children:(0,i.jsxs)(s.rjZ,{templateColumns:t?"1fr 3fr":"1fr",children:[t?(0,i.jsx)(r.__,{htmlFor:m.id||l,...d,children:t}):null,(0,i.jsxs)(s.jqI,{align:"center",children:[(0,i.jsxs)(s.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(s.WPr,{...h,id:m.id||l,"data-testid":"controlled-select-".concat(h.name),...m,optionRender:j,onSearch:"tags"===m.mode?b:void 0,onChange:y,value:h.value||void 0,status:C?"error":void 0}),x&&(0,i.jsx)(s.Q6r,{children:x}),(0,i.jsx)(r.Bc,{isInvalid:C,message:f.error,fieldName:h.name})]}),(0,i.jsx)(o.b,{label:c,className:C?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(s.NIc,{isInvalid:C,isRequired:u,children:(0,i.jsxs)(s.gCW,{alignItems:"start",children:[(0,i.jsxs)(s.jqI,{align:"center",children:[t?(0,i.jsx)(r.__,{htmlFor:m.id||l,fontSize:"xs",my:0,mr:1,...d,children:t}):null,(0,i.jsx)(o.b,{label:c})]}),(0,i.jsx)(s.WPr,{...h,id:m.id||l,"data-testid":"controlled-select-".concat(h.name),...m,optionRender:j,onSearch:"tags"===m.mode?b:void 0,onChange:y,value:h.value||void 0,status:C?"error":void 0}),x&&(0,i.jsx)(s.Q6r,{style:{marginTop:0},children:x}),(0,i.jsx)(r.Bc,{isInvalid:C,message:f.error,fieldName:h.name})]})})}},10342:function(e,l,t){"use strict";var i=t(24246),s=t(96306),a=t(46238);l.Z=e=>{let{title:l,tooltip:t,children:n,...o}=e;return(0,i.jsxs)(s.xuv,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",...o,children:[(0,i.jsxs)(s.X6q,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[l,t?(0,i.jsx)(s.xvT,{as:"span",mx:1,children:(0,i.jsx)(a.b,{label:t})}):void 0]}),(0,i.jsx)(s.Kqy,{p:6,spacing:6,children:n})]})}},30234:function(e,l,t){"use strict";var i=t(24246),s=t(96306);l.Z=e=>{let{heading:l,HeadingButton:t,children:a}=e;return(0,i.jsx)(s.Kqy,{spacing:4,children:(0,i.jsxs)(s.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(s.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(s.X6q,{as:"h3",size:"xs",children:l}),t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.LZC,{}),(0,i.jsx)(t,{})]}):null]}),(0,i.jsx)(s.Kqy,{spacing:4,px:6,py:6,children:a})]})})}},78422:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return X}});var i=t(24246),s=t(77213),a=t(96306),n=t(27378),o=t(58754),r=t(92222),d=t(59003),c=t(16134),u=t(812),p=t(19904),x=t(47935),m=t(46628),h=t(72625),f=t(21910);let v=new Map([["string","Single Select"],["string[]","Multi Select"],["open-text","Open Text"]]),C=new Map([[f.P6.SYSTEM,"system:information"],[f.P6.DATA_USE,"taxonomy:data use"],[f.P6.DATA_CATEGORY,"taxonomy:data category"],[f.P6.DATA_SUBJECT,"taxonomy:data subject"],[f.P6.PRIVACY_DECLARATION,"system:data use"]]);var _=t(32885);let g=e=>{var l;let t=null!==(l=C.get(e.getValue()))&&void 0!==l?l:e.getValue();return(0,i.jsx)(h.G3,{...e,value:t})},j=e=>{let{row:l,getValue:t}=e,s=l.original.allow_list_id?t():"open-text",a=v.get(s)||s;return(0,i.jsx)(h.A4,{value:a})},b=e=>{let{row:l,getValue:t,isDisabled:s}=e,a=!!t(),[n]=(0,_.yM)(),o=async e=>n({...l.original,active:e});return(0,i.jsx)(h.S1,{enabled:a,onToggle:o,title:"Disable custom field",message:"Are you sure you want to disable this custom field?",isDisabled:s,"aria-label":a?"Disable custom field":"Enable custom field"})};var y=t(56358),T=t(58452);let w=e=>{let{customField:l,onEdit:t,onDelete:s,...n}=e,o=(0,a.qY0)();return(0,i.jsxs)(a.xuv,{...n,children:[(0,i.jsx)(a.wpx,{"aria-label":"Edit property","data-testid":"edit-property-button",size:"small",className:"mr-[10px]",icon:(0,i.jsx)(a.dY8,{}),onClick:e=>{e.stopPropagation(),t(l,e)}}),(0,i.jsx)(a.wpx,{"aria-label":"Delete property","data-testid":"delete-property-button",size:"small",className:"mr-[10px]",icon:(0,i.jsx)(y.q,{}),onClick:e=>{e.stopPropagation(),o.onOpen()}}),(0,i.jsx)(T.Z,{isOpen:o.isOpen,onClose:o.onClose,onConfirm:()=>{s(l),o.onClose()},title:"Delete custom field",message:(0,i.jsx)(a.xvT,{color:"gray.500",children:"Are you sure you want to delete this custom field? This will remove the custom field and all stored values and this action can't be undone."}),continueButtonText:"Confirm",isCentered:!0,icon:(0,i.jsx)(a.aNP,{})})]})};var E=t(34090),S=t(55484),L=t(95346),I=t(41841);let R={color:"gray.600",fontSize:"14px",fontWeight:"semibold",minWidth:"150px"};var A=e=>{let{customLabelProps:l,disabled:t=!1,isRequired:s=!1,label:n,type:o="text",placeholder:r,...d}=e,[c,u]=(0,E.U$)(d),{id:p,name:x,autoFocus:m}=d,h="custom-input-".concat(c.name);return(0,i.jsxs)(a.NIc,{display:"flex",isRequired:s,isInvalid:!!(u.error&&u.touched),children:[n&&(0,i.jsx)(a.lXp,{htmlFor:p||x,...l||R,children:n}),(0,i.jsxs)(a.gCW,{align:"flex-start",w:"inherit",children:["number"===o&&(0,i.jsxs)(a.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,i.jsx)(a.zuI,{...c,autoComplete:"off",autoFocus:m,"data-testid":h}),(0,i.jsxs)(a.FiK,{children:[(0,i.jsx)(a.WQu,{}),(0,i.jsx)(a.Y_d,{})]})]}),"text"===o&&(0,i.jsx)(a.IIB,{...c,autoComplete:"off",autoFocus:m,color:"gray.700",isDisabled:t,placeholder:r,size:"sm","data-testid":h}),"textarea"===o&&(0,i.jsx)(a.gxH,{...c,autoComplete:"off",autoFocus:m,color:"gray.700",placeholder:r,resize:"none",size:"sm",value:c.value||"","data-testid":h}),(0,i.jsx)(a.J1D,{children:u.error})]})]})};let N=(0,a.IUT)({displayName:"AddIcon",viewBox:"0 0 10 10",path:(0,i.jsx)("path",{d:"M4.33331 4.33398V0.333984H5.66665V4.33398H9.66665V5.66732H5.66665V9.66732H4.33331V5.66732H0.333313V4.33398H4.33331Z",fill:"currentColor"})});var M=t(10342),O=t(95492),P=t(97181);let k={...R,minWidth:"unset"},U=e=>{let{values:l,validationSchema:t,errors:s,dirty:o,isValid:r,isSubmitting:d,isLoading:c,onClose:u,handleDropdownChange:p,isEditing:x}=e,{validateForm:m}=(0,E.u6)();return(0,n.useEffect)(()=>{m()},[t,m]),(0,i.jsxs)(E.l0,{style:{paddingTop:"12px",paddingBottom:"12px"},children:[(0,i.jsx)(a.xuv,{py:3,children:(0,i.jsxs)(M.Z,{title:"Field Information",children:[(0,i.jsx)(A,{isRequired:!0,label:"Name",name:"name",customLabelProps:k}),(0,i.jsx)(A,{label:"Description",name:"description",customLabelProps:k}),(0,i.jsx)(P.d,{label:"Location",name:"resource_type",options:L.C7,labelProps:k,disabled:x})]})}),(0,i.jsx)(a.xuv,{py:3,children:(0,i.jsxs)(M.Z,{title:"Configuration",children:[(0,i.jsx)(P.d,{label:"Field Type",name:"field_type",labelProps:k,options:L.Hn,onChange:p}),l.field_type!==L.Uv.OPEN_TEXT&&l.field_type!==L.Uv.LOCATION_SELECT?(0,i.jsx)(a.kCb,{flexDirection:"column",gap:"12px",paddingTop:"6px",paddingBottom:"24px",children:(0,i.jsx)(E.F2,{name:"allow_list.allowed_values",render:e=>{let{allowed_values:t}=l.allow_list;return(0,i.jsxs)(a.kCb,{flexDirection:"column",gap:"6",pl:"6",children:[(0,i.jsx)(a.kCb,{flexDirection:"column",children:t.map((l,s)=>(0,i.jsxs)(a.kCb,{flexGrow:1,gap:"3",mt:s>0?3:void 0,children:[(0,i.jsx)(A,{customLabelProps:{color:"gray.600",fontSize:"sm",fontWeight:"500",lineHeight:"20px",minW:"126px",pr:"8px"},isRequired:!0,label:"List item ".concat(s+1),name:"allow_list.allowed_values[".concat(s,"]")}),(0,i.jsx)(a.wpx,{"aria-label":"Remove this list value","data-testid":"remove-list-value-btn-".concat(s),icon:(0,i.jsx)(O.l,{}),disabled:t.length<=1,onClick:()=>e.remove(s),type:"text"})]},s))}),(0,i.jsxs)(a.kCb,{alignItems:"center",children:[(0,i.jsx)(a.xvT,{color:"gray.600",fontSize:"xs",fontWeight:"500",lineHeight:"16px",pr:"8px",children:"Add a list value"}),(0,i.jsx)(a.wpx,{"aria-label":"Add a list value","data-testid":"add-list-value-btn",icon:(0,i.jsx)(N,{h:"7px",w:"7px"}),onClick:()=>{e.push("")},size:"small"}),0===t.length&&(null==s?void 0:s.allow_list)?(0,i.jsx)(a.xvT,{color:"red.500",pl:"18px",size:"sm",children:s.allow_list.allowed_values}):null]})]})}})}):null]})}),(0,i.jsxs)(a.kCb,{justifyContent:"space-between",width:"100%",children:[(0,i.jsx)(a.wpx,{onClick:u,disabled:c||d,className:"mr-3","data-testid":"cancel-btn",children:"Cancel"}),(0,i.jsx)(a.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",loading:c,disabled:!o||!r||d,children:"Save"})]})]})},D={description:"",field_type:L.Uv.OPEN_TEXT,name:"",resource_type:f.P6.SYSTEM,allow_list:{name:"",description:"",allowed_values:[]}},H=S.IX(S.Z_().optional().label("allowed_values")),V=S.IX(S.Z_().required("List item is required")).min(1,"Must add at least one list value").label("allowed_values"),F=S.Ry().shape({name:S.Z_().required("Name is required").trim(),allow_list:S.Ry().shape({allowed_values:H})}),Z=S.Ry().shape({name:S.Z_().required("Name is required").trim(),allow_list:S.Ry().shape({allowed_values:V})}),z=(e,l)=>{var t,i,s;let a;if(!e)return;e.field_type!==f.AL.STRING||e.allow_list_id||(a=L.Uv.OPEN_TEXT),e.field_type===f.AL.STRING&&e.allow_list_id&&(a=L.Uv.SINGLE_SELECT),e.field_type===f.AL.STRING_&&e.allow_list_id&&(a=L.Uv.MULTIPLE_SELECT);let n=l?{name:null!==(t=l.name)&&void 0!==t?t:"",description:null!==(i=l.description)&&void 0!==i?i:"",allowed_values:null!==(s=l.allowed_values)&&void 0!==s?s:[]}:D.allow_list;return{...e,field_type:a||L.Uv.OPEN_TEXT,allow_list:n}},q=e=>{let{isOpen:l,onClose:t,isLoading:s,customField:o}=e,{errorAlert:r,successAlert:d}=(0,I.VY)(),[c]=(0,_.Ld)(),[p]=(0,_.yM)(),[x]=(0,_.Nt)(),{data:m,isLoading:h}=(0,_.vA)(null==o?void 0:o.allow_list_id,{skip:!(null==o?void 0:o.allow_list_id)}),[v,C]=(0,n.useState)(F);if(h||!l)return null;let g=z(o,m),j=!!g,b=e=>{e===L.Uv.OPEN_TEXT||e===L.Uv.LOCATION_SELECT?C(F):C(Z)},y=async e=>{if([L.Uv.SINGLE_SELECT,L.Uv.MULTIPLE_SELECT].includes(e.field_type)){var l,i;if(new Set(null===(l=e.allow_list)||void 0===l?void 0:l.allowed_values.map(e=>e.toLowerCase().trim()).map(e=>e)).size<e.allow_list.allowed_values.length){r("List item value must be unique");return}let{allow_list:t}=e;e.allow_list_id&&(t.id=e.allow_list_id),t.name||(t.name=Date.now().toString()+Math.random().toString());let s=await x(t);(0,u.D4)(s)||e.allow_list_id||(e.allow_list_id=null===(i=s.data)||void 0===i?void 0:i.id)}(e.field_type===L.Uv.OPEN_TEXT||e.field_type===L.Uv.LOCATION_SELECT)&&(e.allow_list_id=void 0),[L.Uv.SINGLE_SELECT,L.Uv.OPEN_TEXT,L.Uv.LOCATION_SELECT].includes(e.field_type)&&(e.field_type=f.AL.STRING),e.field_type===L.Uv.MULTIPLE_SELECT&&(e.field_type=f.AL.STRING_);let s={...e};delete s.allow_list;let a=o?await p(s):await c(s);(0,u.D4)(a)?r((0,u.e$)(a.error),"Custom field has failed to save due to the following:"):(t(),d("Custom field successfully saved"))};return(0,i.jsxs)(a.u_l,{id:"custom-field-modal-hello-world",isOpen:l,onClose:t,size:"lg",returnFocusOnClose:!1,isCentered:!0,children:[(0,i.jsx)(a.ZAr,{}),(0,i.jsxs)(a.hzk,{id:"modal-content","data-testid":"custom-field-modal",maxHeight:"80%",overflowY:"auto",children:[(0,i.jsx)(a.xBx,{id:"modal-header",fontWeight:"semibold",lineHeight:5,fontSize:"sm",py:"18px",px:6,height:"56px",backgroundColor:"gray.50",borderColor:"gray.200",borderWidth:"0px 0px 1px 1p",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",boxSizing:"border-box",children:o?"Manage Custom Field":"Add a custom field"}),(0,i.jsx)(a.fef,{px:6,py:0,children:(0,i.jsx)(E.J9,{initialValues:g||D,validationSchema:v,onSubmit:y,enableReinitialize:!0,validateOnChange:!0,children:e=>(0,i.jsx)(U,{isEditing:j,validationSchema:v,isLoading:s,onClose:t,handleDropdownChange:b,...e})})})]})]})},W="Add a custom field",G=()=>(0,i.jsx)(a.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",textAlign:"center",children:(0,i.jsxs)(a.gCW,{children:[(0,i.jsx)(a.xvT,{fontSize:"md",fontWeight:"600",children:"It looks like it’s your first time here!"}),(0,i.jsxs)(a.xvT,{fontSize:"sm",children:["You haven’t created any custom fields yet.",(0,i.jsx)("br",{}),"To create a custom field, click on the"," ",(0,i.jsxs)("strong",{children:['"',W,'"']})," button"]})]})}),Y=(0,r.Cl)(),B=e=>{let{...l}=e,t=(0,a.pmc)(),{isLoading:s}=(0,_.GH)(),o=(0,c.C)(_.fN),[h]=(0,_.UF)(),{isOpen:v,onClose:C,onOpen:y}=(0,a.qY0)(),[T,E]=(0,n.useState)(),[S,L]=(0,n.useState)(),I=(0,p.Tg)([f.Sh.CUSTOM_FIELD_UPDATE]),R=(0,p.Tg)([f.Sh.CUSTOM_FIELD_DELETE]),A=e=>{I&&(E(e),y())},N=async e=>{if(R&&e.id){let l=await h({id:e.id});if((0,u.D4)(l)){t((0,m.Vo)((0,u.e$)(l.error)));return}t((0,m.t5)("Custom field deleted"))}},M=(0,n.useMemo)(()=>[Y.accessor(e=>e.name,{id:"name",cell:e=>(0,i.jsx)(x.G3,{value:e.getValue(),cellProps:e}),header:e=>(0,i.jsx)(x.Rr,{value:"Label",...e})}),Y.accessor(e=>e.description,{id:"description",cell:e=>(0,i.jsx)(x.G3,{value:e.getValue(),cellProps:e}),header:e=>(0,i.jsx)(x.Rr,{value:"Description",...e}),meta:{showHeaderMenu:!0}}),Y.accessor(e=>e.field_type,{id:"field_type",cell:j,header:e=>(0,i.jsx)(x.Rr,{value:"Field Type",...e})}),Y.accessor(e=>e.resource_type,{id:"resource_type",cell:g,header:e=>(0,i.jsx)(x.Rr,{value:"Locations",...e})}),I&&Y.accessor(e=>e.active,{id:"enable",cell:b,header:e=>(0,i.jsx)(x.Rr,{value:"Enable",...e}),meta:{disableRowClick:!0}}),(I||R)&&Y.display({id:"actions",header:"Actions",cell:e=>{let{row:l}=e;return(0,i.jsx)(w,{customField:l.original,onEdit:A,onDelete:N})},meta:{disableRowClick:!0}})].filter(Boolean),[R,I]),O=(0,d.b7)({getCoreRowModel:(0,r.sC)(),getFilteredRowModel:(0,r.vL)(),getSortedRowModel:(0,r.tj)(),onGlobalFilterChange:L,globalFilterFn:"includesString",columns:M,data:o,state:{globalFilter:S},columnResizeMode:"onChange"});return(0,i.jsxs)(a.xuv,{...l,children:[(0,i.jsx)(a.xuv,{maxWidth:600,children:(0,i.jsx)(a.xvT,{mb:10,fontSize:"sm",children:o.length>0?"Custom fields enable you to capture metrics specific to your organization and have those metrics appear in the data map and in reports.":"Custom fields provide organizations with the capability to capture metrics that are unique to their specific needs, allowing them to create customized reports. These fields can be added to either systems or elements within a taxonomy, and once added, they become reportable fields that are visible on the data map."})}),(0,i.jsxs)(a.xuv,{"data-testid":"custom-fields-page",children:[(0,i.jsxs)(x.Q$,{children:[(0,i.jsx)(x.HO,{globalFilter:S,setGlobalFilter:L,placeholder:"Search for a custom field"}),(0,i.jsx)(a.Ugi,{alignItems:"center",spacing:4,children:(0,i.jsx)(()=>(0,i.jsx)(p.ZP,{scopes:[f.Sh.CUSTOM_FIELD_DEFINITION_CREATE],children:(0,i.jsx)(a.wpx,{type:"primary","data-testid":"add-custom-field-btn",onClick:y,children:W})}),{})})]}),s?(0,i.jsx)(a.xuv,{p:2,borderWidth:1,children:(0,i.jsx)(x.I4,{rowHeight:26,numRows:10})}):(0,i.jsx)(x.ZK,{tableInstance:O,onRowClick:I?A:void 0,emptyTableNotice:(0,i.jsx)(G,{}),enableSorting:!0}),v&&(0,i.jsx)(q,{customField:T,isOpen:v,onClose:()=>{E(void 0),C()},isLoading:!1})]})]})};var X=()=>(0,i.jsx)(s.Z,{title:"Custom fields",children:(0,i.jsxs)(a.xuv,{"data-testid":"custom-fields-management",children:[(0,i.jsx)(o.Z,{heading:"Custom fields"}),(0,i.jsx)(B,{})]})})}},function(e){e.O(0,[431,4164,2888,9774,179],function(){return e(e.s=70378)}),_N_E=e.O()}]);