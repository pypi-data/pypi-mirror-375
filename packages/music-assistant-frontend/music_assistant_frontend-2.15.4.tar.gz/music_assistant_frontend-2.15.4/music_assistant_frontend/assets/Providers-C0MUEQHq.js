import{B as y}from"./Button-kSJGA_Pw.js";import{C as R}from"./Container-Br6JH6Pm.js";import{L as Y}from"./ListItem-LV_WU--g.js";import{U as S,x as D,c as F,a6 as a,aY as O,b as X,w as z,a0 as P,X as r,a1 as M,a2 as s,cb as f,I as V,F as d,W as u,ab as g,Y as i,a9 as G,Z as j,ac as h,G as H,as as _,ad as m,aa as c,at as T,E as b,ar as k,bH as W,cc as Z,a8 as q,a5 as J}from"./index-B-lUZalq.js";import{a as K}from"./VBtn-BPJ1JKW-.js";import{V as Q}from"./VToolbar-RljK0PC9.js";import{V as I}from"./VAlert-QHTIcuEJ.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-DB65WVbe.js";/* empty css              */const te={class:"line-clamp-1"},ne={class:"line-clamp-1"},ae=S({__name:"Providers",setup(ie){const v=W(),p=D([]),x=F(()=>Object.values(a.providerManifests).filter(t=>t.multi_instance||!p.value.find(n=>n.domain==t.domain)).sort((t,n)=>(t.name||a.providerManifests[t.domain].name).toUpperCase()>(n.name||a.providerManifests[n.domain].name).toUpperCase()?1:-1)),E=a.subscribe(O.PROVIDERS_UPDATED,()=>{A()});X(E);const A=async function(){p.value=await a.getProviderConfigs()},w=function(t){a.removeProviderConfig(t),p.value=p.value.filter(n=>n.instance_id!=t)},$=function(t){v.push(`/settings/editprovider/${t}`)},B=function(t){if(t.depends_on&&!a.getProvider(t.depends_on)){const n=a.getProviderName(t.depends_on);confirm(c("settings.provider_depends_on_confirm",[t.name,n]))&&v.push(`/settings/addprovider/${t.depends_on}`);return}v.push(`/settings/addprovider/${t.domain}`)},N=function(t){t.enabled=!t.enabled,a.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},U=function(t){a.sendCommand("config/providers/reload",{instance_id:t}).catch(n=>alert(n))},L=function(t,n){const o=a.providerManifests[n.domain],e=a.getProvider(n.instance_id),l=[{label:"settings.configure",labelArgs:[],action:()=>{$(n.instance_id)},icon:"mdi-cog"},{label:n.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{N(n)},icon:"mdi-cancel",disabled:!o.allow_disable},{label:"settings.documentation",labelArgs:[],action:()=>{Z(o.documentation)},icon:"mdi-bookshelf",disabled:!o.documentation},{label:"settings.sync",labelArgs:[],action:()=>{a.startSync(void 0,[n.instance_id])},icon:"mdi-sync",hide:!e?.available||n.type!=f.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{w(n.instance_id)},icon:"mdi-delete",hide:o.builtin},{label:"settings.reload",labelArgs:[],action:()=>{U(n.instance_id)},icon:"mdi-refresh"}];e?.available&&e.supported_features.includes(q.CREATE_GROUP_PLAYER)&&l.push({label:"settings.add_group_player",labelArgs:[],action:()=>{v.push(`/settings/addgroup/${e.lookup_key}`)},icon:"mdi-speaker-multiple"}),J.emit("contextmenu",{items:l,posX:t.clientX,posY:t.clientY})};z(()=>a.providers,t=>{t&&A()},{immediate:!0});const C=function(t){const n=a.providerManifests[t.domain].name;if(t.name)return`${n} [${t.name}]`;const o=a.getProvider(t.instance_id);return o&&o.instance_name_postfix?`${n} [${o.instance_name_postfix}]`:n};return(t,n)=>(r(!0),P(V,null,M(s(f),o=>(r(),P("div",{key:o,style:{"margin-bottom":"10px"}},[d(Q,{color:"transparent",density:"compact",class:"titlebar"},{title:i(()=>[_(m(s(c)(`settings.${o}providers`)),1)]),append:i(()=>[x.value.filter(e=>e.type==o).length?(r(),u(T,{key:0,scrim:""},{activator:i(({props:e})=>[d(K,H({ref_for:!0},e,{color:"accent",variant:"outlined"}),{default:i(()=>[_(m(s(c)("settings.add_new_provider_button",[o])),1)]),_:2},1040)]),default:i(()=>[d(G,{density:"compact"},{default:i(()=>[(r(!0),P(V,null,M(x.value.filter(e=>e.type==o),e=>(r(),u(j,{key:e.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:l=>B(e)},{prepend:i(()=>[d(h,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):g("",!0)]),_:2},1024),o==s(f).MUSIC&&p.value.filter(e=>e.type==s(f).MUSIC&&e.domain in s(a).providerManifests&&e.domain!=="builtin").length==0?(r(),u(I,{key:0,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:i(()=>[b("b",null,m(s(c)("settings.no_music_providers_detail")),1),n[0]||(n[0]=b("br",null,null,-1)),_(" "+m(s(c)("settings.no_music_providers_detail")),1)]),_:1})):g("",!0),o==s(f).PLAYER&&p.value.filter(e=>e.type==s(f).PLAYER&&e.domain in s(a).providerManifests).length==0?(r(),u(I,{key:1,border:"top","border-color":"warning",style:{margin:"20px"},icon:"mdi-alert-box-outline"},{default:i(()=>[b("b",null,m(s(c)("settings.no_player_providers_detail")),1),n[1]||(n[1]=b("br",null,null,-1)),_(" "+m(s(c)("settings.no_player_providers_detail")),1)]),_:1})):g("",!0),d(R,null,{default:i(()=>[(r(!0),P(V,null,M(p.value.filter(e=>e.type==o).sort((e,l)=>C(e).localeCompare(C(l))),e=>(r(),u(Y,{key:e.instance_id,"show-menu-btn":"",link:"",onMenu:l=>L(l,e),onClick:l=>$(e.instance_id)},{prepend:i(()=>[d(h,{domain:e.domain,size:50,class:"listitem-media-thumb",style:{"margin-top":"5px","margin-bottom":"5px"}},null,8,["domain"])]),title:i(()=>[b("div",te,m(C(e)),1)]),subtitle:i(()=>[b("div",ne,m(s(a).providerManifests[e.domain].description),1)]),append:i(()=>[s(a).syncTasks.value.filter(l=>l.provider_instance==e.instance_id).length>0?(r(),u(y,{key:0,icon:"",title:s(c)("settings.sync_running")},{default:i(()=>[d(k,{color:"grey"},{default:i(()=>[...n[2]||(n[2]=[_(" mdi-sync ",-1)])]),_:1})]),_:1},8,["title"])):g("",!0),e.enabled?e.last_error?(r(),u(y,{key:2,icon:"",title:e.last_error},{default:i(()=>[d(k,{color:"red"},{default:i(()=>[...n[4]||(n[4]=[_(" mdi-alert-circle ",-1)])]),_:1})]),_:1},8,["title"])):s(a).providers[e.instance_id]?.available?g("",!0):(r(),u(y,{key:3,icon:"",title:s(c)("settings.not_loaded")},{default:i(()=>[d(k,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(r(),u(y,{key:1,icon:"",title:s(c)("settings.provider_disabled")},{default:i(()=>[d(k,{color:"grey"},{default:i(()=>[...n[3]||(n[3]=[_(" mdi-cancel ",-1)])]),_:1})]),_:1},8,["title"]))]),_:2},1032,["onMenu","onClick"]))),128))]),_:2},1024)]))),128))}}),fe=ee(ae,[["__scopeId","data-v-13c9ce97"]]);export{fe as default};
