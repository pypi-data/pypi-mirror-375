"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[9015],{20967:(e,t,n)=>{var a=n(25584);window.initMenuSortable=function(){let e=null,t=!1;function n(t,n){if(e[0]===n.placeholder.parent()[0])return!0;if(!n.item.hasClass("nestable"))return!1;const a=n.placeholder.closest(".menu-entry").parent();return void 0===a[0]||a.hasClass("allow-nested")}$(".menu-entries.ui-sortable").sortable("destroy"),$(".menu-entries").sortable({handle:".drag-handle",placeholder:"menu-entry-placeholder",axis:"y",connectWith:".connect-menu",start(t,n){e=$(this),n.item.hasClass("nestable")&&(1===e.children().not(".menu-entry-placeholder").length&&e.addClass("empty"),$(".menu-entries > .allow-nested > .menu-entry > .menu-entries.empty").addClass("expand").parent(".menu-entry").addClass("with-children"),n.item.find("> .menu-entry > .menu-entries.empty").removeClass("expand").parent(".menu-entry").removeClass("with-children")),n.placeholder.height(n.helper.outerHeight())},beforeStop(e,a){t=!n(0,a)},stop(n,a){if($(".menu-entries").removeClass("hide-placeholder"),a.item.hasClass("nestable")&&$(".menu-entries > .allow-nested > .menu-entry > .menu-entries.empty").removeClass("expand").parent(".menu-entry").removeClass("with-children"),t)$(this).sortable("cancel");else if(a.item.hasClass("nestable")){a.item.closest(".menu-entries").removeClass("empty").parent(".menu-entry").addClass("with-children").parent().removeClass("nestable");const t=void 0===a.item.closest(".menu-entry")[0];t||a.item.removeClass("allow-nested"),t&&a.item.find("> .menu-entry > .menu-entries")&&a.item.addClass("allow-nested"),e.children().length||e.addClass("empty").closest(".menu-entry").parent().addClass("nestable")}e=null},over(e,t){n(0,t)||t.placeholder.closest(".menu-entries").addClass("hide-placeholder")},update(e,n){if(this!==n.item.parent()[0])return;if(t)return;e.stopPropagation();const a={},r=n.item.prev().children(".menu-entry").data("position");null!==r&&(a.position=r);const s=n.item.closest(".menu-entry").data("entry-id");null!==s&&(a.parent_id=s),$.ajax({url:n.item.children(".menu-entry").data("position-url"),method:"POST",dataType:"json",data:a,complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError})}})},$(document).on("click",".menu-entry > .i-label > .actions > .edit-entry",(function(e){e.preventDefault(),e.stopPropagation(),ajaxDialog({trigger:this,url:$(this).data("href"),title:a.$T.gettext("Menu Entry Settings"),onClose(e){e&&$(this.trigger).closest(".menu-entry").replaceWith(e.entry)}})})).on("indico:confirmed",".menu-entry .enabled, .menu-entry .not-enabled",(function(e){e.stopPropagation(),e.preventDefault();const t=$(this);$.ajax({url:t.data("href"),method:t.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(e){const n=e.is_enabled;t.toggleClass("enabled",n).toggleClass("not-enabled",!n).parent(".actions").parent(".i-label").toggleClass("striped",!n)}})})).on("indico:confirmed",".menu-entry .default, .menu-entry .not-default",(function(e){e.stopPropagation(),e.preventDefault();const t=$(this);$.ajax({url:t.data("href"),method:t.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(e){const n=e.is_default;$(".menu-entry .default").removeClass("default").addClass("not-default"),t.toggleClass("default",n).toggleClass("not-default",!n)}})})).on("indico:confirmed",".menu-entry .delete-entry",(function(e){e.preventDefault();const t=$(this);$.ajax({url:t.data("href"),method:t.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(e){e&&($("#menu-entries > .menu-entries").replaceWith(e.menu),initMenuSortable())}})}))}},e=>{e.O(0,[2076],(()=>{return t=20967,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.layout.3ef3affd.bundle.js.map