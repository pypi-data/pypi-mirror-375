"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[743],{71511:(e,a,t)=>{var n=t(29079),l=t(637),r=t.n(l),s=t(97598),i=t.n(s),c=t(86326),m=t(35623),o=t(42430),d=t(6423),u=t(26225),E=t(46145),f=t(96478),y=t(49528),g=t(18606);const p=n.default.bind(null,{endpoint:"users.user_emails",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"emails",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"emails",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),b=n.default.bind(null,{endpoint:"users.user_profile_update",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");function A({userId:e,userValues:a,currentAffiliation:t,titles:n,syncedValues:l,lockedFields:s,lockedFieldMessage:i,hasPredefinedAffiliations:m,allowCustomAffiliations:A}){const D=null!==e?{user_id:e}:{},v=n.map((e=>({key:e.name,value:e.name,text:e.title})));return c.createElement("div",null,c.createElement(o.Form,{onSubmit:async(e,a)=>{const t=(0,E.getChangedValues)(e,a);m?t.affiliation_data&&(t.affiliation=t.affiliation_data.text.trim(),t.affiliation_id=t.affiliation_data.id,delete t.affiliation_data):delete t.affiliation_data;try{await y.indicoAxios.patch(b(D),t)}catch(e){return(0,E.handleSubmitError)(e)}location.reload(),await new Promise((()=>{}))},initialValues:a,initialValuesEqual:r().isEqual,subscription:{}},(e=>c.createElement(d.A,{onSubmit:e.handleSubmit},c.createElement(o.Field,{name:"synced_fields",isEqual:r().isEqual,render:()=>null}),c.createElement(E.FinalDropdown,{name:"title",options:v,selection:!0,parse:E.parsers.nullIfEmpty,label:f.Translate.string("Title","Salutation"),placeholder:f.Translate.string("None","Title (salutation)")}),c.createElement(d.A.Group,{widths:"equal"},c.createElement(u.SyncedFinalInput,{name:"first_name",label:f.Translate.string("First name"),required:!0,syncedValues:l,lockedFields:s,lockedFieldMessage:i,validate:E.validators.maxLength(250)}),c.createElement(u.SyncedFinalInput,{name:"last_name",label:f.Translate.string("Last name"),required:!0,syncedValues:l,lockedFields:s,lockedFieldMessage:i,validate:E.validators.maxLength(250)})),m?c.createElement(u.SyncedFinalAffiliationDropdown,{name:"affiliation_data",syncName:"affiliation",currentAffiliation:t,syncedValues:l,lockedFields:s,lockedFieldMessage:i,allowCustomAffiliations:A}):c.createElement(u.SyncedFinalInput,{name:"affiliation",label:f.Translate.string("Affiliation"),syncedValues:l,lockedFields:s,lockedFieldMessage:i,validate:e=>void 0!==e&&E.validators.maxLength(250)(e)}),c.createElement(u.SyncedFinalTextArea,{name:"address",label:f.Translate.string("Address"),syncedValues:l,lockedFields:s,lockedFieldMessage:i,validate:E.validators.maxLength(500)}),c.createElement(u.SyncedFinalInput,{name:"phone",label:f.Translate.string("Phone number"),syncedValues:l,lockedFields:s,lockedFieldMessage:i,validate:E.validators.maxLength(100)}),c.createElement(u.SyncedFinalInput,{name:"email",label:f.Translate.string("Email address"),syncedValues:l,lockedFields:s,lockedFieldMessage:i,readOnly:!0},c.createElement(f.Translate,null,"You can manage your email addresses"," ",c.createElement(f.Param,{name:"link",wrapper:c.createElement("a",{href:p(D)})},"here"),".")),(0,g.renderPluginComponents)("user-personal-data-form-inputs",{userValues:a,syncedValues:l,lockedFields:s,lockedFieldMessage:i}),c.createElement(E.FinalSubmitButton,{label:f.Translate.string("Save changes"),className:"submit-button"})))))}A.propTypes={userId:i().number,userValues:i().object.isRequired,currentAffiliation:i().object,titles:i().arrayOf(i().shape({name:i().string.isRequired,title:i().string.isRequired})).isRequired,syncedValues:i().objectOf(i().string).isRequired,lockedFields:i().arrayOf(i().string).isRequired,lockedFieldMessage:i().string.isRequired,hasPredefinedAffiliations:i().bool.isRequired,allowCustomAffiliations:i().bool.isRequired},A.defaultProps={userId:null,currentAffiliation:null},window.setupPersonalDataForm=function(e,a,t,n,l,r,s,i,o){document.addEventListener("DOMContentLoaded",(()=>{m.render(c.createElement(A,{userId:e,userValues:a,currentAffiliation:t,titles:n,syncedValues:l,lockedFields:r,lockedFieldMessage:s,hasPredefinedAffiliations:i,allowCustomAffiliations:o}),document.querySelector("#personal-details-form-container"))}))};var D=t(92117),v=t(45423),k=t(47279),h=t(56237),T=t(16520);const _=n.default.bind(null,{endpoint:"users.user_block",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"blocked",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blocked",isDynamic:!1}]}]},"/");function w({firstName:e,lastName:a,isUserBlocked:t,inProgress:n,onBlock:l,onClose:r}){return c.createElement(c.Fragment,null,c.createElement(D.A.Header,null,t?c.createElement(f.Translate,null,"Unblock ",c.createElement(f.Param,{name:"first_name",value:e})," ",c.createElement(f.Param,{name:"last_name",value:a}),"?"):c.createElement(f.Translate,null,"Block ",c.createElement(f.Param,{name:"first_name",value:e})," ",c.createElement(f.Param,{name:"last_name",value:a}),"?")),c.createElement(D.A.Content,null,c.createElement(v.A,{as:"h3",icon:!0,textAlign:"center",style:{marginBottom:0}},t?c.createElement(c.Fragment,null,c.createElement(k.A,{name:"unlock alternate"}),c.createElement(f.Translate,null,"Are you sure you want to unblock ",c.createElement(f.Param,{name:"first_name",value:e}),"?")):c.createElement(c.Fragment,null,c.createElement(k.A,{name:"hand paper outline"}),c.createElement(f.Translate,null,"Are you sure you want to block ",c.createElement(f.Param,{name:"first_name",value:e}),"?")),c.createElement(v.A.Subheader,{style:{marginTop:"0.5em",color:"unset"}},t?c.createElement(f.Translate,null,c.createElement(f.Param,{name:"first_name",wrapper:c.createElement("strong",null),value:e})," ",c.createElement(f.Param,{name:"last_name",wrapper:c.createElement("strong",null),value:a})," will regain access to Indico."):c.createElement(f.Translate,null,c.createElement(f.Param,{name:"first_name",wrapper:c.createElement("strong",null),value:e})," ",c.createElement(f.Param,{name:"last_name",wrapper:c.createElement("strong",null),value:a})," will no longer be able to access Indico.")))),c.createElement(D.A.Actions,null,c.createElement(h.A,{onClick:r,disabled:n},c.createElement(f.Translate,null,"Cancel")),c.createElement(h.A,{negative:!t,primary:t,onClick:l,disabled:n,loading:n},t?c.createElement(f.Translate,null,"Unblock ",c.createElement(f.Param,{name:"first_name",value:e})):c.createElement(f.Translate,null,"Block ",c.createElement(f.Param,{name:"first_name",value:e})))))}function F({userId:e,isUserBlocked:a,firstName:t,lastName:n}){const[l,r]=(0,c.useState)(!1),[s,i]=(0,c.useState)(!1),m=e===Indico.User.id;return c.createElement("div",null,m?c.createElement(T.A,{trigger:c.createElement("span",null,c.createElement(h.A,{size:"small",color:"orange",disabled:!0},c.createElement(f.Translate,null,"Block User"))),size:"small",wide:!0,content:f.Translate.string("You cannot block yourself"),position:"bottom center"}):c.createElement(c.Fragment,null,c.createElement(h.A,{size:"small",color:a?null:"orange",onClick:()=>r(!0)},a?f.Translate.string("Unblock User"):f.Translate.string("Block User")),c.createElement(D.A,{size:"tiny",open:l,onClose:()=>r(!1),closeIcon:!0},c.createElement(w,{firstName:t,lastName:n,isUserBlocked:a,inProgress:s,onBlock:async()=>{i(!0);try{await(0,y.indicoAxios)({url:_({user_id:e}),method:a?"DELETE":"PUT"}),location.reload()}catch(e){(0,y.handleAxiosError)(e),i(!1)}},onClose:()=>r(!1)}))))}w.propTypes={firstName:i().string.isRequired,lastName:i().string.isRequired,isUserBlocked:i().bool.isRequired,inProgress:i().bool.isRequired,onBlock:i().func.isRequired,onClose:i().func.isRequired},F.propTypes={userId:i().number.isRequired,isUserBlocked:i().bool.isRequired,firstName:i().string.isRequired,lastName:i().string.isRequired},customElements.define("ind-user-block-button",class extends HTMLElement{connectedCallback(){m.render(c.createElement(F,{userId:JSON.parse(this.getAttribute("user-id")),isUserBlocked:JSON.parse(this.getAttribute("user-is-blocked")),firstName:this.getAttribute("user-first-name"),lastName:this.getAttribute("user-last-name")}),this)}});var I=t(87597),P=t(53225);const C=n.default.bind(null,{endpoint:"users.user_delete",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"delete",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"delete",isDynamic:!1}]}]},"/"),q=n.default.bind(null,{endpoint:"users.users_admin",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"users",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");function N({firstName:e,lastName:a,disabled:t,inProgress:n,onDelete:l,onClose:r}){const[s,i]=(0,c.useState)(10),[m,o]=(0,c.useState)(!0);return(0,c.useEffect)((()=>{i(10),o(!0);const e=setInterval((()=>{i((a=>a<=1?(clearInterval(e),o(!1),0):a-1))}),1e3);return()=>clearInterval(e)}),[]),c.createElement(c.Fragment,null,c.createElement(D.A.Header,null,c.createElement(f.Translate,null,"Delete ",c.createElement(f.Param,{name:"first_name",value:e})," ",c.createElement(f.Param,{name:"last_name",value:a}),"?")),c.createElement(D.A.Content,null,c.createElement(I.A,{negative:!0,icon:!0},c.createElement(k.A,{name:"warning sign"}),c.createElement(I.A.Content,null,c.createElement(I.A.Header,null,c.createElement(f.Translate,null,"This action is irreversible")),c.createElement(f.Translate,null,"Deleted user accounts cannot be restored."))),c.createElement(f.Translate,{as:"p"},"Once deleted, the following will happen:"),c.createElement(P.A,{style:{marginTop:0}},c.createElement(P.A.Item,null,c.createElement(P.A.Icon,{name:"minus circle"}),c.createElement(P.A.Content,null,c.createElement(f.Translate,null,c.createElement(f.Param,{name:"first_name",value:e})," will no longer be able to access Indico."))),c.createElement(P.A.Item,null,c.createElement(P.A.Icon,{name:"times circle outline"}),c.createElement(P.A.Content,null,c.createElement(f.Translate,null,c.createElement(f.Param,{name:"first_name",value:e})," will be removed from all areas of Indico - this does not affect their presence in events as a speaker or other role; they will still be listed in such capacities where applicable."))),c.createElement(P.A.Item,null,c.createElement(P.A.Icon,{name:"trash alternate outline"}),c.createElement(P.A.Content,null,c.createElement(f.Translate,null,"Where it is not possible to delete ",c.createElement(f.Param,{name:"first_name",value:e}),", they will be anonymized and all personal data associated with the user will be removed from Indico.")))),c.createElement(f.Translate,{as:"p"},"Are you sure you want to delete"," ",c.createElement(f.Param,{wrapper:c.createElement("strong",null),name:"first_name",value:e})," ",c.createElement(f.Param,{wrapper:c.createElement("strong",null),name:"last_name",value:a}),"?")),c.createElement(D.A.Actions,null,c.createElement(h.A,{onClick:r,disabled:t,content:f.Translate.string("No, I don't")}),m?c.createElement(h.A,{color:"red",disabled:!0},c.createElement(f.Translate,null,"Yes, I want to delete ",c.createElement(f.Param,{name:"first_name",value:e})," (",c.createElement(f.Param,{name:"countdown_seconds",value:s}),")")):c.createElement(h.A,{color:"red",onClick:l,disabled:t,loading:n},c.createElement(f.Translate,null,"Yes, I want to delete ",c.createElement(f.Param,{name:"first_name",value:e})))))}function R({userId:e,isAdmin:a,firstName:t,lastName:n}){const[l,r]=(0,c.useState)(!1),[s,i]=(0,c.useState)(!1),m=null===e,o=()=>{r(!1)};return a&&!m?c.createElement(T.A,{trigger:c.createElement("span",null,c.createElement(h.A,{size:"small",color:"red",disabled:!0},c.createElement(f.Translate,null,"Delete User"))),size:"small",wide:!0,content:f.Translate.string("You cannot delete an admin account"),position:"bottom center"}):c.createElement("div",null,m?c.createElement(T.A,{trigger:c.createElement("span",null,c.createElement(h.A,{size:"small",color:"red",disabled:!0},c.createElement(f.Translate,null,"Delete User"))),size:"small",wide:!0,content:f.Translate.string("You cannot delete your own account"),position:"bottom center"}):c.createElement(c.Fragment,null,c.createElement(h.A,{size:"small",color:"red",onClick:()=>r(!0)},c.createElement(f.Translate,null,"Delete User")),c.createElement(D.A,{size:"small",open:l,onClose:o,closeIcon:!s,closeOnEscape:!s,closeOnDimmerClick:!s},c.createElement(N,{firstName:t,lastName:n,disabled:s,inProgress:s,onDelete:async()=>{i(!0);try{await y.indicoAxios.delete(C({user_id:e}))}catch(e){return i(!1),o(),void(0,y.handleAxiosError)(e)}location.href=q()},onClose:o}))))}N.propTypes={firstName:i().string.isRequired,lastName:i().string.isRequired,disabled:i().bool.isRequired,inProgress:i().bool.isRequired,onDelete:i().func.isRequired,onClose:i().func.isRequired},R.propTypes={userId:i().oneOfType([i().number,i().oneOf([null])]),isAdmin:i().bool.isRequired,firstName:i().string.isRequired,lastName:i().string.isRequired},customElements.define("ind-user-delete-button",class extends HTMLElement{connectedCallback(){m.render(c.createElement(R,{userId:JSON.parse(this.getAttribute("user-id")),isAdmin:JSON.parse(this.getAttribute("user-is-admin")),firstName:this.getAttribute("user-first-name"),lastName:this.getAttribute("user-last-name")}),this)}})}},e=>{e.O(0,[4644,4394,2076],(()=>{return a=71511,e(e.s=a);var a}));e.O()}]);
//# sourceMappingURL=module_users.personal_data.83e92367.bundle.js.map