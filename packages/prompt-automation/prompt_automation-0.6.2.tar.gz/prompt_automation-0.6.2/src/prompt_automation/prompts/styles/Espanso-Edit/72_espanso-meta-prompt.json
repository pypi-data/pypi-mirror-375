{
  "schema": 1,
  "id": 72,
  "title": "Espanso Snippet – Meta‑Prompt (Simple)",
  "style": "Espanso-Edit",
  "role": "assistant",
  "placeholders": [
    { "name": "trigger", "label": "Trigger (e.g., :pa.kudos)", "default": ":pa.example", "multiline": false },
    { "name": "replace", "label": "Replacement text (plain or multi-line)", "multiline": true, "default": "Great job — thanks for the help!" },
    { "name": "target_file", "label": "Target match file name (under espanso-package/match/)", "default": "my_tools.yml" },
  { "name": "commit_msg", "label": "Commit message", "default": "feat(espanso): add {{trigger}} snippet" }
  ],
  "template": [
    "You are an expert repo assistant who can edit files and run shell commands.",
    "Goal: Add a new Espanso snippet to this repository and fully sync it locally.",
    "",
    "Instructions (perform in order):",
    "1) Create or update 'espanso-package/match/{{target_file}}' by ensuring it contains a 'matches:' list and appending the snippet below, avoiding duplicate triggers:",
    "--- SNIPPET (YAML) ---",
    "matches:",
    "  - trigger: \"{{trigger}}\"",
    "    replace: \"{{replace}}\"",
    "# Optional vars block (uncomment and edit if needed):",
    "#   vars:",
    "#     - name: example",
    "#       type: shell",
    "#       params:",
    "#         cmd: echo example",
    "--- END ---",
  "- If your replacement is multi-line, use YAML block scalar syntax instead of quotes:",
  "  replace: |",
  "    First line",
  "    Second line",
    "- If the file doesn't exist, create it with a top-level 'matches:' key.",
    "- If a duplicate trigger is found anywhere under espanso-package/match/*.yml, stop and rename the trigger (update this change consistently).",
    "",
    "2) Validate locally:",
    "- Run tests for Espanso package only:",
    "  - pytest -q tests/espanso",
    "- Lint YAML and check duplicates:",
    "  - scripts/espanso.sh lint",
    "",
    "3) Sync locally (mirror + install/update + restart):",
    "- Preferred single command:",
    "  - scripts/espanso.sh sync",
    "- Optional env: set PA_SKIP_INSTALL=1 for dry-run; set PA_AUTO_BUMP=patch to bump patch version.",
    "- Alternative CLI entry: prompt-automation --espanso-sync",
    "- Or colon command: :pa.sync",
    "",
    "4) Smoke check:",
    "- espanso package list",
    "- espanso status",
    "- Try the trigger '{{trigger}}' in a text field.",
    "",
    "5) Commit and push:",
    "- git add espanso-package packages",
    "- git commit -m \"{{commit_msg}}\"",
    "- git push",
    "",
    "Acceptance criteria:",
    "- No duplicate trigger errors in tests/lint.",
    "- Sync command completes without errors and restarts Espanso.",
    "- ':pa.sync' works and '{{trigger}}' expands as expected.",
    "",
    "Notes:",
    "- Dry-run option validates and mirrors only (skips install): set PA_SKIP_INSTALL=1.",
    "- Auto bump patch: set PA_AUTO_BUMP=patch.",
    "- If origin remote is present, orchestrator uses Git install; otherwise local path install.",
    "- Do not store secrets in snippets.",
    "",
    "Now proceed to perform the file edits and run the commands exactly as specified above, reporting any issues verbosely and stopping on first failure with actionable guidance."
  ],
  "metadata": {
    "path": "Espanso-Edit/espanso-meta-prompt-simple.json",
    "tags": ["espanso", "meta", "workflow", "snippet"],
    "version": 1,
    "render": "markdown",
    "share_this_file_openly": true,
    "last_edited": "2025-09-07"
  }
}
