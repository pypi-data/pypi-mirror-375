#!/bin/bash
## show first lines of each sheet in an EXCEL file
#################################
## NOTE #########################
## pandas + openpyxl
#################################
## ARGUMENTS ####################
## excel : excel file path
#################################

python3 <<EOF
import pandas as pd 
# show all sheet names
tabs = pd.ExcelFile("${excel}").sheet_names 
print( "sheet_names:{}".format(tabs))

# print head
for i in tabs:
    print("-----------------" + i + "---------------------")
    head = pd.read_excel("${excel}",sheet_name=i,nrows=5).head()
    print(head)
    print( "columns:{}".format(head.columns))
    print("")
EOF

#echo "
#import pandas as pd 
## show all sheet names
#tabs = pd.ExcelFile(\"${excel}\").sheet_names 
#print( \"sheet_names:{}\".format(tabs))
#
## print head
#for i in tabs:
#    print(\"-----------------\" + i + \"---------------------\")
#    head = pd.read_excel(\"${excel}\",sheet_name=i,nrows=5).head()
#    print(head)
#    print( \"columns:{}\".format(head.columns))
#    print(\"\")
#" > head_excel.py \
#&& python head_excel.py \
#&& rm head_excel.py