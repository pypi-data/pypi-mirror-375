[tox]
envlist = py38,py39,py310,py311,py312,lint,docs
isolated_build = true

[testenv]
deps = 
    -r{toxinidir}/requirements-test.txt
commands = 
    playwright install chromium
    pytest {posargs}
allowlist_externals = playwright

[testenv:lint]
deps = 
    black
    flake8
    mypy
    isort
commands = 
    black --check layoutlens/ scripts/ tests/ examples/
    isort --check-only layoutlens/ scripts/ tests/ examples/
    flake8 layoutlens/ scripts/ tests/
    mypy layoutlens/ --ignore-missing-imports

[testenv:format]
deps = 
    black
    isort
commands = 
    black layoutlens/ scripts/ tests/ examples/
    isort layoutlens/ scripts/ tests/ examples/

[testenv:docs]
deps = 
    sphinx
    sphinx-rtd-theme
commands = 
    sphinx-build -W -b html docs docs/_build/html

[testenv:coverage]
deps = 
    -r{toxinidir}/requirements-test.txt
    coverage[toml]
commands = 
    playwright install chromium
    pytest --cov=layoutlens --cov=framework --cov=scripts --cov-report=html --cov-report=term-missing
allowlist_externals = playwright

[testenv:build]
deps = 
    build
    twine
commands = 
    python -m build
    twine check dist/*