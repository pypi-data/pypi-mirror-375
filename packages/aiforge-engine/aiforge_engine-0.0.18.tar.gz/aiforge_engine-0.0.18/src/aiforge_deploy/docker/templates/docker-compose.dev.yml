services:
  aiforge-core:
    volumes:
      # 开发模式：挂载源代码目录，实现代码热更新
      - ./src:/app/src
      - ${AIFORGE_CONFIG_DIR:-./aiforge_config}:/app/config
      - ${AIFORGE_WORK_DIR:-./aiforge_work}:/app/aiforge_work
      - ${AIFORGE_LOGS_DIR:-./logs}:/app/logs
    environment:
      - AIFORGE_DOCKER_MODE=true
      - AIFORGE_CONFIG_DIR=/app/config
      - AIFORGE_DEBUG=true
      - AIFORGE_RELOAD=true
      - AIFORGE_LOG_LEVEL=DEBUG
      # 不强制提供 API KEY 启动 
      # - OPENROUTER_API_KEY=${OPENROUTER_API_KEY:-}
      # - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY:-}
      - AIFORGE_LOCALE=${AIFORGE_LOCALE:-en}

  aiforge-web:
    volumes:
      # 开发模式：挂载源代码目录，实现代码热更新
      - ./src:/app/src
      - ${AIFORGE_CONFIG_DIR:-./aiforge_config}:/app/config
      - ${AIFORGE_WORK_DIR:-./aiforge_work}:/app/aiforge_work
      - ${AIFORGE_LOGS_DIR:-./logs}:/app/logs
    environment:
      - AIFORGE_DOCKER_MODE=true
      - AIFORGE_CONFIG_DIR=/app/config
      - AIFORGE_DEBUG=true
      - AIFORGE_RELOAD=true
      - AIFORGE_LOG_LEVEL=DEBUG
      # 不强制提供 API KEY 启动 
      # - OPENROUTER_API_KEY=${OPENROUTER_API_KEY:-}
      # - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY:-}
      - AIFORGE_LOCALE=${AIFORGE_LOCALE:-en}
    command: [ "web", "--reload", "--debug", "--host", "0.0.0.0", "--port", "8000" ]
